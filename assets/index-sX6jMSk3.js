import{a as us,b as ds,g as ms,R as pe,r as N,u as ps,d as hs,e as fs,f as Oe,N as lt,B as gs}from"./vendor-BfRyhV_A.js";import{C as bs}from"./websocket-ImiZJucQ.js";import{R as xs,L as ys,C as ws,X as vs,Y as ct,T as Ss,a as xe}from"./charts-6mwycKEn.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();var Ke={exports:{}},ye={};var ut;function Ts(){if(ut)return ye;ut=1;var e=us(),t=Symbol.for("react.element"),s=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,n=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function a(l,u,d){var m,p={},f=null,R=null;d!==void 0&&(f=""+d),u.key!==void 0&&(f=""+u.key),u.ref!==void 0&&(R=u.ref);for(m in u)r.call(u,m)&&!i.hasOwnProperty(m)&&(p[m]=u[m]);if(l&&l.defaultProps)for(m in u=l.defaultProps,u)p[m]===void 0&&(p[m]=u[m]);return{$$typeof:t,type:l,key:f,ref:R,props:p,_owner:n.current}}return ye.Fragment=s,ye.jsx=a,ye.jsxs=a,ye}var dt;function js(){return dt||(dt=1,Ke.exports=Ts()),Ke.exports}var o=js(),$e={},mt;function Ns(){if(mt)return $e;mt=1;var e=ds();return $e.createRoot=e.createRoot,$e.hydrateRoot=e.hydrateRoot,$e}var Cs=Ns();const ks=ms(Cs);class Es extends pe.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,s){console.error("Error caught by boundary:",t,s)}render(){return this.state.hasError?o.jsx("div",{className:"min-h-screen bg-red-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md",children:[o.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"âš ï¸ Application Error"}),o.jsx("p",{className:"text-gray-700 mb-4",children:"The dashboard encountered an error and had to reload."}),o.jsx("p",{className:"text-sm text-gray-500 mb-6 font-mono break-words",children:this.state.error?.toString()}),o.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Reload Page"})]})}):this.props.children}}const Ft=N.createContext({userId:"",jwtToken:"",setAuth:()=>{},logout:()=>{}}),st=()=>N.useContext(Ft),Ms=({children:e})=>{const[t,s]=N.useState(localStorage.getItem("userId")||""),[r,n]=N.useState(localStorage.getItem("jwtToken")||""),l={userId:t,jwtToken:r,setAuth:({userId:u,jwtToken:d})=>{s(u),n(d),localStorage.setItem("jwtToken",d),localStorage.setItem("userId",u),console.log("âœ… Auth state updated:",{userId:u,hasToken:!!d})},logout:()=>{s(""),n(""),localStorage.clear(),window.location.href="/"}};return o.jsx(Ft.Provider,{value:l,children:e})};function Pt(e,t){return function(){return e.apply(t,arguments)}}const{toString:Rs}=Object.prototype,{getPrototypeOf:rt}=Object,{iterator:He,toStringTag:It}=Symbol,Be=(e=>t=>{const s=Rs.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),re=e=>(e=e.toLowerCase(),t=>Be(t)===e),qe=e=>t=>typeof t===e,{isArray:fe}=Array,he=qe("undefined");function Ee(e){return e!==null&&!he(e)&&e.constructor!==null&&!he(e.constructor)&&Q(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Lt=re("ArrayBuffer");function As(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Lt(e.buffer),t}const Os=qe("string"),Q=qe("function"),_t=qe("number"),Me=e=>e!==null&&typeof e=="object",$s=e=>e===!0||e===!1,Pe=e=>{if(Be(e)!=="object")return!1;const t=rt(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(It in e)&&!(He in e)},Ds=e=>{if(!Me(e)||Ee(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Fs=re("Date"),Ps=re("File"),Is=re("Blob"),Ls=re("FileList"),_s=e=>Me(e)&&Q(e.pipe),Us=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Q(e.append)&&((t=Be(e))==="formdata"||t==="object"&&Q(e.toString)&&e.toString()==="[object FormData]"))},Hs=re("URLSearchParams"),[Bs,qs,Ws,zs]=["ReadableStream","Request","Response","Headers"].map(re),Js=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Re(e,t,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let r,n;if(typeof e!="object"&&(e=[e]),fe(e))for(r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else{if(Ee(e))return;const i=s?Object.getOwnPropertyNames(e):Object.keys(e),a=i.length;let l;for(r=0;r<a;r++)l=i[r],t.call(null,e[l],l,e)}}function Ut(e,t){if(Ee(e))return null;t=t.toLowerCase();const s=Object.keys(e);let r=s.length,n;for(;r-- >0;)if(n=s[r],t===n.toLowerCase())return n;return null}const ue=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ht=e=>!he(e)&&e!==ue;function Ze(){const{caseless:e,skipUndefined:t}=Ht(this)&&this||{},s={},r=(n,i)=>{const a=e&&Ut(s,i)||i;Pe(s[a])&&Pe(n)?s[a]=Ze(s[a],n):Pe(n)?s[a]=Ze({},n):fe(n)?s[a]=n.slice():(!t||!he(n))&&(s[a]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Re(arguments[n],r);return s}const Ks=(e,t,s,{allOwnKeys:r}={})=>(Re(t,(n,i)=>{s&&Q(n)?e[i]=Pt(n,s):e[i]=n},{allOwnKeys:r}),e),Vs=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Xs=(e,t,s,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},Gs=(e,t,s,r)=>{let n,i,a;const l={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),i=n.length;i-- >0;)a=n[i],(!r||r(a,e,t))&&!l[a]&&(t[a]=e[a],l[a]=!0);e=s!==!1&&rt(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},Qs=(e,t,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=t.length;const r=e.indexOf(t,s);return r!==-1&&r===s},Zs=e=>{if(!e)return null;if(fe(e))return e;let t=e.length;if(!_t(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=e[t];return s},Ys=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&rt(Uint8Array)),er=(e,t)=>{const r=(e&&e[He]).call(e);let n;for(;(n=r.next())&&!n.done;){const i=n.value;t.call(e,i[0],i[1])}},tr=(e,t)=>{let s;const r=[];for(;(s=e.exec(t))!==null;)r.push(s);return r},sr=re("HTMLFormElement"),rr=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,r,n){return r.toUpperCase()+n}),pt=(({hasOwnProperty:e})=>(t,s)=>e.call(t,s))(Object.prototype),nr=re("RegExp"),Bt=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),r={};Re(s,(n,i)=>{let a;(a=t(n,i,e))!==!1&&(r[i]=a||n)}),Object.defineProperties(e,r)},or=e=>{Bt(e,(t,s)=>{if(Q(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const r=e[s];if(Q(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},ar=(e,t)=>{const s={},r=n=>{n.forEach(i=>{s[i]=!0})};return fe(e)?r(e):r(String(e).split(t)),s},ir=()=>{},lr=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function cr(e){return!!(e&&Q(e.append)&&e[It]==="FormData"&&e[He])}const ur=e=>{const t=new Array(10),s=(r,n)=>{if(Me(r)){if(t.indexOf(r)>=0)return;if(Ee(r))return r;if(!("toJSON"in r)){t[n]=r;const i=fe(r)?[]:{};return Re(r,(a,l)=>{const u=s(a,n+1);!he(u)&&(i[l]=u)}),t[n]=void 0,i}}return r};return s(e,0)},dr=re("AsyncFunction"),mr=e=>e&&(Me(e)||Q(e))&&Q(e.then)&&Q(e.catch),qt=((e,t)=>e?setImmediate:t?((s,r)=>(ue.addEventListener("message",({source:n,data:i})=>{n===ue&&i===s&&r.length&&r.shift()()},!1),n=>{r.push(n),ue.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",Q(ue.postMessage)),pr=typeof queueMicrotask<"u"?queueMicrotask.bind(ue):typeof process<"u"&&process.nextTick||qt,hr=e=>e!=null&&Q(e[He]),c={isArray:fe,isArrayBuffer:Lt,isBuffer:Ee,isFormData:Us,isArrayBufferView:As,isString:Os,isNumber:_t,isBoolean:$s,isObject:Me,isPlainObject:Pe,isEmptyObject:Ds,isReadableStream:Bs,isRequest:qs,isResponse:Ws,isHeaders:zs,isUndefined:he,isDate:Fs,isFile:Ps,isBlob:Is,isRegExp:nr,isFunction:Q,isStream:_s,isURLSearchParams:Hs,isTypedArray:Ys,isFileList:Ls,forEach:Re,merge:Ze,extend:Ks,trim:Js,stripBOM:Vs,inherits:Xs,toFlatObject:Gs,kindOf:Be,kindOfTest:re,endsWith:Qs,toArray:Zs,forEachEntry:er,matchAll:tr,isHTMLForm:sr,hasOwnProperty:pt,hasOwnProp:pt,reduceDescriptors:Bt,freezeMethods:or,toObjectSet:ar,toCamelCase:rr,noop:ir,toFiniteNumber:lr,findKey:Ut,global:ue,isContextDefined:Ht,isSpecCompliantForm:cr,toJSONObject:ur,isAsyncFn:dr,isThenable:mr,setImmediate:qt,asap:pr,isIterable:hr};function j(e,t,s,r,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),r&&(this.request=r),n&&(this.response=n,this.status=n.status?n.status:null)}c.inherits(j,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:c.toJSONObject(this.config),code:this.code,status:this.status}}});const Wt=j.prototype,zt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{zt[e]={value:e}});Object.defineProperties(j,zt);Object.defineProperty(Wt,"isAxiosError",{value:!0});j.from=(e,t,s,r,n,i)=>{const a=Object.create(Wt);c.toFlatObject(e,a,function(m){return m!==Error.prototype},d=>d!=="isAxiosError");const l=e&&e.message?e.message:"Error",u=t==null&&e?e.code:t;return j.call(a,l,u,s,r,n),e&&a.cause==null&&Object.defineProperty(a,"cause",{value:e,configurable:!0}),a.name=e&&e.name||"Error",i&&Object.assign(a,i),a};const fr=null;function Ye(e){return c.isPlainObject(e)||c.isArray(e)}function Jt(e){return c.endsWith(e,"[]")?e.slice(0,-2):e}function ht(e,t,s){return e?e.concat(t).map(function(n,i){return n=Jt(n),!s&&i?"["+n+"]":n}).join(s?".":""):t}function gr(e){return c.isArray(e)&&!e.some(Ye)}const br=c.toFlatObject(c,{},null,function(t){return/^is[A-Z]/.test(t)});function We(e,t,s){if(!c.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,s=c.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,g){return!c.isUndefined(g[b])});const r=s.metaTokens,n=s.visitor||m,i=s.dots,a=s.indexes,u=(s.Blob||typeof Blob<"u"&&Blob)&&c.isSpecCompliantForm(t);if(!c.isFunction(n))throw new TypeError("visitor must be a function");function d(h){if(h===null)return"";if(c.isDate(h))return h.toISOString();if(c.isBoolean(h))return h.toString();if(!u&&c.isBlob(h))throw new j("Blob is not supported. Use a Buffer instead.");return c.isArrayBuffer(h)||c.isTypedArray(h)?u&&typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}function m(h,b,g){let C=h;if(h&&!g&&typeof h=="object"){if(c.endsWith(b,"{}"))b=r?b:b.slice(0,-2),h=JSON.stringify(h);else if(c.isArray(h)&&gr(h)||(c.isFileList(h)||c.endsWith(b,"[]"))&&(C=c.toArray(h)))return b=Jt(b),C.forEach(function(E,O){!(c.isUndefined(E)||E===null)&&t.append(a===!0?ht([b],O,i):a===null?b:b+"[]",d(E))}),!1}return Ye(h)?!0:(t.append(ht(g,b,i),d(h)),!1)}const p=[],f=Object.assign(br,{defaultVisitor:m,convertValue:d,isVisitable:Ye});function R(h,b){if(!c.isUndefined(h)){if(p.indexOf(h)!==-1)throw Error("Circular reference detected in "+b.join("."));p.push(h),c.forEach(h,function(C,M){(!(c.isUndefined(C)||C===null)&&n.call(t,C,c.isString(M)?M.trim():M,b,f))===!0&&R(C,b?b.concat(M):[M])}),p.pop()}}if(!c.isObject(e))throw new TypeError("data must be an object");return R(e),t}function ft(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function nt(e,t){this._pairs=[],e&&We(e,this,t)}const Kt=nt.prototype;Kt.append=function(t,s){this._pairs.push([t,s])};Kt.toString=function(t){const s=t?function(r){return t.call(this,r,ft)}:ft;return this._pairs.map(function(n){return s(n[0])+"="+s(n[1])},"").join("&")};function xr(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Vt(e,t,s){if(!t)return e;const r=s&&s.encode||xr;c.isFunction(s)&&(s={serialize:s});const n=s&&s.serialize;let i;if(n?i=n(t,s):i=c.isURLSearchParams(t)?t.toString():new nt(t,s).toString(r),i){const a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class gt{constructor(){this.handlers=[]}use(t,s,r){return this.handlers.push({fulfilled:t,rejected:s,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){c.forEach(this.handlers,function(r){r!==null&&t(r)})}}const Xt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},yr=typeof URLSearchParams<"u"?URLSearchParams:nt,wr=typeof FormData<"u"?FormData:null,vr=typeof Blob<"u"?Blob:null,Sr={isBrowser:!0,classes:{URLSearchParams:yr,FormData:wr,Blob:vr},protocols:["http","https","file","blob","url","data"]},ot=typeof window<"u"&&typeof document<"u",et=typeof navigator=="object"&&navigator||void 0,Tr=ot&&(!et||["ReactNative","NativeScript","NS"].indexOf(et.product)<0),jr=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Nr=ot&&window.location.href||"http://localhost",Cr=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ot,hasStandardBrowserEnv:Tr,hasStandardBrowserWebWorkerEnv:jr,navigator:et,origin:Nr},Symbol.toStringTag,{value:"Module"})),K={...Cr,...Sr};function kr(e,t){return We(e,new K.classes.URLSearchParams,{visitor:function(s,r,n,i){return K.isNode&&c.isBuffer(s)?(this.append(r,s.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function Er(e){return c.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Mr(e){const t={},s=Object.keys(e);let r;const n=s.length;let i;for(r=0;r<n;r++)i=s[r],t[i]=e[i];return t}function Gt(e){function t(s,r,n,i){let a=s[i++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),u=i>=s.length;return a=!a&&c.isArray(n)?n.length:a,u?(c.hasOwnProp(n,a)?n[a]=[n[a],r]:n[a]=r,!l):((!n[a]||!c.isObject(n[a]))&&(n[a]=[]),t(s,r,n[a],i)&&c.isArray(n[a])&&(n[a]=Mr(n[a])),!l)}if(c.isFormData(e)&&c.isFunction(e.entries)){const s={};return c.forEachEntry(e,(r,n)=>{t(Er(r),n,s,0)}),s}return null}function Rr(e,t,s){if(c.isString(e))try{return(t||JSON.parse)(e),c.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(s||JSON.stringify)(e)}const Ae={transitional:Xt,adapter:["xhr","http","fetch"],transformRequest:[function(t,s){const r=s.getContentType()||"",n=r.indexOf("application/json")>-1,i=c.isObject(t);if(i&&c.isHTMLForm(t)&&(t=new FormData(t)),c.isFormData(t))return n?JSON.stringify(Gt(t)):t;if(c.isArrayBuffer(t)||c.isBuffer(t)||c.isStream(t)||c.isFile(t)||c.isBlob(t)||c.isReadableStream(t))return t;if(c.isArrayBufferView(t))return t.buffer;if(c.isURLSearchParams(t))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return kr(t,this.formSerializer).toString();if((l=c.isFileList(t))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return We(l?{"files[]":t}:t,u&&new u,this.formSerializer)}}return i||n?(s.setContentType("application/json",!1),Rr(t)):t}],transformResponse:[function(t){const s=this.transitional||Ae.transitional,r=s&&s.forcedJSONParsing,n=this.responseType==="json";if(c.isResponse(t)||c.isReadableStream(t))return t;if(t&&c.isString(t)&&(r&&!this.responseType||n)){const a=!(s&&s.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(l){if(a)throw l.name==="SyntaxError"?j.from(l,j.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:K.classes.FormData,Blob:K.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};c.forEach(["delete","get","head","post","put","patch"],e=>{Ae.headers[e]={}});const Ar=c.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Or=e=>{const t={};let s,r,n;return e&&e.split(`
`).forEach(function(a){n=a.indexOf(":"),s=a.substring(0,n).trim().toLowerCase(),r=a.substring(n+1).trim(),!(!s||t[s]&&Ar[s])&&(s==="set-cookie"?t[s]?t[s].push(r):t[s]=[r]:t[s]=t[s]?t[s]+", "+r:r)}),t},bt=Symbol("internals");function we(e){return e&&String(e).trim().toLowerCase()}function Ie(e){return e===!1||e==null?e:c.isArray(e)?e.map(Ie):String(e)}function $r(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=s.exec(e);)t[r[1]]=r[2];return t}const Dr=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ve(e,t,s,r,n){if(c.isFunction(r))return r.call(this,t,s);if(n&&(t=s),!!c.isString(t)){if(c.isString(r))return t.indexOf(r)!==-1;if(c.isRegExp(r))return r.test(t)}}function Fr(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,s,r)=>s.toUpperCase()+r)}function Pr(e,t){const s=c.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+s,{value:function(n,i,a){return this[r].call(this,t,n,i,a)},configurable:!0})})}let Z=class{constructor(t){t&&this.set(t)}set(t,s,r){const n=this;function i(l,u,d){const m=we(u);if(!m)throw new Error("header name must be a non-empty string");const p=c.findKey(n,m);(!p||n[p]===void 0||d===!0||d===void 0&&n[p]!==!1)&&(n[p||u]=Ie(l))}const a=(l,u)=>c.forEach(l,(d,m)=>i(d,m,u));if(c.isPlainObject(t)||t instanceof this.constructor)a(t,s);else if(c.isString(t)&&(t=t.trim())&&!Dr(t))a(Or(t),s);else if(c.isObject(t)&&c.isIterable(t)){let l={},u,d;for(const m of t){if(!c.isArray(m))throw TypeError("Object iterator must return a key-value pair");l[d=m[0]]=(u=l[d])?c.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}a(l,s)}else t!=null&&i(s,t,r);return this}get(t,s){if(t=we(t),t){const r=c.findKey(this,t);if(r){const n=this[r];if(!s)return n;if(s===!0)return $r(n);if(c.isFunction(s))return s.call(this,n,r);if(c.isRegExp(s))return s.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,s){if(t=we(t),t){const r=c.findKey(this,t);return!!(r&&this[r]!==void 0&&(!s||Ve(this,this[r],r,s)))}return!1}delete(t,s){const r=this;let n=!1;function i(a){if(a=we(a),a){const l=c.findKey(r,a);l&&(!s||Ve(r,r[l],l,s))&&(delete r[l],n=!0)}}return c.isArray(t)?t.forEach(i):i(t),n}clear(t){const s=Object.keys(this);let r=s.length,n=!1;for(;r--;){const i=s[r];(!t||Ve(this,this[i],i,t,!0))&&(delete this[i],n=!0)}return n}normalize(t){const s=this,r={};return c.forEach(this,(n,i)=>{const a=c.findKey(r,i);if(a){s[a]=Ie(n),delete s[i];return}const l=t?Fr(i):String(i).trim();l!==i&&delete s[i],s[l]=Ie(n),r[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const s=Object.create(null);return c.forEach(this,(r,n)=>{r!=null&&r!==!1&&(s[n]=t&&c.isArray(r)?r.join(", "):r)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,s])=>t+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...s){const r=new this(t);return s.forEach(n=>r.set(n)),r}static accessor(t){const r=(this[bt]=this[bt]={accessors:{}}).accessors,n=this.prototype;function i(a){const l=we(a);r[l]||(Pr(n,a),r[l]=!0)}return c.isArray(t)?t.forEach(i):i(t),this}};Z.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);c.reduceDescriptors(Z.prototype,({value:e},t)=>{let s=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[s]=r}}});c.freezeMethods(Z);function Xe(e,t){const s=this||Ae,r=t||s,n=Z.from(r.headers);let i=r.data;return c.forEach(e,function(l){i=l.call(s,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function Qt(e){return!!(e&&e.__CANCEL__)}function ge(e,t,s){j.call(this,e??"canceled",j.ERR_CANCELED,t,s),this.name="CanceledError"}c.inherits(ge,j,{__CANCEL__:!0});function Zt(e,t,s){const r=s.config.validateStatus;!s.status||!r||r(s.status)?e(s):t(new j("Request failed with status code "+s.status,[j.ERR_BAD_REQUEST,j.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function Ir(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Lr(e,t){e=e||10;const s=new Array(e),r=new Array(e);let n=0,i=0,a;return t=t!==void 0?t:1e3,function(u){const d=Date.now(),m=r[i];a||(a=d),s[n]=u,r[n]=d;let p=i,f=0;for(;p!==n;)f+=s[p++],p=p%e;if(n=(n+1)%e,n===i&&(i=(i+1)%e),d-a<t)return;const R=m&&d-m;return R?Math.round(f*1e3/R):void 0}}function _r(e,t){let s=0,r=1e3/t,n,i;const a=(d,m=Date.now())=>{s=m,n=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const m=Date.now(),p=m-s;p>=r?a(d,m):(n=d,i||(i=setTimeout(()=>{i=null,a(n)},r-p)))},()=>n&&a(n)]}const _e=(e,t,s=3)=>{let r=0;const n=Lr(50,250);return _r(i=>{const a=i.loaded,l=i.lengthComputable?i.total:void 0,u=a-r,d=n(u),m=a<=l;r=a;const p={loaded:a,total:l,progress:l?a/l:void 0,bytes:u,rate:d||void 0,estimated:d&&l&&m?(l-a)/d:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(p)},s)},xt=(e,t)=>{const s=e!=null;return[r=>t[0]({lengthComputable:s,total:e,loaded:r}),t[1]]},yt=e=>(...t)=>c.asap(()=>e(...t)),Ur=K.hasStandardBrowserEnv?((e,t)=>s=>(s=new URL(s,K.origin),e.protocol===s.protocol&&e.host===s.host&&(t||e.port===s.port)))(new URL(K.origin),K.navigator&&/(msie|trident)/i.test(K.navigator.userAgent)):()=>!0,Hr=K.hasStandardBrowserEnv?{write(e,t,s,r,n,i,a){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];c.isNumber(s)&&l.push(`expires=${new Date(s).toUTCString()}`),c.isString(r)&&l.push(`path=${r}`),c.isString(n)&&l.push(`domain=${n}`),i===!0&&l.push("secure"),c.isString(a)&&l.push(`SameSite=${a}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Br(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function qr(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Yt(e,t,s){let r=!Br(t);return e&&(r||s==!1)?qr(e,t):t}const wt=e=>e instanceof Z?{...e}:e;function me(e,t){t=t||{};const s={};function r(d,m,p,f){return c.isPlainObject(d)&&c.isPlainObject(m)?c.merge.call({caseless:f},d,m):c.isPlainObject(m)?c.merge({},m):c.isArray(m)?m.slice():m}function n(d,m,p,f){if(c.isUndefined(m)){if(!c.isUndefined(d))return r(void 0,d,p,f)}else return r(d,m,p,f)}function i(d,m){if(!c.isUndefined(m))return r(void 0,m)}function a(d,m){if(c.isUndefined(m)){if(!c.isUndefined(d))return r(void 0,d)}else return r(void 0,m)}function l(d,m,p){if(p in t)return r(d,m);if(p in e)return r(void 0,d)}const u={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(d,m,p)=>n(wt(d),wt(m),p,!0)};return c.forEach(Object.keys({...e,...t}),function(m){const p=u[m]||n,f=p(e[m],t[m],m);c.isUndefined(f)&&p!==l||(s[m]=f)}),s}const es=e=>{const t=me({},e);let{data:s,withXSRFToken:r,xsrfHeaderName:n,xsrfCookieName:i,headers:a,auth:l}=t;if(t.headers=a=Z.from(a),t.url=Vt(Yt(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),c.isFormData(s)){if(K.hasStandardBrowserEnv||K.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(c.isFunction(s.getHeaders)){const u=s.getHeaders(),d=["content-type","content-length"];Object.entries(u).forEach(([m,p])=>{d.includes(m.toLowerCase())&&a.set(m,p)})}}if(K.hasStandardBrowserEnv&&(r&&c.isFunction(r)&&(r=r(t)),r||r!==!1&&Ur(t.url))){const u=n&&i&&Hr.read(i);u&&a.set(n,u)}return t},Wr=typeof XMLHttpRequest<"u",zr=Wr&&function(e){return new Promise(function(s,r){const n=es(e);let i=n.data;const a=Z.from(n.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:d}=n,m,p,f,R,h;function b(){R&&R(),h&&h(),n.cancelToken&&n.cancelToken.unsubscribe(m),n.signal&&n.signal.removeEventListener("abort",m)}let g=new XMLHttpRequest;g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout;function C(){if(!g)return;const E=Z.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),L={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:E,config:e,request:g};Zt(function(x){s(x),b()},function(x){r(x),b()},L),g=null}"onloadend"in g?g.onloadend=C:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(C)},g.onabort=function(){g&&(r(new j("Request aborted",j.ECONNABORTED,e,g)),g=null)},g.onerror=function(O){const L=O&&O.message?O.message:"Network Error",q=new j(L,j.ERR_NETWORK,e,g);q.event=O||null,r(q),g=null},g.ontimeout=function(){let O=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const L=n.transitional||Xt;n.timeoutErrorMessage&&(O=n.timeoutErrorMessage),r(new j(O,L.clarifyTimeoutError?j.ETIMEDOUT:j.ECONNABORTED,e,g)),g=null},i===void 0&&a.setContentType(null),"setRequestHeader"in g&&c.forEach(a.toJSON(),function(O,L){g.setRequestHeader(L,O)}),c.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),l&&l!=="json"&&(g.responseType=n.responseType),d&&([f,h]=_e(d,!0),g.addEventListener("progress",f)),u&&g.upload&&([p,R]=_e(u),g.upload.addEventListener("progress",p),g.upload.addEventListener("loadend",R)),(n.cancelToken||n.signal)&&(m=E=>{g&&(r(!E||E.type?new ge(null,e,g):E),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(m),n.signal&&(n.signal.aborted?m():n.signal.addEventListener("abort",m)));const M=Ir(n.url);if(M&&K.protocols.indexOf(M)===-1){r(new j("Unsupported protocol "+M+":",j.ERR_BAD_REQUEST,e));return}g.send(i||null)})},Jr=(e,t)=>{const{length:s}=e=e?e.filter(Boolean):[];if(t||s){let r=new AbortController,n;const i=function(d){if(!n){n=!0,l();const m=d instanceof Error?d:this.reason;r.abort(m instanceof j?m:new ge(m instanceof Error?m.message:m))}};let a=t&&setTimeout(()=>{a=null,i(new j(`timeout ${t} of ms exceeded`,j.ETIMEDOUT))},t);const l=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:u}=r;return u.unsubscribe=()=>c.asap(l),u}},Kr=function*(e,t){let s=e.byteLength;if(s<t){yield e;return}let r=0,n;for(;r<s;)n=r+t,yield e.slice(r,n),r=n},Vr=async function*(e,t){for await(const s of Xr(e))yield*Kr(s,t)},Xr=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:s,value:r}=await t.read();if(s)break;yield r}}finally{await t.cancel()}},vt=(e,t,s,r)=>{const n=Vr(e,t);let i=0,a,l=u=>{a||(a=!0,r&&r(u))};return new ReadableStream({async pull(u){try{const{done:d,value:m}=await n.next();if(d){l(),u.close();return}let p=m.byteLength;if(s){let f=i+=p;s(f)}u.enqueue(new Uint8Array(m))}catch(d){throw l(d),d}},cancel(u){return l(u),n.return()}},{highWaterMark:2})},St=64*1024,{isFunction:De}=c,Gr=(({Request:e,Response:t})=>({Request:e,Response:t}))(c.global),{ReadableStream:Tt,TextEncoder:jt}=c.global,Nt=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Qr=e=>{e=c.merge.call({skipUndefined:!0},Gr,e);const{fetch:t,Request:s,Response:r}=e,n=t?De(t):typeof fetch=="function",i=De(s),a=De(r);if(!n)return!1;const l=n&&De(Tt),u=n&&(typeof jt=="function"?(h=>b=>h.encode(b))(new jt):async h=>new Uint8Array(await new s(h).arrayBuffer())),d=i&&l&&Nt(()=>{let h=!1;const b=new s(K.origin,{body:new Tt,method:"POST",get duplex(){return h=!0,"half"}}).headers.has("Content-Type");return h&&!b}),m=a&&l&&Nt(()=>c.isReadableStream(new r("").body)),p={stream:m&&(h=>h.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(h=>{!p[h]&&(p[h]=(b,g)=>{let C=b&&b[h];if(C)return C.call(b);throw new j(`Response type '${h}' is not supported`,j.ERR_NOT_SUPPORT,g)})});const f=async h=>{if(h==null)return 0;if(c.isBlob(h))return h.size;if(c.isSpecCompliantForm(h))return(await new s(K.origin,{method:"POST",body:h}).arrayBuffer()).byteLength;if(c.isArrayBufferView(h)||c.isArrayBuffer(h))return h.byteLength;if(c.isURLSearchParams(h)&&(h=h+""),c.isString(h))return(await u(h)).byteLength},R=async(h,b)=>{const g=c.toFiniteNumber(h.getContentLength());return g??f(b)};return async h=>{let{url:b,method:g,data:C,signal:M,cancelToken:E,timeout:O,onDownloadProgress:L,onUploadProgress:q,responseType:x,headers:A,withCredentials:$="same-origin",fetchOptions:I}=es(h),ee=t||fetch;x=x?(x+"").toLowerCase():"text";let P=Jr([M,E&&E.toAbortSignal()],O),V=null;const D=P&&P.unsubscribe&&(()=>{P.unsubscribe()});let te;try{if(q&&d&&g!=="get"&&g!=="head"&&(te=await R(A,C))!==0){let U=new s(b,{method:"POST",body:C,duplex:"half"}),W;if(c.isFormData(C)&&(W=U.headers.get("content-type"))&&A.setContentType(W),U.body){const[y,S]=xt(te,_e(yt(q)));C=vt(U.body,St,y,S)}}c.isString($)||($=$?"include":"omit");const _=i&&"credentials"in s.prototype,se={...I,signal:P,method:g.toUpperCase(),headers:A.normalize().toJSON(),body:C,duplex:"half",credentials:_?$:void 0};V=i&&new s(b,se);let G=await(i?ee(V,I):ee(b,se));const be=m&&(x==="stream"||x==="response");if(m&&(L||be&&D)){const U={};["status","statusText","headers"].forEach(w=>{U[w]=G[w]});const W=c.toFiniteNumber(G.headers.get("content-length")),[y,S]=L&&xt(W,_e(yt(L),!0))||[];G=new r(vt(G.body,St,y,()=>{S&&S(),D&&D()}),U)}x=x||"text";let oe=await p[c.findKey(p,x)||"text"](G,h);return!be&&D&&D(),await new Promise((U,W)=>{Zt(U,W,{data:oe,headers:Z.from(G.headers),status:G.status,statusText:G.statusText,config:h,request:V})})}catch(_){throw D&&D(),_&&_.name==="TypeError"&&/Load failed|fetch/i.test(_.message)?Object.assign(new j("Network Error",j.ERR_NETWORK,h,V),{cause:_.cause||_}):j.from(_,_&&_.code,h,V)}}},Zr=new Map,ts=e=>{let t=e&&e.env||{};const{fetch:s,Request:r,Response:n}=t,i=[r,n,s];let a=i.length,l=a,u,d,m=Zr;for(;l--;)u=i[l],d=m.get(u),d===void 0&&m.set(u,d=l?new Map:Qr(t)),m=d;return d};ts();const at={http:fr,xhr:zr,fetch:{get:ts}};c.forEach(at,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Ct=e=>`- ${e}`,Yr=e=>c.isFunction(e)||e===null||e===!1;function en(e,t){e=c.isArray(e)?e:[e];const{length:s}=e;let r,n;const i={};for(let a=0;a<s;a++){r=e[a];let l;if(n=r,!Yr(r)&&(n=at[(l=String(r)).toLowerCase()],n===void 0))throw new j(`Unknown adapter '${l}'`);if(n&&(c.isFunction(n)||(n=n.get(t))))break;i[l||"#"+a]=n}if(!n){const a=Object.entries(i).map(([u,d])=>`adapter ${u} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=s?a.length>1?`since :
`+a.map(Ct).join(`
`):" "+Ct(a[0]):"as no adapter specified";throw new j("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return n}const ss={getAdapter:en,adapters:at};function Ge(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ge(null,e)}function kt(e){return Ge(e),e.headers=Z.from(e.headers),e.data=Xe.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),ss.getAdapter(e.adapter||Ae.adapter,e)(e).then(function(r){return Ge(e),r.data=Xe.call(e,e.transformResponse,r),r.headers=Z.from(r.headers),r},function(r){return Qt(r)||(Ge(e),r&&r.response&&(r.response.data=Xe.call(e,e.transformResponse,r.response),r.response.headers=Z.from(r.response.headers))),Promise.reject(r)})}const rs="1.13.2",ze={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ze[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Et={};ze.transitional=function(t,s,r){function n(i,a){return"[Axios v"+rs+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,l)=>{if(t===!1)throw new j(n(a," has been removed"+(s?" in "+s:"")),j.ERR_DEPRECATED);return s&&!Et[a]&&(Et[a]=!0,console.warn(n(a," has been deprecated since v"+s+" and will be removed in the near future"))),t?t(i,a,l):!0}};ze.spelling=function(t){return(s,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function tn(e,t,s){if(typeof e!="object")throw new j("options must be an object",j.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let n=r.length;for(;n-- >0;){const i=r[n],a=t[i];if(a){const l=e[i],u=l===void 0||a(l,i,e);if(u!==!0)throw new j("option "+i+" must be "+u,j.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new j("Unknown option "+i,j.ERR_BAD_OPTION)}}const Le={assertOptions:tn,validators:ze},ne=Le.validators;let de=class{constructor(t){this.defaults=t||{},this.interceptors={request:new gt,response:new gt}}async request(t,s){try{return await this._request(t,s)}catch(r){if(r instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(t,s){typeof t=="string"?(s=s||{},s.url=t):s=t||{},s=me(this.defaults,s);const{transitional:r,paramsSerializer:n,headers:i}=s;r!==void 0&&Le.assertOptions(r,{silentJSONParsing:ne.transitional(ne.boolean),forcedJSONParsing:ne.transitional(ne.boolean),clarifyTimeoutError:ne.transitional(ne.boolean)},!1),n!=null&&(c.isFunction(n)?s.paramsSerializer={serialize:n}:Le.assertOptions(n,{encode:ne.function,serialize:ne.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),Le.assertOptions(s,{baseUrl:ne.spelling("baseURL"),withXsrfToken:ne.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let a=i&&c.merge(i.common,i[s.method]);i&&c.forEach(["delete","get","head","post","put","patch","common"],h=>{delete i[h]}),s.headers=Z.concat(a,i);const l=[];let u=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(s)===!1||(u=u&&b.synchronous,l.unshift(b.fulfilled,b.rejected))});const d=[];this.interceptors.response.forEach(function(b){d.push(b.fulfilled,b.rejected)});let m,p=0,f;if(!u){const h=[kt.bind(this),void 0];for(h.unshift(...l),h.push(...d),f=h.length,m=Promise.resolve(s);p<f;)m=m.then(h[p++],h[p++]);return m}f=l.length;let R=s;for(;p<f;){const h=l[p++],b=l[p++];try{R=h(R)}catch(g){b.call(this,g);break}}try{m=kt.call(this,R)}catch(h){return Promise.reject(h)}for(p=0,f=d.length;p<f;)m=m.then(d[p++],d[p++]);return m}getUri(t){t=me(this.defaults,t);const s=Yt(t.baseURL,t.url,t.allowAbsoluteUrls);return Vt(s,t.params,t.paramsSerializer)}};c.forEach(["delete","get","head","options"],function(t){de.prototype[t]=function(s,r){return this.request(me(r||{},{method:t,url:s,data:(r||{}).data}))}});c.forEach(["post","put","patch"],function(t){function s(r){return function(i,a,l){return this.request(me(l||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}de.prototype[t]=s(),de.prototype[t+"Form"]=s(!0)});let sn=class ns{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(i){s=i});const r=this;this.promise.then(n=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](n);r._listeners=null}),this.promise.then=n=>{let i;const a=new Promise(l=>{r.subscribe(l),i=l}).then(n);return a.cancel=function(){r.unsubscribe(i)},a},t(function(i,a,l){r.reason||(r.reason=new ge(i,a,l),s(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const s=this._listeners.indexOf(t);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const t=new AbortController,s=r=>{t.abort(r)};return this.subscribe(s),t.signal.unsubscribe=()=>this.unsubscribe(s),t.signal}static source(){let t;return{token:new ns(function(n){t=n}),cancel:t}}};function rn(e){return function(s){return e.apply(null,s)}}function nn(e){return c.isObject(e)&&e.isAxiosError===!0}const tt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(tt).forEach(([e,t])=>{tt[t]=e});function os(e){const t=new de(e),s=Pt(de.prototype.request,t);return c.extend(s,de.prototype,t,{allOwnKeys:!0}),c.extend(s,t,null,{allOwnKeys:!0}),s.create=function(n){return os(me(e,n))},s}const F=os(Ae);F.Axios=de;F.CanceledError=ge;F.CancelToken=sn;F.isCancel=Qt;F.VERSION=rs;F.toFormData=We;F.AxiosError=j;F.Cancel=F.CanceledError;F.all=function(t){return Promise.all(t)};F.spread=rn;F.isAxiosError=nn;F.mergeConfig=me;F.AxiosHeaders=Z;F.formToJSON=e=>Gt(c.isHTMLForm(e)?new FormData(e):e);F.getAdapter=ss.getAdapter;F.HttpStatusCode=tt;F.default=F;const{Axios:Un,AxiosError:Hn,CanceledError:Bn,isCancel:qn,CancelToken:Wn,VERSION:zn,all:Jn,Cancel:Kn,isAxiosError:Vn,spread:Xn,toFormData:Gn,AxiosHeaders:Qn,HttpStatusCode:Zn,formToJSON:Yn,getAdapter:eo,mergeConfig:to}=F,on=()=>"https://api.protonestconnect.co/api/v1/user",it=on();console.log("ðŸ”§ API Base URL:",it);const ke=F.create({baseURL:it,headers:{"Content-Type":"application/json"},timeout:15e3});ke.interceptors.request.use(e=>{const t=localStorage.getItem("jwtToken");return t&&t!=="MOCK_TOKEN_FOR_TESTING"&&(e.headers["X-Token"]=t),console.log("ðŸ“¤ API Request:",{method:e.method?.toUpperCase(),url:e.url,baseURL:e.baseURL,hasToken:!!t&&t!=="MOCK_TOKEN_FOR_TESTING",payload:e.data||void 0}),e},e=>(console.error("âŒ Request interceptor error:",e),Promise.reject(e)));ke.interceptors.response.use(e=>(console.log("ðŸ“¥ API Response:",{status:e.status,url:e.config.url,method:e.config.method?.toUpperCase()}),e),async e=>{const t=e.config;if(e.response){const s=e.response.status===400,r=e.response.data?.data||e.response.data?.message;if((!s||!window.__api400ErrorLogged&&r!=="Device does not belong to the user")&&(console.error("âŒ API Error Response:",{status:e.response.status,statusText:e.response.statusText,url:t?.url,method:t?.method?.toUpperCase(),data:e.response.data,allowHeader:e.response.headers?.allow}),s&&(window.__api400ErrorLogged=!0)),e.response.status===400){const n=e.response.data?.data||e.response.data?.message;if(n==="Device does not belong to the user")return window.__deviceAuthErrorShown||(console.error(`
ðŸš« DEVICE AUTHORIZATION ERROR`),console.error("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),console.error("âŒ Device does not belong to your account"),console.error(`
ðŸ’¡ TO FIX THIS:`),console.error("   1. Go to: https://api.protonestconnect.co"),console.error("   2. Find your device ID in your dashboard"),console.error(`   3. Update 'defaultDeviceId' in Dashboard.jsx
`),console.error(`â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
`),window.__deviceAuthErrorShown=!0),Promise.reject(e);n!=="Device does not belong to the user"&&console.error("ðŸ” 400 Error:",{endpoint:t?.url,message:n})}}if(e.response?.status===405)return console.error("ðŸš« Method Not Allowed (405):",{attempted:t?.method?.toUpperCase(),endpoint:t?.url,allowed:e.response.headers?.allow||"Not specified"}),Promise.reject(e);if((e.response?.status===400||e.response?.status===401)&&!t?.url?.includes("/get-token")&&(e.response?.data?.data==="Invalid token"||e.response?.data?.message?.includes("token"))&&!t._retry){t._retry=!0;try{const s=localStorage.getItem("refreshToken");if(!s)throw new Error("No refresh token available");console.log("ðŸ”„ Attempting token refresh...");const r=await F.post(`${it}/get-new-token`,{},{headers:{"X-Refresh-Token":s},timeout:1e4});if(r.data.status==="Success"){const{jwtToken:n}=r.data.data;return localStorage.setItem("jwtToken",n),t.headers["X-Token"]=n,console.log("âœ… Token refreshed successfully"),ke(t)}}catch(s){console.error("âŒ Token refresh failed:",s.message),localStorage.clear(),window.location.href="/"}}return Promise.reject(e)});const an=async(e,t,s=null,r=null,n=0,i=100)=>{try{const a=f=>f.toISOString().split(".")[0]+"Z",l=new Date,u=r?new Date(r):l,d=s?new Date(s):new Date(l.getTime()-1440*60*1e3);console.log(`â° [HTTP] Time calculation for ${t}:`,{currentTime:l.toISOString(),startTime:d.toISOString(),endTime:u.toISOString(),rangeHours:((u-d)/(1e3*60*60)).toFixed(1)});const m={deviceId:e,topic:t,startTime:a(d),endTime:a(u),pagination:String(n),pageSize:String(i)};console.log(`ðŸ“¤ [HTTP] Fetching ${t} data:`),console.log(JSON.stringify({deviceId:m.deviceId,topic:m.topic,startTime:m.startTime,endTime:m.endTime,pagination:m.pagination,pageSize:m.pageSize},null,2));const p=await ke.post("/get-stream-data/device/topic",m);if(console.log(`ðŸ“¥ [HTTP] Response for ${t}:`,{status:p.data.status,dataLength:p.data.data?.length||0}),p.data.status==="Success"){const f=p.data.data?.length||0;return f>0?(console.log(`âœ… ${t}: ${f} records`),console.log(`ðŸ“‹ [HTTP] Sample ${t} record:`,p.data.data[0])):console.log(`â„¹ï¸ ${t}: No data found in time range`),p.data.data||[]}return[]}catch(a){let l="Unknown error";return a.response?.data?l=a.response.data.data||a.response.data.message||a.response.data.error||(typeof a.response.data=="string"?a.response.data:null)||JSON.stringify(a.response.data):a.message&&(l=a.message),console.warn(`âš ï¸ [HTTP] Error fetching ${t}:`,{status:a.response?.status||"No response",statusText:a.response?.statusText||"N/A",message:l,fullResponse:a.response?.data}),[]}},ln=async(e,t=null,s=null)=>{const r=[{name:"temp",label:"temperature"},{name:"moisture",label:"moisture"},{name:"humidity",label:"humidity"},{name:"battery",label:"battery"},{name:"light",label:"light"}];try{console.log(`ðŸ“Š [HTTP] Fetching historical data for ${e}`),console.log(`ðŸ“… [HTTP] Time range: ${t||"Last 24h"} to ${s||"Now"}`);const n=await Promise.allSettled(r.map(p=>an(e,p.name,t,s,0,100))),i=n.filter(p=>p.status==="fulfilled"&&p.value.length>0).length,a=n.filter(p=>p.status==="rejected").length,l=n.filter(p=>p.status==="fulfilled"&&p.value.length===0).length;console.log("ðŸ“Š [HTTP] Historical data summary:",{successful:i,empty:l,failed:a,total:r.length}),i>0?console.log(`âœ… [HTTP] Loaded ${i} topics with historical data`):window.__historicalDataWarningShown||(console.warn("â„¹ï¸ [HTTP] No historical data available yet. Real-time data will still work."),console.warn("ðŸ’¡ [HTTP] Possible reasons:"),console.warn("   1. Device recently added - ProtoNest hasn't saved MQTT data to DB yet"),console.warn("   2. Topic names mismatch - check what topic names are saved in DB"),console.warn("   3. Device not in your account - verify device ownership"),window.__historicalDataWarningShown=!0);const u=new Map;n.forEach((p,f)=>{const R=r[f],h=R.name,b=R.label;p.status==="fulfilled"&&Array.isArray(p.value)?(console.log(`ðŸ” [HTTP] Processing ${h}: ${p.value.length} records`),p.value.forEach(g=>{const C=g.timestamp||g.time||new Date().toISOString();u.has(C)||u.set(C,{timestamp:C,time:new Date(C).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),moisture:null,temperature:null,humidity:null,light:null,battery:null});const M=u.get(C);let E=g;if(g.payload&&typeof g.payload=="string")try{E=JSON.parse(g.payload)}catch{console.warn(`âš ï¸ Failed to parse payload for ${h}:`,g.payload),E=g}else g.payload&&typeof g.payload=="object"&&(E=g.payload);b==="temperature"||h==="temp"?(M.temperature=Number(E.temp||E.temperature||g.value||0),console.log(`  ðŸ“Š [${C}] temperature: ${M.temperature}`)):b==="moisture"?(M.moisture=Number(E.moisture||g.value||0),console.log(`  ðŸ“Š [${C}] moisture: ${M.moisture}`)):b==="humidity"?(M.humidity=Number(E.humidity||g.value||0),console.log(`  ðŸ“Š [${C}] humidity: ${M.humidity}`)):b==="battery"?(M.battery=Number(E.battery||g.value||0),console.log(`  ðŸ“Š [${C}] battery: ${M.battery}`)):b==="light"&&(M.light=Number(E.light||g.value||0),console.log(`  ðŸ“Š [${C}] light: ${M.light}`))})):p.status==="rejected"&&console.warn(`âš ï¸ [HTTP] Failed to fetch ${h} data:`,p.reason?.message)});const d=Array.from(u.values()).sort((p,f)=>new Date(p.timestamp)-new Date(f.timestamp)),m={moisture:null,temperature:null,humidity:null,light:null,battery:null};return d.forEach(p=>{Object.keys(m).forEach(f=>{p[f]!==null&&p[f]!==void 0&&p[f]!==0?m[f]=p[f]:m[f]!==null&&(p[f]=m[f])})}),d.length>0&&(console.log(`âœ… [HTTP] Historical data: ${d.length} data points combined`),console.log(`ðŸ“… [HTTP] Time range: ${d[0].time} to ${d[d.length-1].time}`),console.log("ðŸ“Š [HTTP] Latest data point:",d[d.length-1])),d}catch(n){throw console.error("âŒ [HTTP] Error fetching all stream data:",n),n}},cn=async(e,t,s={})=>{try{console.log("Updating device state:",{deviceId:e,topic:t,payload:s});const r={deviceId:e,topic:t,payload:s};console.log("ðŸ“¤ Update state request body:",JSON.stringify(r,null,2));const n=await ke.post("/update-state-details",r);return console.log("âœ… Device state update response:",n.data),n.data}catch(r){throw r.response?.status===405&&(console.error("âŒ Method not allowed for update-state-details. Server may not support POST."),console.error("Allowed methods:",r.response.headers?.allow||"Unknown")),r.response?.status===400&&console.error("ðŸ” Device Update 400 Error Analysis:",{endpoint:"/update-state-details",sentPayload:requestBody,serverResponse:r.response.data,possibleCauses:["Invalid deviceId format","Topic not found or invalid format","Payload structure incorrect (should be key-value pairs)","Missing required parameters (deviceId, topic, payload)","Topic doesn't exist - new topic will be created automatically"]}),console.error("âŒ Error updating device state:",{status:r.response?.status,statusText:r.response?.statusText,data:r.response?.data,message:r.message,url:r.config?.url,method:r.config?.method,requestBody}),r}},Qe=async(e,t,s="pump",r="auto")=>{const n=t.toLowerCase();return console.log("ðŸ“¤ Sending pump command via HTTP API:",{deviceId:e,topic:s,pump:n,mode:r}),cn(e,s,{pump:n,mode:r})},un=e=>{if(!e)return console.error("âŒ Cannot build WebSocket URL: No JWT token available"),null;const t=encodeURIComponent(e),s=`wss://api.protonestconnect.co/ws?token=${t}`;return console.log("ðŸ”Œ WebSocket URL built:",s.replace(t,"***TOKEN***")),s};class dn{constructor(){this.client=null,this.currentDeviceId=null,this.subscriptions=new Map,this.dataCallback=null,this.connectCallback=null,this.disconnectCallback=null,this.isReady=!1,this.jwtToken=null}_initializeClient(t){if(this.client){console.log("[WebSocketClient] Client already initialized");return}const s=un(t);if(!s)throw new Error("Failed to build WebSocket URL - invalid token");this.client=new bs({brokerURL:s,reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3,onConnect:r=>{console.log("âœ… WebSocket Connected:",r),this.isReady=!0,this.currentDeviceId&&this._subscribeToDeviceTopics(this.currentDeviceId),this.connectCallback&&this.connectCallback()},onStompError:r=>{console.error("âŒ Broker reported error:",r.headers.message),console.error("Details:",r.body)},onWebSocketError:r=>{console.error("ðŸš« WebSocket error",r)},onWebSocketClose:r=>{console.warn("ðŸ”» WebSocket closed",r),this.isReady=!1,this.disconnectCallback&&this.disconnectCallback()},debug:r=>console.log("ðŸªµ Debug:",r)}),this.client.activate(),console.log("[WebSocketClient] STOMP client activated")}_subscribeToDeviceTopics(t){const s=this,r=`/topic/stream/${t}`,n=this.client.subscribe(r,l=>{const u=JSON.parse(l.body);if(console.log(`ðŸ“¡ [${t}] Received stream data:`,u),s.dataCallback){const d=u.payload||u,m=u.topic,p={temp:"temp",temperature:"temp",humidity:"humidity",moisture:"moisture",light:"light",battery:"battery"},R=Object.keys(p).filter(h=>d[h]!==void 0);if(R.length>2){console.log(`ðŸŽ¯ [${t}] Received BATCH state update with ${R.length} sensors`);const h={};R.forEach(b=>{const g=p[b];h[g]=d[b],console.log(`   - ${g}: ${d[b]}`)}),s.dataCallback({sensorType:"batchUpdate",value:h,timestamp:u.timestamp||new Date().toISOString()})}else{let h=!1;if(m&&d[m]!==void 0){const b=p[m]||m;console.log(`ðŸŽ¯ [${t}] Calling Dashboard callback: ${b} = ${d[m]}`),s.dataCallback({sensorType:b,value:d[m],timestamp:u.timestamp||new Date().toISOString()}),h=!0}else for(const[b,g]of Object.entries(p))d[b]!==void 0&&(console.log(`ðŸŽ¯ [${t}] Calling Dashboard callback: ${g} = ${d[b]}`),s.dataCallback({sensorType:g,value:d[b],timestamp:u.timestamp||new Date().toISOString()}),h=!0);h||console.warn(`âš ï¸ [${t}] No recognized sensor field in message:`,u)}}else console.warn(`âš ï¸ [${t}] No callback registered yet - data will be lost:`,u)});this.subscriptions.set(`stream-${t}`,n),console.log(`ðŸ”” Subscribed to ${r}`);const i=`/topic/state/${t}`,a=this.client.subscribe(i,l=>{const u=JSON.parse(l.body);console.log(`ðŸ”§ [${t}] Pump state received:`,u);const d=u.payload||u;if(s.dataCallback){const m=d.power||d.status||d.pumpStatus;if(m!==void 0){const f=String(m).toUpperCase();console.log(`ðŸŽ¯ [${t}] Calling Dashboard callback: pumpStatus = ${f}`),s.dataCallback({sensorType:"pumpStatus",value:f,timestamp:u.timestamp||new Date().toISOString()})}const p=d.mode||d.pumpMode;if(p!==void 0){const f=String(p).toLowerCase();console.log(`ðŸŽ¯ [${t}] Calling Dashboard callback: pumpMode = ${f}`),s.dataCallback({sensorType:"pumpMode",value:f,timestamp:u.timestamp||new Date().toISOString()})}}});this.subscriptions.set(`state-${t}`,a),console.log(`ðŸ”” Subscribed to ${i}`)}_unsubscribeFromDeviceTopics(t){const s=`stream-${t}`,r=`state-${t}`;this.subscriptions.has(s)&&(this.subscriptions.get(s).unsubscribe(),this.subscriptions.delete(s),console.log(`ðŸ”• Unsubscribed from /topic/stream/${t}`)),this.subscriptions.has(r)&&(this.subscriptions.get(r).unsubscribe(),this.subscriptions.delete(r),console.log(`ðŸ”• Unsubscribed from /topic/state/${t}`))}async connect(t){if(!t)throw console.error("[WebSocketClient] âŒ Cannot connect: No JWT token provided"),new Error("JWT token required for WebSocket connection");return this.jwtToken=t,this.client?this.isConnected?console.log("[WebSocketClient] âœ… Already connected"):(console.log("[WebSocketClient] ðŸ”„ Reconnecting..."),this.client.activate()):(console.log("[WebSocketClient] ðŸ”„ Initializing STOMP client..."),this._initializeClient(t)),Promise.resolve()}subscribeToDevice(t,s){return this.currentDeviceId&&this.currentDeviceId!==t&&(console.log(`[WebSocketClient] ðŸ”„ Switching from ${this.currentDeviceId} to ${t}`),this._unsubscribeFromDeviceTopics(this.currentDeviceId)),this.currentDeviceId=t,this.dataCallback=s,console.log(`[WebSocketClient] Callback registered for device: ${t}`),this.isReady&&this.isConnected?this._subscribeToDeviceTopics(t):console.log(`[WebSocketClient] Will subscribe to ${t} when connection is ready`),!0}get isConnected(){return this.client?.connected||!1}getConnectionStatus(){return this.isConnected}onConnect(t){this.connectCallback=t,this.isConnected&&t()}onDisconnect(t){this.disconnectCallback=t}sendPumpCommand(t,s,r=null){if(!this.isConnected)return console.warn("[WebSocketClient] Cannot send command - not connected"),!1;const n=`protonest/${t}/state/motor/paddy`,i={power:s.toLowerCase()};r&&(i.mode=r.toLowerCase());try{return this.client.publish({destination:n,body:JSON.stringify(i)}),console.log("[WebSocketClient] ðŸ“¤ Sent pump command:",i),!0}catch(a){return console.error("[WebSocketClient] âŒ Failed to send pump command:",a),!1}}disconnect(){this.client&&this.isConnected?(console.log("[WebSocketClient] ðŸ”Œ Disconnecting..."),this.currentDeviceId&&this._unsubscribeFromDeviceTopics(this.currentDeviceId),this.client.deactivate(),this.isReady=!1):console.log("[WebSocketClient] Already disconnected")}enableTestingMode(){typeof window>"u"||(window.sendPumpCommand=(t,s=null)=>this.currentDeviceId?this.sendPumpCommand(this.currentDeviceId,t,s):(console.error("âŒ No device selected. Subscribe to a device first."),!1),window.simulateSensorData=(t,s)=>{if(!this.isConnected)return console.error("âŒ Not connected"),!1;if(!this.currentDeviceId)return console.error("âŒ No device selected. Subscribe to a device first."),!1;const r=`protonest/${this.currentDeviceId}/stream/${t}`,n={[t]:String(s)};try{return this.client.publish({destination:r,body:JSON.stringify(n)}),console.log("ðŸ“¤ Simulated:",n),!0}catch(i){return console.error("âŒ Failed:",i),!1}},window.wsInfo=()=>{console.log("ðŸ“Š WebSocket Info:"),console.log("   Connected:",this.isConnected),console.log("   Current Device:",this.currentDeviceId||"None"),console.log("   Active Subscriptions:",Array.from(this.subscriptions.keys()))},console.log(""),console.log("ðŸ§ª Testing Mode Enabled!"),console.log('   sendPumpCommand("on")'),console.log('   sendPumpCommand("off")'),console.log('   simulateSensorData("temp", 25.5)'),console.log("   wsInfo()"),console.log(""))}}const ve=new dn;var mn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const pn=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),hn=(e,t)=>{const s=N.forwardRef(({color:r="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:a,children:l,...u},d)=>N.createElement("svg",{ref:d,...mn,width:n,height:n,stroke:r,strokeWidth:a?Number(i)*24/Number(n):i,className:`lucide lucide-${pn(e)}`,...u},[...t.map(([m,p])=>N.createElement(m,p)),...(Array.isArray(l)?l:[l])||[]]));return s.displayName=`${e}`,s};var J=hn;const fn=J("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),as=J("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),gn=J("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Mt=J("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),bn=J("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Rt=J("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Se=J("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Te=J("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),xn=J("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Ue=J("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),yn=J("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),is=J("Power",[["path",{d:"M18.36 6.64a9 9 0 1 1-12.73 0",key:"phirl6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"12",key:"aemgbe"}]]),wn=J("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),vn=J("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Sn=J("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]),Tn=J("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),ls=J("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),jn=({deviceId:e,deviceList:t})=>{const{userId:s,logout:r}=st(),n=ps(),i=a=>{const l=a.target.value;n(`/dashboard/${l}`)};return o.jsxs("header",{className:"bg-white border-2 rounded-lg px-6 py-3 flex flex-col sm:flex-row justify-between items-center shadow-sm mb-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4 sm:mb-0",children:[o.jsx(Sn,{className:"h-8 w-8 text-green-600"}),o.jsxs("span",{className:"text-3xl font-bold tracking-wide font-mono",children:["Agri",o.jsx("span",{className:"text-yellow-400",children:"Cop"})]})]}),o.jsxs("div",{className:"flex items-center gap-2 mb-4 sm:mb-0",children:[o.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Select Device:"}),o.jsx("select",{value:e,onChange:i,className:"bg-gray-100 border border-gray-300 text-gray-700 py-1 px-3 rounded focus:ring-2 focus:ring-green-500 outline-none font-medium",children:t.map(a=>o.jsx("option",{value:a,children:a},a))})]}),o.jsxs("div",{className:"text-right text-xs",children:[o.jsx("div",{className:"text-green-600 font-bold",children:"Authentication: Successful"}),o.jsxs("div",{className:"text-gray-600 font-mono",children:["User: ",s]}),o.jsxs("button",{onClick:r,className:"text-red-500 hover:underline mt-1 flex items-center justify-end gap-1 w-full",children:["Logout ",o.jsx(yn,{className:"w-3 h-3"})]})]})]})},je=({label:e,value:t,unit:s,status:r,decimals:n=1})=>{const i=l=>{switch(l){case"critical":return"text-red-600 bg-red-50";case"warning":return"text-yellow-600 bg-yellow-50";case"optimal":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}},a=l=>l==null?"0.0":typeof l=="number"?l.toFixed(n):l;return o.jsxs("div",{className:`p-2 rounded-lg ${i(r)}`,children:[o.jsx("div",{className:"font-medium",children:e}),o.jsxs("div",{children:[a(t),s," - ",r]})]})},At=({label:e,value:t,onChange:s,min:r,max:n,step:i="1",error:a,unit:l=""})=>o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:[e," ",l&&`(${l})`]}),o.jsx("input",{type:"number",min:r,max:n,step:i,value:t,onChange:s,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none ${a?"border-red-300":"border-gray-300"}`}),a&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:a})]}),Ne=({title:e,minConfig:t,maxConfig:s,rangeError:r})=>o.jsxs("div",{className:"space-y-4",children:[o.jsx("h4",{className:"font-semibold text-gray-700 border-b pb-2",children:e}),r&&o.jsxs("div",{className:"text-red-600 text-sm flex items-center gap-2",children:[o.jsx(ls,{className:"w-4 h-4"}),r]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsx(At,{...t}),s&&o.jsx(At,{...s})]})]}),Nn=({status:e})=>e?o.jsxs("div",{className:`p-3 rounded-lg flex items-center gap-2 ${e.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[e.type==="success"?o.jsx(gn,{className:"w-4 h-4"}):o.jsx(ls,{className:"w-4 h-4"}),o.jsx("span",{className:"text-sm font-medium",children:e.message})]}):null,Cn=({onClick:e,disabled:t,loading:s,loadingText:r="Processing...",icon:n,children:i,className:a=""})=>o.jsx("button",{onClick:e,disabled:t||s,className:`flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center gap-2 transition ${a}`,children:s?o.jsxs(o.Fragment,{children:[o.jsx(Ue,{className:"w-4 h-4 animate-spin"}),r]}):o.jsxs(o.Fragment,{children:[n&&o.jsx(n,{className:"w-4 h-4"}),i]})}),kn=({pumpStatus:e,pumpMode:t,isAutoMode:s,isLoading:r,onToggle:n})=>{const i=s?"auto":"manual";return o.jsx("div",{className:`${s?"opacity-50 pointer-events-none":""}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"font-medium text-gray-700",children:["Manual Control ",s&&"(Disabled)"]}),o.jsxs("div",{className:"text-sm text-gray-500",children:["Status: ",o.jsx("span",{className:`font-bold ml-1 ${e==="ON"?"text-green-600":"text-gray-600"}`,children:e}),o.jsx("span",{className:"text-xs ml-2 px-2 py-0.5 bg-blue-100 text-blue-700 rounded capitalize",children:i})]})]}),o.jsx("button",{onClick:n,disabled:r||s,className:`px-6 py-3 rounded-lg font-bold flex items-center gap-2 transition-all duration-300 min-w-[140px] justify-center ${e==="ON"?"bg-red-600 hover:bg-red-700 text-white shadow-lg shadow-red-200":"bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-200"} disabled:opacity-50 disabled:cursor-not-allowed`,children:r?o.jsxs(o.Fragment,{children:[o.jsx(Ue,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):o.jsxs(o.Fragment,{children:[o.jsx(is,{className:"w-5 h-5"}),e==="ON"?"Turn OFF":"Turn ON"]})})]})})},En=({enabled:e,onToggle:t,title:s="Automatic Mode",description:r="Auto control pump based on moisture thresholds"})=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-700",children:s}),o.jsx("div",{className:"text-xs text-gray-500",children:r})]}),o.jsx("button",{onClick:t,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e?"bg-blue-600":"bg-gray-300"}`,children:o.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e?"translate-x-6":"translate-x-1"}`})})]}),Mn=({settings:e,setSettings:t,handleSaveSettings:s,commandInProgress:r,commandStatus:n,liveData:i,togglePump:a,pumpStatus:l})=>{const[u,d]=N.useState(e),[m,p]=N.useState(!1),[f,R]=N.useState({});N.useEffect(()=>{d(e),p(!1)},[e]);const h=x=>{const A={},$=parseFloat(x.moistureMin),I=parseFloat(x.moistureMax),ee=parseFloat(x.tempMin),P=parseFloat(x.tempMax),V=parseFloat(x.humidityMin),D=parseFloat(x.humidityMax),te=parseFloat(x.lightMin),_=parseFloat(x.lightMax),se=parseFloat(x.batteryMin);return(isNaN($)||$<0||$>100)&&(A.moistureMin="Must be between 0-100%"),(isNaN(I)||I<0||I>100)&&(A.moistureMax="Must be between 0-100%"),$>=I&&(A.moistureRange="Min must be less than max"),(isNaN(ee)||ee<-10||ee>50)&&(A.tempMin="Must be between -10 to 50Â°C"),(isNaN(P)||P<0||P>60)&&(A.tempMax="Must be between 0-60Â°C"),ee>=P&&(A.tempRange="Min must be less than max"),(isNaN(V)||V<0||V>100)&&(A.humidityMin="Must be between 0-100%"),(isNaN(D)||D<0||D>100)&&(A.humidityMax="Must be between 0-100%"),V>=D&&(A.humidityRange="Min must be less than max"),(isNaN(te)||te<0||te>2e3)&&(A.lightMin="Must be between 0-2000 lux"),(isNaN(_)||_<0||_>2e3)&&(A.lightMax="Must be between 0-2000 lux"),te>=_&&(A.lightRange="Min must be less than max"),(isNaN(se)||se<0||se>100)&&(A.batteryMin="Must be between 0-100%"),A},b=(x,A)=>{const $={...u,[x]:A};d($),p(!0);const I=h($);R(I)},g=async()=>{const x=h(u);if(Object.keys(x).length>0){R(x);return}t(u),await s(),p(!1)},C=(x,A,$)=>x?x<A?"critical":x>$?"warning":"optimal":"unknown",M=C(i?.moisture,parseFloat(u.moistureMin),parseFloat(u.moistureMax)),E=C(i?.temperature,parseFloat(u.tempMin),parseFloat(u.tempMax)),O=C(i?.humidity,parseFloat(u.humidityMin),parseFloat(u.humidityMax)),L=C(i?.light,parseFloat(u.lightMin),parseFloat(u.lightMax)),q=C(i?.battery,parseFloat(u.batteryMin),100);return o.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-md border border-gray-100 space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(vn,{className:"w-6 h-6 text-gray-600"}),o.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Device Settings"})]}),m&&o.jsxs("div",{className:"flex items-center gap-2 text-amber-600 text-sm",children:[o.jsx(as,{className:"w-4 h-4"}),o.jsx("span",{children:"Unsaved changes"})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[o.jsxs("h4",{className:"font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[o.jsx(xn,{className:"w-4 h-4"}),"Current Status"]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[o.jsx(je,{label:"Moisture",value:i?.moisture,unit:"%",status:M,decimals:1}),o.jsx(je,{label:"Temperature",value:i?.temperature,unit:"Â°C",status:E,decimals:1}),o.jsx(je,{label:"Humidity",value:i?.humidity,unit:"%",status:O,decimals:1}),o.jsx(je,{label:"Light",value:i?.light,unit:" lux",status:L,decimals:0}),o.jsx(je,{label:"Battery",value:i?.battery,unit:"%",status:q,decimals:1})]})]}),o.jsx(Ne,{title:"Soil Moisture Thresholds",rangeError:f.moistureRange,minConfig:{label:"Minimum Threshold",unit:"%",value:u.moistureMin,onChange:x=>b("moistureMin",x.target.value),min:"0",max:"100",step:"1",error:f.moistureMin},maxConfig:{label:"Maximum Threshold",unit:"%",value:u.moistureMax,onChange:x=>b("moistureMax",x.target.value),min:"0",max:"100",step:"1",error:f.moistureMax}}),o.jsx(Ne,{title:"Temperature Thresholds",rangeError:f.tempRange,minConfig:{label:"Minimum Temperature",unit:"Â°C",value:u.tempMin,onChange:x=>b("tempMin",x.target.value),min:"-10",max:"50",step:"0.5",error:f.tempMin},maxConfig:{label:"Maximum Temperature",unit:"Â°C",value:u.tempMax,onChange:x=>b("tempMax",x.target.value),min:"0",max:"60",step:"0.5",error:f.tempMax}}),o.jsx(Ne,{title:"Humidity Thresholds",rangeError:f.humidityRange,minConfig:{label:"Minimum Humidity",unit:"%",value:u.humidityMin,onChange:x=>b("humidityMin",x.target.value),min:"0",max:"100",step:"1",error:f.humidityMin},maxConfig:{label:"Maximum Humidity",unit:"%",value:u.humidityMax,onChange:x=>b("humidityMax",x.target.value),min:"0",max:"100",step:"1",error:f.humidityMax}}),o.jsx(Ne,{title:"Light Intensity Thresholds",rangeError:f.lightRange,minConfig:{label:"Minimum Light",unit:"lux",value:u.lightMin,onChange:x=>b("lightMin",x.target.value),min:"0",max:"2000",step:"10",error:f.lightMin},maxConfig:{label:"Maximum Light",unit:"lux",value:u.lightMax,onChange:x=>b("lightMax",x.target.value),min:"0",max:"2000",step:"10",error:f.lightMax}}),o.jsx(Ne,{title:"Battery Protection",minConfig:{label:"Minimum Battery Level",unit:"%",value:u.batteryMin,onChange:x=>b("batteryMin",x.target.value),min:"0",max:"100",step:"1",error:f.batteryMin}}),o.jsx("div",{className:"flex gap-3",children:o.jsx(Cn,{onClick:g,disabled:Object.keys(f).length>0||!m,loading:r==="settings",loadingText:"Saving...",icon:wn,children:"Save Changes"})}),o.jsx(Nn,{status:n}),o.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(is,{className:"w-5 h-5 text-gray-600"}),o.jsx("h4",{className:"font-semibold text-gray-700",children:"Pump Control"})]}),o.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-4",children:[o.jsx(En,{enabled:u.autoMode,onToggle:()=>b("autoMode",!u.autoMode),title:"Automatic Mode",description:"Auto control pump based on moisture thresholds"}),o.jsx(kn,{pumpStatus:l,pumpMode:i?.pumpMode,isAutoMode:u.autoMode,isLoading:r==="pump",onToggle:a})]})]})]})},Ce=({value:e,label:t,borderColor:s})=>o.jsxs("div",{className:`bg-white rounded-xl p-5 shadow-sm flex flex-col items-center justify-center relative overflow-hidden transition-all duration-300 border-t-4 ${s}`,children:[o.jsx("div",{className:"text-2xl font-bold text-gray-800 mt-2",children:e}),o.jsx("div",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide mt-1",children:t})]}),Rn=({chartData:e,isLoading:t,onExportCSV:s,isExporting:r,dataSource:n="None",error:i=null,timeRange:a="1h",dataInterval:l="auto",onTimeRangeChange:u,onDataIntervalChange:d,allData:m=[],onFilteredDataChange:p})=>{const[f,R]=N.useState({moisture:!0,temperature:!0,humidity:!0,light:!0,battery:!0}),[h,b]=N.useState(!1),[g,C]=N.useState(""),[M,E]=N.useState("minutes"),[O,L]=N.useState(""),[q,x]=N.useState("seconds"),[A,$]=N.useState(!1),[I,ee]=N.useState(a),[P,V]=N.useState(l),[D,te]=N.useState("all"),_=()=>{if(!g||parseFloat(g)<=0){alert("Please enter a valid time range value");return}const v={seconds:1e3,minutes:60*1e3,hours:3600*1e3,days:1440*60*1e3},H=`custom_${parseFloat(g)*v[M]}`;if(se[H]=`${g} ${M.charAt(0).toUpperCase()+M.slice(1)}`,O&&parseFloat(O)>0){const Y=`custom_interval_${parseFloat(O)*v[q]}`;G[Y]=`${O} ${q.charAt(0).toUpperCase()+q.slice(1)}`,d&&d(Y)}u&&u(H),b(!1)},se={"1m":"Last 1 Minute","5m":"Last 5 Minutes","15m":"Last 15 Minutes","1h":"Last 1 Hour","6h":"Last 6 Hours","24h":"Last 24 Hours"},G={auto:"Auto","1s":"1 Second","5s":"5 Seconds","1m":"1 Minute","5m":"5 Minutes","1h":"1 Hour"},oe=(v=>{if(v.startsWith("custom_")){const H=parseInt(v.replace("custom_","")),B=["auto"];return H>=1e3&&B.push("1s"),H>=5e3&&B.push("5s"),H>=6e4&&B.push("1m"),H>=3e5&&B.push("5m"),H>=36e5&&B.push("1h"),B}return{"1m":["auto","1s"],"5m":["auto","1s","5s"],"15m":["auto","1s","5s","1m"],"1h":["auto","1s","5s","1m","5m"],"6h":["auto","5s","1m","5m"],"24h":["auto","1m","5m","1h"]}[v]||["auto"]})(a),U=N.useMemo(()=>{if(!m||m.length===0)return e;const v=new Date;let k;a.startsWith("custom_")?k=parseInt(a.replace("custom_","")):k={"1m":60*1e3,"5m":300*1e3,"15m":900*1e3,"1h":3600*1e3,"6h":360*60*1e3,"24h":1440*60*1e3}[a]||3600*1e3;const H=v.getTime()-k;let B=m.filter(X=>new Date(X.timestamp).getTime()>=H);if(l!=="auto"&&B.length>0){let X;if(l.startsWith("custom_interval_")?X=parseInt(l.replace("custom_interval_","")):X={"1s":1e3,"5s":5e3,"1m":6e4,"5m":5*6e4,"1h":60*6e4}[l]||0,X>0){const le=new Map;B.forEach(ce=>{const ae=new Date(ce.timestamp).getTime(),ie=Math.floor(ae/X)*X;if(!le.has(ie))le.set(ie,ce);else{const Je=le.get(ie),cs=new Date(Je.timestamp).getTime();Math.abs(ae-ie)<Math.abs(cs-ie)&&le.set(ie,ce)}}),B=Array.from(le.values()).sort((ce,ae)=>new Date(ce.timestamp).getTime()-new Date(ae.timestamp).getTime())}}const Y=l==="1s"||l==="5s"||l.startsWith("custom_interval_")&&parseInt(l.replace("custom_interval_",""))<6e4;return B=B.map(X=>({...X,time:new Date(X.timestamp).toLocaleTimeString([],Y?{hour:"2-digit",minute:"2-digit",second:"2-digit"}:{hour:"2-digit",minute:"2-digit"})})),B},[m,e,a,l]),W=v=>{R(k=>({...k,[v]:!k[v]}))},y=Object.values(f).every(v=>v===!0);pe.useEffect(()=>{p&&p(U)},[U,p]);const S=()=>{const v=Object.keys(f).filter(k=>f[k]);u&&u(I),d&&d(P),setTimeout(()=>{s&&s(v),$(!1)},100)},w=()=>{u&&u(I),d&&d(P),setTimeout(()=>{s&&s(),$(!1)},100)},z=v=>{const k=v==="selected"?Object.keys(f).filter(H=>f[H]):null;s&&s(k),$(!1)};pe.useEffect(()=>{A&&(ee(a),V(l))},[A,a,l]);const T=(v,k)=>`px-3 py-1.5 rounded-md text-xs font-bold flex items-center gap-2 transition-all border ${v?`${k} text-white border-transparent shadow-sm`:"bg-gray-50 text-gray-500 border-gray-200 hover:bg-gray-100"}`;return o.jsxs("div",{className:"lg:col-span-2 bg-white rounded-3xl p-6 shadow-md flex flex-col border border-gray-100",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Historical Trends"}),o.jsxs("span",{className:"text-xs bg-gray-100 text-gray-500 px-2 py-1 rounded-full flex items-center gap-1",children:[o.jsx(Mt,{className:"w-3 h-3"}),se[a]||a.replace("custom_","").replace(/\d+/,v=>{const k=parseInt(v);return k>=864e5?`${(k/864e5).toFixed(1)} Days`:k>=36e5?`${(k/36e5).toFixed(1)} Hours`:k>=6e4?`${(k/6e4).toFixed(1)} Minutes`:`${(k/1e3).toFixed(1)} Seconds`})]}),l!=="auto"&&o.jsx("span",{className:"text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded-full border border-indigo-200",children:G[l]||l.replace("custom_interval_","").replace(/\d+/,v=>{const k=parseInt(v);return k>=36e5?`${(k/36e5).toFixed(1)} Hour Interval`:k>=6e4?`${(k/6e4).toFixed(1)} Min Interval`:`${(k/1e3).toFixed(1)}s Interval`})}),U.length>0&&o.jsxs("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full border border-purple-200",children:[U.length," points"]}),n!=="None"&&o.jsxs("span",{className:`text-xs px-2 py-1 rounded-full flex items-center gap-1 ${n==="API"?"bg-blue-100 text-blue-700 border border-blue-200":"bg-green-100 text-green-700 border border-green-200"}`,children:[n==="API"?o.jsx(bn,{className:"w-3 h-3"}):o.jsx(Tn,{className:"w-3 h-3"}),n]})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>$(!A),disabled:r||e.length===0,className:"bg-yellow-50 hover:bg-yellow-100 text-yellow-700 border border-yellow-200 text-xs font-bold px-4 py-2 rounded-lg flex items-center gap-2 transition disabled:opacity-50",children:[r?o.jsx(Ue,{className:"w-4 h-4 animate-spin"}):o.jsx(Rt,{className:"w-4 h-4"}),o.jsx("span",{children:"Export CSV"})]}),A&&!r&&e.length>0&&o.jsx("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 z-50",children:o.jsxs("div",{className:"p-4",children:[o.jsx("h4",{className:"text-sm font-bold text-gray-800 mb-3",children:"Export Options"}),o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Sensors"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>te("all"),className:`flex-1 px-3 py-1.5 text-xs rounded transition-all ${D==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Sensors"}),!y&&o.jsxs("button",{onClick:()=>te("selected"),className:`flex-1 px-3 py-1.5 text-xs rounded transition-all ${D==="selected"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Selected (",Object.values(f).filter(v=>v).length,")"]})]})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Time Range"}),o.jsxs("select",{value:I,onChange:v=>ee(v.target.value),className:"w-full px-3 py-1.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"1m",children:"Last 1 Minute"}),o.jsx("option",{value:"5m",children:"Last 5 Minutes"}),o.jsx("option",{value:"15m",children:"Last 15 Minutes"}),o.jsx("option",{value:"1h",children:"Last 1 Hour"}),o.jsx("option",{value:"6h",children:"Last 6 Hours"}),o.jsx("option",{value:"24h",children:"Last 24 Hours"})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Data Interval"}),o.jsxs("select",{value:P,onChange:v=>V(v.target.value),className:"w-full px-3 py-1.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"auto",children:"Auto"}),o.jsx("option",{value:"1s",children:"1 Second"}),o.jsx("option",{value:"5s",children:"5 Seconds"}),o.jsx("option",{value:"1m",children:"1 Minute"}),o.jsx("option",{value:"5m",children:"5 Minutes"}),o.jsx("option",{value:"1h",children:"1 Hour"})]})]}),o.jsxs("div",{className:"flex gap-2 pt-2 border-t border-gray-200",children:[o.jsx("button",{onClick:()=>$(!1),className:"flex-1 px-3 py-2 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-all",children:"Cancel"}),o.jsxs("button",{onClick:D==="all"?w:S,className:"flex-1 px-3 py-2 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 transition-all font-medium flex items-center justify-center gap-1",children:[o.jsx(Rt,{className:"w-3 h-3"}),"Export"]})]}),o.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:o.jsx("button",{onClick:()=>z(D),className:"w-full px-3 py-1.5 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-50 rounded transition-all text-center",children:"Quick Export (Current View)"})})]})})]})]}),A&&o.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>$(!1)}),i&&o.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-3 mb-4 flex items-center gap-2 text-sm",children:[o.jsx(fn,{className:"w-4 h-4 flex-shrink-0"}),o.jsx("span",{children:i})]}),h&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4 shadow-2xl",children:[o.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Custom Time Range"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Range"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"number",value:g,onChange:v=>C(v.target.value),placeholder:"Enter value",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"any"}),o.jsxs("select",{value:M,onChange:v=>E(v.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"seconds",children:"Seconds"}),o.jsx("option",{value:"minutes",children:"Minutes"}),o.jsx("option",{value:"hours",children:"Hours"}),o.jsx("option",{value:"days",children:"Days"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Interval (Optional)"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"number",value:O,onChange:v=>L(v.target.value),placeholder:"Leave empty for auto",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"any"}),o.jsxs("select",{value:q,onChange:v=>x(v.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"seconds",children:"Seconds"}),o.jsx("option",{value:"minutes",children:"Minutes"}),o.jsx("option",{value:"hours",children:"Hours"})]})]})]})]}),o.jsxs("div",{className:"flex gap-3 mt-6",children:[o.jsx("button",{onClick:()=>b(!1),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all font-medium",children:"Cancel"}),o.jsx("button",{onClick:_,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all font-medium shadow-md",children:"Apply"})]})]})}),o.jsx("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100",children:o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(Mt,{className:"w-4 h-4 text-blue-600"}),o.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Time Range"})]}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[["1m","5m","15m","1h","6h","24h"].map(v=>o.jsx("button",{onClick:()=>u&&u(v),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all ${a===v?"bg-blue-500 text-white shadow-md scale-105":"bg-white text-gray-600 hover:bg-blue-100 border border-gray-200"}`,children:se[v]},v)),o.jsx("button",{onClick:()=>b(!0),className:"px-4 py-2 rounded-lg text-xs font-bold transition-all bg-gradient-to-r from-purple-50 to-pink-50 text-purple-700 hover:from-purple-100 hover:to-pink-100 border border-purple-200",children:"âš™ï¸ Custom"})]}),o.jsxs("div",{className:"flex items-center gap-2 mt-2 mb-2",children:[o.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Data Interval"}),o.jsx("span",{className:"text-xs text-gray-500",children:"(sampling rate)"})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:["auto","1s","5s","1m","5m","1h"].map(v=>{const k=oe.includes(v),H=l===v;return o.jsx("button",{onClick:()=>k&&d&&d(v),disabled:!k,className:`px-3 py-1.5 rounded-lg text-xs font-bold transition-all ${H?"bg-indigo-500 text-white shadow-md":k?"bg-white text-gray-600 hover:bg-indigo-100 border border-gray-200":"bg-gray-50 text-gray-300 border border-gray-100 pointer-events-none cursor-not-allowed"}`,children:G[v]},v)})})]})}),o.jsxs("div",{className:"flex flex-wrap gap-2 mb-6 justify-center md:justify-start p-3 bg-gray-50 rounded-xl border border-gray-100",children:[o.jsxs("button",{onClick:()=>W("moisture"),className:T(f.moisture,"bg-cyan-500"),children:[f.moisture?o.jsx(Te,{className:"w-3 h-3"}):o.jsx(Se,{className:"w-3 h-3"})," Moisture"]}),o.jsxs("button",{onClick:()=>W("temperature"),className:T(f.temperature,"bg-green-500"),children:[f.temperature?o.jsx(Te,{className:"w-3 h-3"}):o.jsx(Se,{className:"w-3 h-3"})," Temp"]}),o.jsxs("button",{onClick:()=>W("humidity"),className:T(f.humidity,"bg-blue-500"),children:[f.humidity?o.jsx(Te,{className:"w-3 h-3"}):o.jsx(Se,{className:"w-3 h-3"})," Humidity"]}),o.jsxs("button",{onClick:()=>W("light"),className:T(f.light,"bg-yellow-500"),children:[f.light?o.jsx(Te,{className:"w-3 h-3"}):o.jsx(Se,{className:"w-3 h-3"})," Light"]}),o.jsxs("button",{onClick:()=>W("battery"),className:T(f.battery,"bg-purple-500"),children:[f.battery?o.jsx(Te,{className:"w-3 h-3"}):o.jsx(Se,{className:"w-3 h-3"})," Battery"]})]}),o.jsx("div",{className:"h-80 w-full flex-grow relative",children:t?o.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-400 bg-white/50 z-10",children:[o.jsx(Ue,{className:"animate-spin w-10 h-10 mb-3 text-blue-500"}),o.jsx("span",{className:"text-sm font-medium",children:"Loading Data..."})]}):U.length===0?o.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200",children:o.jsx("span",{className:"text-sm",children:"No data available for this period"})}):o.jsx(xs,{width:"100%",height:"100%",children:o.jsxs(ys,{data:U,margin:{top:10,right:10,left:-20,bottom:0},children:[o.jsx(ws,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),o.jsx(vs,{dataKey:"time",tick:{fontSize:11,fill:"#9ca3af"},tickLine:!1,axisLine:{stroke:"#e5e7eb"},minTickGap:30}),o.jsx(ct,{yAxisId:"left",tick:{fontSize:11,fill:"#9ca3af"},tickLine:!1,axisLine:!1,domain:[0,"auto"]}),o.jsx(ct,{yAxisId:"right",orientation:"right",tick:{fontSize:11,fill:"#eab308"},tickLine:!1,axisLine:!1,hide:!f.light}),o.jsx(Ss,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)"},itemStyle:{fontSize:"12px",fontWeight:600}}),f.moisture&&o.jsx(xe,{yAxisId:"left",type:"monotone",dataKey:"moisture",name:"Moisture (%)",stroke:"#06b6d4",strokeWidth:3,dot:!1,activeDot:{r:6}}),f.temperature&&o.jsx(xe,{yAxisId:"left",type:"monotone",dataKey:"temperature",name:"Temp (Â°C)",stroke:"#22c55e",strokeWidth:3,dot:!1,activeDot:{r:6}}),f.humidity&&o.jsx(xe,{yAxisId:"left",type:"monotone",dataKey:"humidity",name:"Humidity (%)",stroke:"#3b82f6",strokeWidth:3,dot:!1,activeDot:{r:6}}),f.battery&&o.jsx(xe,{yAxisId:"left",type:"step",dataKey:"battery",name:"Battery (%)",stroke:"#a855f7",strokeWidth:3,dot:!1}),f.light&&o.jsx(xe,{yAxisId:"right",type:"monotone",dataKey:"light",name:"Light (lux)",stroke:"#eab308",strokeWidth:3,dot:!1,activeDot:{r:6}})]})})})]})},Ot=()=>{const{deviceId:e}=hs(),s=e||"device0011233",{jwtToken:r}=st(),[n,i]=N.useState({moisture:0,temperature:0,humidity:0,light:0,battery:0,pumpStatus:"OFF",pumpMode:"manual"}),[a,l]=N.useState(!1),[u]=N.useState(["device9988","device0011233","device0000","device0001","device0002"]),[d,m]=N.useState([]),[p,f]=N.useState([]),[R,h]=N.useState(!1),[b,g]=N.useState(!1),[C,M]=N.useState(null),[E,O]=N.useState(()=>localStorage.getItem(`timeRange_${s}`)||"1h"),[L,q]=N.useState(()=>localStorage.getItem(`dataInterval_${s}`)||"auto"),[x,A]=N.useState(()=>{const y=localStorage.getItem(`settings_${s}`);return y?JSON.parse(y):{moistureMin:"20",moistureMax:"70",tempMin:"10",tempMax:"35",humidityMin:"30",humidityMax:"80",lightMin:"200",lightMax:"1000",batteryMin:"20",autoMode:!1}}),[$,I]=N.useState(null),[ee,P]=N.useState(null),[V,D]=N.useState(null);N.useEffect(()=>{const y=async()=>{if(!r){console.warn("âš ï¸ Cannot fetch historical data: missing deviceId or token");return}h(!0),M(null);try{console.log(`ðŸ“Š [HTTP API] Fetching historical data for device: ${s}`);const w=await ln(s);m(w),console.log(`âœ… [HTTP API] Historical data loaded: ${w.length} records`)}catch(w){console.error("âŒ [HTTP API] Failed to fetch historical data:",w),w.response?.data?.data==="Device does not belong to the user"?M(`âš ï¸ Device "${s}" not found in your account. Please update the device ID in Dashboard.jsx or add this device to your ProtoNest account. Real-time data will still work.`):M("Failed to load historical data. Real-time WebSocket data will still work."),m([])}finally{h(!1)}};y();const S=setInterval(()=>{r&&y()},3e4);return()=>clearInterval(S)},[s,r,E]),N.useEffect(()=>{console.log(`[Dashboard] ðŸ”„ Device changed to: ${s} - Resetting all data`),i({moisture:0,temperature:0,humidity:0,light:0,battery:0,pumpStatus:"OFF",pumpMode:"manual"}),m([]),f([]),M(null),I(null),P(null),D(null);const y=localStorage.getItem(`settings_${s}`);y?(A(JSON.parse(y)),console.log("ðŸ“¥ Settings loaded from localStorage for device:",s)):A({moistureMin:"20",moistureMax:"70",tempMin:"10",tempMax:"35",humidityMin:"30",humidityMax:"80",lightMin:"200",lightMax:"1000",batteryMin:"20",autoMode:!1});const S=localStorage.getItem(`timeRange_${s}`),w=localStorage.getItem(`dataInterval_${s}`);O(S||"1h"),q(w||"auto"),console.log(`[Dashboard] âœ… Reset complete for device: ${s}`)},[s]),N.useEffect(()=>{if(!r||!s){console.warn("[Dashboard] Missing deviceId or JWT token for WebSocket");return}const y=w=>{console.log(`[Dashboard] ðŸ“¡ Real-time ${w.sensorType}:`,w.value),i(z=>{const T={...z};if(w.sensorType==="batchUpdate")console.log("[Dashboard] ðŸ”„ Processing BATCH state update:",w.value),w.value.temp!==void 0&&(T.temperature=parseFloat(w.value.temp),console.log(`[Dashboard] âœ… Updated temperature: ${T.temperature}`)),w.value.humidity!==void 0&&(T.humidity=parseFloat(w.value.humidity),console.log(`[Dashboard] âœ… Updated humidity: ${T.humidity}`)),w.value.battery!==void 0&&(T.battery=parseFloat(w.value.battery),console.log(`[Dashboard] âœ… Updated battery: ${T.battery}`)),w.value.light!==void 0&&(T.light=parseFloat(w.value.light),console.log(`[Dashboard] âœ… Updated light: ${T.light}`)),w.value.moisture!==void 0&&(T.moisture=parseFloat(w.value.moisture),console.log(`[Dashboard] âœ… Updated moisture: ${T.moisture}`)),console.log("[Dashboard] ðŸ“Š Batch update complete. New state:",T);else switch(w.sensorType){case"temp":T.temperature=parseFloat(w.value),console.log(`[Dashboard] âœ… Updated temperature: ${T.temperature}`);break;case"humidity":T.humidity=parseFloat(w.value),console.log(`[Dashboard] âœ… Updated humidity: ${T.humidity}`);break;case"battery":T.battery=parseFloat(w.value),console.log(`[Dashboard] âœ… Updated battery: ${T.battery}`);break;case"light":T.light=parseFloat(w.value),console.log(`[Dashboard] âœ… Updated light: ${T.light}`);break;case"moisture":T.moisture=parseFloat(w.value),console.log(`[Dashboard] âœ… Updated moisture: ${T.moisture}`);break;case"pumpStatus":T.pumpStatus=w.value,console.log(`[Dashboard] ðŸš¨ Pump status updated to: ${w.value}`);break;case"pumpMode":T.pumpMode=w.value,console.log(`[Dashboard] âš™ï¸ Pump mode updated to: ${w.value}`);break;default:console.warn(`[Dashboard] âš ï¸ Unknown sensor type: ${w.sensorType}`)}return console.log("[Dashboard] ðŸ“Š New liveData state:",T),T})};return ve.onConnect(()=>{l(!0),console.log("[Dashboard] âœ… WebSocket Connected")}),ve.onDisconnect(()=>{l(!1),console.log("[Dashboard] âŒ WebSocket Disconnected")}),(async()=>{try{console.log("[Dashboard] ðŸ”„ Initializing WebSocket connection"),await ve.connect(r),ve.subscribeToDevice(s,y)&&console.log(`[Dashboard] âœ… Subscribed to ${s} topics`)}catch(w){console.error("[Dashboard] âŒ WebSocket connection failed:",w),l(!1)}})(),()=>{console.log("[Dashboard] ðŸ§¹ Cleaning up WebSocket connection"),ve.disconnect()}},[s,r]),N.useEffect(()=>{const y=n||{},S=[],w=parseFloat(x.moistureMin),z=parseFloat(x.moistureMax);y.moisture!==void 0&&(y.moisture<w?S.push(`CRITICAL: Soil Moisture (${y.moisture.toFixed(1)}%) is below minimum (${w}%)`):y.moisture>z&&S.push(`WARNING: Soil Moisture (${y.moisture.toFixed(1)}%) exceeds maximum (${z}%)`));const T=parseFloat(x.tempMin),v=parseFloat(x.tempMax);y.temperature!==void 0&&(y.temperature<T?S.push(`CRITICAL: Temperature (${y.temperature.toFixed(1)}Â°C) is below minimum (${T}Â°C)`):y.temperature>v&&S.push(`WARNING: Temperature (${y.temperature.toFixed(1)}Â°C) exceeds maximum (${v}Â°C)`));const k=parseFloat(x.humidityMin),H=parseFloat(x.humidityMax);y.humidity!==void 0&&(y.humidity<k?S.push(`CRITICAL: Humidity (${y.humidity.toFixed(1)}%) is below minimum (${k}%)`):y.humidity>H&&S.push(`WARNING: Humidity (${y.humidity.toFixed(1)}%) exceeds maximum (${H}%)`));const B=parseFloat(x.lightMin),Y=parseFloat(x.lightMax);y.light!==void 0&&(y.light<B?S.push(`CRITICAL: Light (${y.light.toFixed(0)} lux) is below minimum (${B} lux)`):y.light>Y&&S.push(`WARNING: Light (${y.light.toFixed(0)} lux) exceeds maximum (${Y} lux)`));const X=parseFloat(x.batteryMin);y.battery!==void 0&&y.battery<X&&S.push(`CRITICAL: Battery (${y.battery.toFixed(1)}%) is below minimum (${X}%)`),I(S.length>0?S[0]:null)},[n,x]),N.useEffect(()=>{if(!x.autoMode)return;const y=n?.moisture;if(y===void 0)return;const S=parseFloat(x.moistureMin),w=parseFloat(x.moistureMax),z=n?.pumpStatus||"OFF";console.log("[Automation] ðŸ¤– Checking conditions:",{moisture:y,min:S,max:w,pumpStatus:z}),y<S&&z==="OFF"&&(console.log(`[Automation] ðŸ’§ CRITICAL: Moisture ${y}% < ${S}% - Sending HTTP request to turn pump ON`),Qe(s,"ON","pump").then(()=>{console.log("[Automation] âœ… HTTP API request successful - Backend will send MQTT command"),I(`AUTO: Pump activation requested - Moisture CRITICAL (${y.toFixed(1)}%)`)}).catch(T=>{console.error("[Automation] âŒ HTTP API request failed:",T),I(`ERROR: Failed to activate pump - ${T.message}`)})),y>=S&&z==="ON"&&(console.log(`[Automation] âœ… NORMAL: Moisture ${y}% >= ${S}% - Sending HTTP request to turn pump OFF`),Qe(s,"OFF","pump").then(()=>{console.log("[Automation] âœ… HTTP API request successful - Backend will send MQTT command"),I(`AUTO: Pump deactivation requested - Moisture restored (${y.toFixed(1)}%)`)}).catch(T=>{console.error("[Automation] âŒ HTTP API request failed:",T),I(`ERROR: Failed to deactivate pump - ${T.message}`)}))},[n?.moisture,n?.pumpStatus,x.moistureMin,x.moistureMax,x.autoMode,s]);const te=async(y=null)=>{g(!0);try{const S=p.length>0?p:d;if(S.length===0){alert("No data available to export. Please wait for data to accumulate.");return}const w=["moisture","temperature","humidity","light","battery"],z=y&&y.length>0?y.filter(ae=>w.includes(ae)):w,T=["time",...z].join(","),v=S.map(ae=>{const ie=[ae.time];return z.forEach(Je=>{ie.push(ae[Je]??"")}),ie.join(",")}).join(`
`),k=`${T}
${v}`,H=new Blob([k],{type:"text/csv;charset=utf-8;"}),B=URL.createObjectURL(H),Y=document.createElement("a");Y.href=B;const X=y?"selected":"all",le=E.replace("custom_","custom-"),ce=L==="auto"?"auto":L.replace("custom_interval_","interval-");Y.download=`agricop_${s}_${X}_${le}_${ce}_report.csv`,document.body.appendChild(Y),Y.click(),document.body.removeChild(Y)}catch(S){console.error("Export failed",S)}finally{g(!1)}},_=()=>{D("settings"),P(null);try{localStorage.setItem(`settings_${s}`,JSON.stringify(x)),console.log("ðŸ’¾ Settings saved to localStorage:",x),P({type:"success",message:"Settings saved locally!"})}catch(y){console.error("Failed to save settings:",y),P({type:"error",message:"Failed to save settings."})}finally{D(null),setTimeout(()=>P(null),3e3)}},se=y=>{console.log(`ðŸ“Š Changing time range to: ${y}`),O(y),localStorage.setItem(`timeRange_${s}`,y);let S="auto";y==="1m"||y==="5m"?S="1s":y==="15m"?S="5s":y==="1h"?S="auto":y==="6h"?S="1m":y==="24h"&&(S="5m"),q(S),localStorage.setItem(`dataInterval_${s}`,S)},G=y=>{console.log(`ðŸ“Š Changing data interval to: ${y}`),q(y),localStorage.setItem(`dataInterval_${s}`,y)},be=async()=>{D("pump");const S=n?.pumpStatus==="ON"?"OFF":"ON";console.log(`ðŸ”„ [HTTP API] Toggling pump from ${n?.pumpStatus} to ${S}`);try{await Qe(s,S,"pump","manual"),console.log(`âœ… [HTTP API] Pump command sent: ${S}`),console.log("ðŸ“¡ Waiting for backend to publish to MQTT and device confirmation..."),P({type:"success",message:`Pump command sent: ${S}`})}catch(w){console.error("âŒ [HTTP API] Pump control failed:",w),P({type:"error",message:"Failed to send pump command. Check API connection."})}finally{D(null),setTimeout(()=>P(null),3e3)}},oe=(y,S,w=1)=>n?.[y]?`${Number(n[y]).toFixed(w)}${S}`:"--",U=n?.pumpStatus||"OFF",W=(y,S,w)=>{const z=n?.[y];if(z!==void 0&&(z<S||z>w))return"border-red-500 bg-red-50";switch(y){case"moisture":return"border-cyan-500";case"temperature":return"border-green-500";case"humidity":return"border-blue-400";case"light":return"border-yellow-500";case"battery":return"border-purple-500";default:return"border-green-500"}};return o.jsxs("div",{className:"min-h-screen bg-[#f0f4f8] p-4 font-sans text-gray-800",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-4",children:[o.jsxs("div",{className:`text-center py-2 rounded-lg text-sm font-medium ${a?"bg-green-100 text-green-800 border border-green-300":"bg-gray-100 text-gray-600 border border-gray-300"}`,children:["WebSocket (Real-Time): ",a?"ðŸŸ¢ Connected":"âšª Disconnected"]}),o.jsxs("div",{className:`text-center py-2 rounded-lg text-sm font-medium ${a?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-100 text-gray-600 border border-gray-300"}`,children:["MQTT Stream: ",a?"ðŸŸ¢ Receiving Data":"âšª Waiting for Data"]})]}),o.jsxs("div",{className:`text-center py-2 mb-4 rounded-lg text-sm font-medium ${a?"bg-green-100 text-green-800 border border-green-300":"bg-yellow-100 text-yellow-800 border border-yellow-300"}`,children:["System Status: ",a?`ðŸŸ¢ Online â€¢ Real-Time: ${a?"Active":"Standby"} â€¢ Historical: HTTP API`:"ðŸŸ¡ Limited - Real-time data only"]}),$&&o.jsxs("div",{className:"bg-red-500 text-white rounded-lg p-3 mb-6 shadow-xl flex items-center justify-center font-bold text-lg animate-pulse transition-all",children:[o.jsx(as,{className:"w-6 h-6 mr-3"}),$]}),o.jsx(jn,{deviceId:s,deviceList:u}),o.jsx("div",{className:`rounded-xl py-4 text-center mb-8 border transition-colors duration-500 shadow-sm ${U==="ON"?"bg-green-100 border-green-300 text-green-900":"bg-blue-100 border-blue-300 text-blue-900"}`,children:o.jsxs("h2",{className:"text-xl font-bold",children:["Pump : ",U," (",n?.pumpMode||"Optimal",")"]})}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[o.jsx(Ce,{value:oe("moisture","%"),label:"Soil Moisture",borderColor:W("moisture",parseFloat(x.moistureMin),parseFloat(x.moistureMax))}),o.jsx(Ce,{value:oe("temperature","Â°C"),label:"Temperature",borderColor:W("temperature",parseFloat(x.tempMin),parseFloat(x.tempMax))}),o.jsx(Ce,{value:oe("humidity","%"),label:"Humidity",borderColor:W("humidity",parseFloat(x.humidityMin),parseFloat(x.humidityMax))}),o.jsx(Ce,{value:oe("light"," lux",0),label:"Light",borderColor:W("light",parseFloat(x.lightMin),parseFloat(x.lightMax))}),o.jsx(Ce,{value:oe("battery","%"),label:"Battery",borderColor:W("battery",parseFloat(x.batteryMin),100)})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[o.jsx(Rn,{chartData:d,isLoading:R,onExportCSV:te,isExporting:b,dataSource:"HTTP API",error:C,timeRange:E,dataInterval:L,onTimeRangeChange:se,onDataIntervalChange:G,allData:d,onFilteredDataChange:f}),o.jsx(Mn,{settings:x,setSettings:A,handleSaveSettings:_,commandInProgress:V,commandStatus:ee,liveData:n,togglePump:be,pumpStatus:U})]})]})};function An(){return o.jsx(Es,{children:o.jsx("div",{className:"App",children:o.jsxs(fs,{children:[o.jsx(Oe,{path:"/",element:o.jsx(lt,{to:"/dashboard",replace:!0})}),o.jsx(Oe,{path:"/dashboard",element:o.jsx(Ot,{})}),o.jsx(Oe,{path:"/dashboard/:deviceId",element:o.jsx(Ot,{})}),o.jsx(Oe,{path:"*",element:o.jsx(lt,{to:"/dashboard",replace:!0})})]})})})}const On=()=>"https://api.protonestconnect.co/api/v1/user",$t=On(),$n=async(e,t)=>{try{const s=e.trim(),r=t.trim();if(!s.includes("@"))throw new Error("Invalid email format");console.log("ðŸ”„ Making secure authentication request to:",$t),console.log("ðŸ“‹ IMPORTANT: Using secretKey as password (not login password)");const n={email:s,password:r};console.log("ðŸ”„ Attempting /get-token with documented payload structure:",{email:s,passwordType:"secretKey",passwordLength:r.length});try{const i=await F.post(`${$t}/get-token`,n,{headers:{"Content-Type":"application/json",Accept:"application/json","Cache-Control":"no-cache"},timeout:1e4});if(console.log("ðŸ“¡ API Response from /get-token (Success):",i.data),i.data.status==="Success"){const a=i.data.data?.jwtToken,l=i.data.data?.refreshToken;if(!a)throw new Error("No JWT token in response data");return console.log("âœ… Login successful via /get-token. JWT token received securely."),{jwtToken:a,refreshToken:l,userId:s}}else throw new Error(`Authentication failed: ${i.data.message||"Unexpected response status"}`)}catch(i){if(i.response?.status===400){const a=i.response.data;throw console.error("âŒ Authentication failed (400):",{serverResponse:JSON.stringify(a,null,2),possibleCauses:["Invalid email format - check email address","Invalid credentials - verify email is registered","Wrong secretKey - check Protonest dashboard for correct secretKey","User not found - email not registered in system","Email not verified - check email verification status"]}),a?.data==="Invalid email format"?new Error("Invalid email format. Please check the email address."):a?.data==="Invalid credentials"?new Error("Invalid credentials. Please verify the email and secretKey from Protonest dashboard."):a?.data==="User not found"?new Error("User not found. Please check if the email is registered in the system."):a?.data==="Email not verified"?new Error("Email not verified. Please verify your email address first."):new Error(`Authentication failed: ${a?.data||"Please verify email and secretKey"}`)}else throw i.response?.status===500?(console.error("âŒ Server error (500):",i.response.data),new Error("Internal server error. Please try again later.")):(console.error(`âŒ Unexpected error (${i.response?.status}):`,i.response?.data),i)}}catch(s){throw console.error("âŒ Login process failed:",{message:s.message,email:e?.trim(),hasPassword:!0,passwordLength:t?.length||0}),s}},Fe="ratnaabinayansn@gmail.com",Dt="6M3@pwYvBGRVJLN",Dn=({children:e})=>{const{setAuth:t}=st(),[s,r]=pe.useState(!1),[n,i]=pe.useState(!0);return pe.useEffect(()=>{if(s)return;r(!0),(async()=>{try{console.log("ðŸ”‘ Attempting auto login with real credentials..."),console.log("ðŸ“§ Email:",Fe),console.log("ðŸ” SecretKey length:",Dt.length);const l=await $n(Fe,Dt);console.log("âœ… Auto login successful. Ready for connection."),t({userId:l.userId||Fe,jwtToken:l.jwtToken}),l.refreshToken&&localStorage.setItem("refreshToken",l.refreshToken)}catch(l){console.warn("âš ï¸ Auto login failed. Using mock data for development."),console.error("Auto login error details:",l.message),l.message.includes("Invalid credentials")&&console.error("ðŸ”§ Credentials may be incorrect or expired. Please verify from Protonest dashboard"),t({userId:Fe,jwtToken:"MOCK_TOKEN_FOR_TESTING"})}finally{i(!1)}})()},[t,s]),n?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Authenticating with Protonest API..."}),o.jsx("p",{className:"text-blue-600 text-sm mt-2",children:"âœ… Using real credentials"})]})}):e};ks.createRoot(document.getElementById("root")).render(o.jsx(Ms,{children:o.jsx(Dn,{children:o.jsx(gs,{basename:"/Plant-Monitoring-System_PC",future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:o.jsx(An,{})})})}));
