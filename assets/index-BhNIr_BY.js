import{a as ds,b as ms,g as hs,R as he,r as N,u as ps,d as fs,e as gs,f as Oe,N as lt,B as bs}from"./vendor-BfRyhV_A.js";import{C as xs}from"./websocket-ImiZJucQ.js";import{R as ys,L as ws,C as vs,X as Ss,Y as ct,T as Ts,a as xe}from"./charts-6mwycKEn.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();var Ve={exports:{}},ye={};var ut;function js(){if(ut)return ye;ut=1;var e=ds(),t=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,r=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function a(l,c,d){var m,h={},f=null,A=null;d!==void 0&&(f=""+d),c.key!==void 0&&(f=""+c.key),c.ref!==void 0&&(A=c.ref);for(m in c)o.call(c,m)&&!i.hasOwnProperty(m)&&(h[m]=c[m]);if(l&&l.defaultProps)for(m in c=l.defaultProps,c)h[m]===void 0&&(h[m]=c[m]);return{$$typeof:t,type:l,key:f,ref:A,props:h,_owner:r.current}}return ye.Fragment=s,ye.jsx=a,ye.jsxs=a,ye}var dt;function Ns(){return dt||(dt=1,Ve.exports=js()),Ve.exports}var n=Ns(),De={},mt;function Cs(){if(mt)return De;mt=1;var e=ms();return De.createRoot=e.createRoot,De.hydrateRoot=e.hydrateRoot,De}var ks=Cs();const Es=hs(ks);class Ms extends he.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,s){console.error("Error caught by boundary:",t,s)}render(){return this.state.hasError?n.jsx("div",{className:"min-h-screen bg-red-50 flex items-center justify-center p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md",children:[n.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"âš ï¸ Application Error"}),n.jsx("p",{className:"text-gray-700 mb-4",children:"The dashboard encountered an error and had to reload."}),n.jsx("p",{className:"text-sm text-gray-500 mb-6 font-mono break-words",children:this.state.error?.toString()}),n.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Reload Page"})]})}):this.props.children}}const Ft=N.createContext({userId:"",jwtToken:"",setAuth:()=>{},logout:()=>{}}),st=()=>N.useContext(Ft),As=({children:e})=>{const[t,s]=N.useState(localStorage.getItem("userId")||""),[o,r]=N.useState(localStorage.getItem("jwtToken")||""),l={userId:t,jwtToken:o,setAuth:({userId:c,jwtToken:d})=>{s(c),r(d),localStorage.setItem("jwtToken",d),localStorage.setItem("userId",c),console.log("âœ… Auth state updated:",{userId:c,hasToken:!!d})},logout:()=>{s(""),r(""),localStorage.clear(),window.location.href="/"}};return n.jsx(Ft.Provider,{value:l,children:e})};function It(e,t){return function(){return e.apply(t,arguments)}}const{toString:Rs}=Object.prototype,{getPrototypeOf:ot}=Object,{iterator:He,toStringTag:Lt}=Symbol,Be=(e=>t=>{const s=Rs.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),oe=e=>(e=e.toLowerCase(),t=>Be(t)===e),We=e=>t=>typeof t===e,{isArray:fe}=Array,pe=We("undefined");function Ee(e){return e!==null&&!pe(e)&&e.constructor!==null&&!pe(e.constructor)&&Q(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const _t=oe("ArrayBuffer");function Os(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&_t(e.buffer),t}const Ds=We("string"),Q=We("function"),Ut=We("number"),Me=e=>e!==null&&typeof e=="object",$s=e=>e===!0||e===!1,Fe=e=>{if(Be(e)!=="object")return!1;const t=ot(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Lt in e)&&!(He in e)},Ps=e=>{if(!Me(e)||Ee(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Fs=oe("Date"),Is=oe("File"),Ls=oe("Blob"),_s=oe("FileList"),Us=e=>Me(e)&&Q(e.pipe),Hs=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Q(e.append)&&((t=Be(e))==="formdata"||t==="object"&&Q(e.toString)&&e.toString()==="[object FormData]"))},Bs=oe("URLSearchParams"),[Ws,qs,zs,Js]=["ReadableStream","Request","Response","Headers"].map(oe),Vs=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ae(e,t,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let o,r;if(typeof e!="object"&&(e=[e]),fe(e))for(o=0,r=e.length;o<r;o++)t.call(null,e[o],o,e);else{if(Ee(e))return;const i=s?Object.getOwnPropertyNames(e):Object.keys(e),a=i.length;let l;for(o=0;o<a;o++)l=i[o],t.call(null,e[l],l,e)}}function Ht(e,t){if(Ee(e))return null;t=t.toLowerCase();const s=Object.keys(e);let o=s.length,r;for(;o-- >0;)if(r=s[o],t===r.toLowerCase())return r;return null}const ue=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Bt=e=>!pe(e)&&e!==ue;function Ze(){const{caseless:e,skipUndefined:t}=Bt(this)&&this||{},s={},o=(r,i)=>{const a=e&&Ht(s,i)||i;Fe(s[a])&&Fe(r)?s[a]=Ze(s[a],r):Fe(r)?s[a]=Ze({},r):fe(r)?s[a]=r.slice():(!t||!pe(r))&&(s[a]=r)};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Ae(arguments[r],o);return s}const Ks=(e,t,s,{allOwnKeys:o}={})=>(Ae(t,(r,i)=>{s&&Q(r)?e[i]=It(r,s):e[i]=r},{allOwnKeys:o}),e),Xs=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Gs=(e,t,s,o)=>{e.prototype=Object.create(t.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},Qs=(e,t,s,o)=>{let r,i,a;const l={};if(t=t||{},e==null)return t;do{for(r=Object.getOwnPropertyNames(e),i=r.length;i-- >0;)a=r[i],(!o||o(a,e,t))&&!l[a]&&(t[a]=e[a],l[a]=!0);e=s!==!1&&ot(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},Zs=(e,t,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=t.length;const o=e.indexOf(t,s);return o!==-1&&o===s},Ys=e=>{if(!e)return null;if(fe(e))return e;let t=e.length;if(!Ut(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=e[t];return s},eo=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&ot(Uint8Array)),to=(e,t)=>{const o=(e&&e[He]).call(e);let r;for(;(r=o.next())&&!r.done;){const i=r.value;t.call(e,i[0],i[1])}},so=(e,t)=>{let s;const o=[];for(;(s=e.exec(t))!==null;)o.push(s);return o},oo=oe("HTMLFormElement"),ro=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,o,r){return o.toUpperCase()+r}),ht=(({hasOwnProperty:e})=>(t,s)=>e.call(t,s))(Object.prototype),no=oe("RegExp"),Wt=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),o={};Ae(s,(r,i)=>{let a;(a=t(r,i,e))!==!1&&(o[i]=a||r)}),Object.defineProperties(e,o)},ao=e=>{Wt(e,(t,s)=>{if(Q(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const o=e[s];if(Q(o)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},io=(e,t)=>{const s={},o=r=>{r.forEach(i=>{s[i]=!0})};return fe(e)?o(e):o(String(e).split(t)),s},lo=()=>{},co=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function uo(e){return!!(e&&Q(e.append)&&e[Lt]==="FormData"&&e[He])}const mo=e=>{const t=new Array(10),s=(o,r)=>{if(Me(o)){if(t.indexOf(o)>=0)return;if(Ee(o))return o;if(!("toJSON"in o)){t[r]=o;const i=fe(o)?[]:{};return Ae(o,(a,l)=>{const c=s(a,r+1);!pe(c)&&(i[l]=c)}),t[r]=void 0,i}}return o};return s(e,0)},ho=oe("AsyncFunction"),po=e=>e&&(Me(e)||Q(e))&&Q(e.then)&&Q(e.catch),qt=((e,t)=>e?setImmediate:t?((s,o)=>(ue.addEventListener("message",({source:r,data:i})=>{r===ue&&i===s&&o.length&&o.shift()()},!1),r=>{o.push(r),ue.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",Q(ue.postMessage)),fo=typeof queueMicrotask<"u"?queueMicrotask.bind(ue):typeof process<"u"&&process.nextTick||qt,go=e=>e!=null&&Q(e[He]),u={isArray:fe,isArrayBuffer:_t,isBuffer:Ee,isFormData:Hs,isArrayBufferView:Os,isString:Ds,isNumber:Ut,isBoolean:$s,isObject:Me,isPlainObject:Fe,isEmptyObject:Ps,isReadableStream:Ws,isRequest:qs,isResponse:zs,isHeaders:Js,isUndefined:pe,isDate:Fs,isFile:Is,isBlob:Ls,isRegExp:no,isFunction:Q,isStream:Us,isURLSearchParams:Bs,isTypedArray:eo,isFileList:_s,forEach:Ae,merge:Ze,extend:Ks,trim:Vs,stripBOM:Xs,inherits:Gs,toFlatObject:Qs,kindOf:Be,kindOfTest:oe,endsWith:Zs,toArray:Ys,forEachEntry:to,matchAll:so,isHTMLForm:oo,hasOwnProperty:ht,hasOwnProp:ht,reduceDescriptors:Wt,freezeMethods:ao,toObjectSet:io,toCamelCase:ro,noop:lo,toFiniteNumber:co,findKey:Ht,global:ue,isContextDefined:Bt,isSpecCompliantForm:uo,toJSONObject:mo,isAsyncFn:ho,isThenable:po,setImmediate:qt,asap:fo,isIterable:go};function j(e,t,s,o,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),o&&(this.request=o),r&&(this.response=r,this.status=r.status?r.status:null)}u.inherits(j,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:u.toJSONObject(this.config),code:this.code,status:this.status}}});const zt=j.prototype,Jt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Jt[e]={value:e}});Object.defineProperties(j,Jt);Object.defineProperty(zt,"isAxiosError",{value:!0});j.from=(e,t,s,o,r,i)=>{const a=Object.create(zt);u.toFlatObject(e,a,function(m){return m!==Error.prototype},d=>d!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return j.call(a,l,c,s,o,r),e&&a.cause==null&&Object.defineProperty(a,"cause",{value:e,configurable:!0}),a.name=e&&e.name||"Error",i&&Object.assign(a,i),a};const bo=null;function Ye(e){return u.isPlainObject(e)||u.isArray(e)}function Vt(e){return u.endsWith(e,"[]")?e.slice(0,-2):e}function pt(e,t,s){return e?e.concat(t).map(function(r,i){return r=Vt(r),!s&&i?"["+r+"]":r}).join(s?".":""):t}function xo(e){return u.isArray(e)&&!e.some(Ye)}const yo=u.toFlatObject(u,{},null,function(t){return/^is[A-Z]/.test(t)});function qe(e,t,s){if(!u.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,s=u.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,g){return!u.isUndefined(g[x])});const o=s.metaTokens,r=s.visitor||m,i=s.dots,a=s.indexes,c=(s.Blob||typeof Blob<"u"&&Blob)&&u.isSpecCompliantForm(t);if(!u.isFunction(r))throw new TypeError("visitor must be a function");function d(p){if(p===null)return"";if(u.isDate(p))return p.toISOString();if(u.isBoolean(p))return p.toString();if(!c&&u.isBlob(p))throw new j("Blob is not supported. Use a Buffer instead.");return u.isArrayBuffer(p)||u.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function m(p,x,g){let C=p;if(p&&!g&&typeof p=="object"){if(u.endsWith(x,"{}"))x=o?x:x.slice(0,-2),p=JSON.stringify(p);else if(u.isArray(p)&&xo(p)||(u.isFileList(p)||u.endsWith(x,"[]"))&&(C=u.toArray(p)))return x=Vt(x),C.forEach(function(E,O){!(u.isUndefined(E)||E===null)&&t.append(a===!0?pt([x],O,i):a===null?x:x+"[]",d(E))}),!1}return Ye(p)?!0:(t.append(pt(g,x,i),d(p)),!1)}const h=[],f=Object.assign(yo,{defaultVisitor:m,convertValue:d,isVisitable:Ye});function A(p,x){if(!u.isUndefined(p)){if(h.indexOf(p)!==-1)throw Error("Circular reference detected in "+x.join("."));h.push(p),u.forEach(p,function(C,M){(!(u.isUndefined(C)||C===null)&&r.call(t,C,u.isString(M)?M.trim():M,x,f))===!0&&A(C,x?x.concat(M):[M])}),h.pop()}}if(!u.isObject(e))throw new TypeError("data must be an object");return A(e),t}function ft(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(o){return t[o]})}function rt(e,t){this._pairs=[],e&&qe(e,this,t)}const Kt=rt.prototype;Kt.append=function(t,s){this._pairs.push([t,s])};Kt.toString=function(t){const s=t?function(o){return t.call(this,o,ft)}:ft;return this._pairs.map(function(r){return s(r[0])+"="+s(r[1])},"").join("&")};function wo(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Xt(e,t,s){if(!t)return e;const o=s&&s.encode||wo;u.isFunction(s)&&(s={serialize:s});const r=s&&s.serialize;let i;if(r?i=r(t,s):i=u.isURLSearchParams(t)?t.toString():new rt(t,s).toString(o),i){const a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class gt{constructor(){this.handlers=[]}use(t,s,o){return this.handlers.push({fulfilled:t,rejected:s,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){u.forEach(this.handlers,function(o){o!==null&&t(o)})}}const Gt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},vo=typeof URLSearchParams<"u"?URLSearchParams:rt,So=typeof FormData<"u"?FormData:null,To=typeof Blob<"u"?Blob:null,jo={isBrowser:!0,classes:{URLSearchParams:vo,FormData:So,Blob:To},protocols:["http","https","file","blob","url","data"]},nt=typeof window<"u"&&typeof document<"u",et=typeof navigator=="object"&&navigator||void 0,No=nt&&(!et||["ReactNative","NativeScript","NS"].indexOf(et.product)<0),Co=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ko=nt&&window.location.href||"http://localhost",Eo=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:nt,hasStandardBrowserEnv:No,hasStandardBrowserWebWorkerEnv:Co,navigator:et,origin:ko},Symbol.toStringTag,{value:"Module"})),V={...Eo,...jo};function Mo(e,t){return qe(e,new V.classes.URLSearchParams,{visitor:function(s,o,r,i){return V.isNode&&u.isBuffer(s)?(this.append(o,s.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function Ao(e){return u.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Ro(e){const t={},s=Object.keys(e);let o;const r=s.length;let i;for(o=0;o<r;o++)i=s[o],t[i]=e[i];return t}function Qt(e){function t(s,o,r,i){let a=s[i++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),c=i>=s.length;return a=!a&&u.isArray(r)?r.length:a,c?(u.hasOwnProp(r,a)?r[a]=[r[a],o]:r[a]=o,!l):((!r[a]||!u.isObject(r[a]))&&(r[a]=[]),t(s,o,r[a],i)&&u.isArray(r[a])&&(r[a]=Ro(r[a])),!l)}if(u.isFormData(e)&&u.isFunction(e.entries)){const s={};return u.forEachEntry(e,(o,r)=>{t(Ao(o),r,s,0)}),s}return null}function Oo(e,t,s){if(u.isString(e))try{return(t||JSON.parse)(e),u.trim(e)}catch(o){if(o.name!=="SyntaxError")throw o}return(s||JSON.stringify)(e)}const Re={transitional:Gt,adapter:["xhr","http","fetch"],transformRequest:[function(t,s){const o=s.getContentType()||"",r=o.indexOf("application/json")>-1,i=u.isObject(t);if(i&&u.isHTMLForm(t)&&(t=new FormData(t)),u.isFormData(t))return r?JSON.stringify(Qt(t)):t;if(u.isArrayBuffer(t)||u.isBuffer(t)||u.isStream(t)||u.isFile(t)||u.isBlob(t)||u.isReadableStream(t))return t;if(u.isArrayBufferView(t))return t.buffer;if(u.isURLSearchParams(t))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(o.indexOf("application/x-www-form-urlencoded")>-1)return Mo(t,this.formSerializer).toString();if((l=u.isFileList(t))||o.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return qe(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||r?(s.setContentType("application/json",!1),Oo(t)):t}],transformResponse:[function(t){const s=this.transitional||Re.transitional,o=s&&s.forcedJSONParsing,r=this.responseType==="json";if(u.isResponse(t)||u.isReadableStream(t))return t;if(t&&u.isString(t)&&(o&&!this.responseType||r)){const a=!(s&&s.silentJSONParsing)&&r;try{return JSON.parse(t,this.parseReviver)}catch(l){if(a)throw l.name==="SyntaxError"?j.from(l,j.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:V.classes.FormData,Blob:V.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};u.forEach(["delete","get","head","post","put","patch"],e=>{Re.headers[e]={}});const Do=u.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),$o=e=>{const t={};let s,o,r;return e&&e.split(`
`).forEach(function(a){r=a.indexOf(":"),s=a.substring(0,r).trim().toLowerCase(),o=a.substring(r+1).trim(),!(!s||t[s]&&Do[s])&&(s==="set-cookie"?t[s]?t[s].push(o):t[s]=[o]:t[s]=t[s]?t[s]+", "+o:o)}),t},bt=Symbol("internals");function we(e){return e&&String(e).trim().toLowerCase()}function Ie(e){return e===!1||e==null?e:u.isArray(e)?e.map(Ie):String(e)}function Po(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=s.exec(e);)t[o[1]]=o[2];return t}const Fo=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ke(e,t,s,o,r){if(u.isFunction(o))return o.call(this,t,s);if(r&&(t=s),!!u.isString(t)){if(u.isString(o))return t.indexOf(o)!==-1;if(u.isRegExp(o))return o.test(t)}}function Io(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,s,o)=>s.toUpperCase()+o)}function Lo(e,t){const s=u.toCamelCase(" "+t);["get","set","has"].forEach(o=>{Object.defineProperty(e,o+s,{value:function(r,i,a){return this[o].call(this,t,r,i,a)},configurable:!0})})}let Z=class{constructor(t){t&&this.set(t)}set(t,s,o){const r=this;function i(l,c,d){const m=we(c);if(!m)throw new Error("header name must be a non-empty string");const h=u.findKey(r,m);(!h||r[h]===void 0||d===!0||d===void 0&&r[h]!==!1)&&(r[h||c]=Ie(l))}const a=(l,c)=>u.forEach(l,(d,m)=>i(d,m,c));if(u.isPlainObject(t)||t instanceof this.constructor)a(t,s);else if(u.isString(t)&&(t=t.trim())&&!Fo(t))a($o(t),s);else if(u.isObject(t)&&u.isIterable(t)){let l={},c,d;for(const m of t){if(!u.isArray(m))throw TypeError("Object iterator must return a key-value pair");l[d=m[0]]=(c=l[d])?u.isArray(c)?[...c,m[1]]:[c,m[1]]:m[1]}a(l,s)}else t!=null&&i(s,t,o);return this}get(t,s){if(t=we(t),t){const o=u.findKey(this,t);if(o){const r=this[o];if(!s)return r;if(s===!0)return Po(r);if(u.isFunction(s))return s.call(this,r,o);if(u.isRegExp(s))return s.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,s){if(t=we(t),t){const o=u.findKey(this,t);return!!(o&&this[o]!==void 0&&(!s||Ke(this,this[o],o,s)))}return!1}delete(t,s){const o=this;let r=!1;function i(a){if(a=we(a),a){const l=u.findKey(o,a);l&&(!s||Ke(o,o[l],l,s))&&(delete o[l],r=!0)}}return u.isArray(t)?t.forEach(i):i(t),r}clear(t){const s=Object.keys(this);let o=s.length,r=!1;for(;o--;){const i=s[o];(!t||Ke(this,this[i],i,t,!0))&&(delete this[i],r=!0)}return r}normalize(t){const s=this,o={};return u.forEach(this,(r,i)=>{const a=u.findKey(o,i);if(a){s[a]=Ie(r),delete s[i];return}const l=t?Io(i):String(i).trim();l!==i&&delete s[i],s[l]=Ie(r),o[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const s=Object.create(null);return u.forEach(this,(o,r)=>{o!=null&&o!==!1&&(s[r]=t&&u.isArray(o)?o.join(", "):o)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,s])=>t+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...s){const o=new this(t);return s.forEach(r=>o.set(r)),o}static accessor(t){const o=(this[bt]=this[bt]={accessors:{}}).accessors,r=this.prototype;function i(a){const l=we(a);o[l]||(Lo(r,a),o[l]=!0)}return u.isArray(t)?t.forEach(i):i(t),this}};Z.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);u.reduceDescriptors(Z.prototype,({value:e},t)=>{let s=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(o){this[s]=o}}});u.freezeMethods(Z);function Xe(e,t){const s=this||Re,o=t||s,r=Z.from(o.headers);let i=o.data;return u.forEach(e,function(l){i=l.call(s,i,r.normalize(),t?t.status:void 0)}),r.normalize(),i}function Zt(e){return!!(e&&e.__CANCEL__)}function ge(e,t,s){j.call(this,e??"canceled",j.ERR_CANCELED,t,s),this.name="CanceledError"}u.inherits(ge,j,{__CANCEL__:!0});function Yt(e,t,s){const o=s.config.validateStatus;!s.status||!o||o(s.status)?e(s):t(new j("Request failed with status code "+s.status,[j.ERR_BAD_REQUEST,j.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function _o(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Uo(e,t){e=e||10;const s=new Array(e),o=new Array(e);let r=0,i=0,a;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),m=o[i];a||(a=d),s[r]=c,o[r]=d;let h=i,f=0;for(;h!==r;)f+=s[h++],h=h%e;if(r=(r+1)%e,r===i&&(i=(i+1)%e),d-a<t)return;const A=m&&d-m;return A?Math.round(f*1e3/A):void 0}}function Ho(e,t){let s=0,o=1e3/t,r,i;const a=(d,m=Date.now())=>{s=m,r=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const m=Date.now(),h=m-s;h>=o?a(d,m):(r=d,i||(i=setTimeout(()=>{i=null,a(r)},o-h)))},()=>r&&a(r)]}const _e=(e,t,s=3)=>{let o=0;const r=Uo(50,250);return Ho(i=>{const a=i.loaded,l=i.lengthComputable?i.total:void 0,c=a-o,d=r(c),m=a<=l;o=a;const h={loaded:a,total:l,progress:l?a/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&m?(l-a)/d:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(h)},s)},xt=(e,t)=>{const s=e!=null;return[o=>t[0]({lengthComputable:s,total:e,loaded:o}),t[1]]},yt=e=>(...t)=>u.asap(()=>e(...t)),Bo=V.hasStandardBrowserEnv?((e,t)=>s=>(s=new URL(s,V.origin),e.protocol===s.protocol&&e.host===s.host&&(t||e.port===s.port)))(new URL(V.origin),V.navigator&&/(msie|trident)/i.test(V.navigator.userAgent)):()=>!0,Wo=V.hasStandardBrowserEnv?{write(e,t,s,o,r,i,a){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];u.isNumber(s)&&l.push(`expires=${new Date(s).toUTCString()}`),u.isString(o)&&l.push(`path=${o}`),u.isString(r)&&l.push(`domain=${r}`),i===!0&&l.push("secure"),u.isString(a)&&l.push(`SameSite=${a}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function qo(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function zo(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function es(e,t,s){let o=!qo(t);return e&&(o||s==!1)?zo(e,t):t}const wt=e=>e instanceof Z?{...e}:e;function me(e,t){t=t||{};const s={};function o(d,m,h,f){return u.isPlainObject(d)&&u.isPlainObject(m)?u.merge.call({caseless:f},d,m):u.isPlainObject(m)?u.merge({},m):u.isArray(m)?m.slice():m}function r(d,m,h,f){if(u.isUndefined(m)){if(!u.isUndefined(d))return o(void 0,d,h,f)}else return o(d,m,h,f)}function i(d,m){if(!u.isUndefined(m))return o(void 0,m)}function a(d,m){if(u.isUndefined(m)){if(!u.isUndefined(d))return o(void 0,d)}else return o(void 0,m)}function l(d,m,h){if(h in t)return o(d,m);if(h in e)return o(void 0,d)}const c={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(d,m,h)=>r(wt(d),wt(m),h,!0)};return u.forEach(Object.keys({...e,...t}),function(m){const h=c[m]||r,f=h(e[m],t[m],m);u.isUndefined(f)&&h!==l||(s[m]=f)}),s}const ts=e=>{const t=me({},e);let{data:s,withXSRFToken:o,xsrfHeaderName:r,xsrfCookieName:i,headers:a,auth:l}=t;if(t.headers=a=Z.from(a),t.url=Xt(es(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),u.isFormData(s)){if(V.hasStandardBrowserEnv||V.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(u.isFunction(s.getHeaders)){const c=s.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([m,h])=>{d.includes(m.toLowerCase())&&a.set(m,h)})}}if(V.hasStandardBrowserEnv&&(o&&u.isFunction(o)&&(o=o(t)),o||o!==!1&&Bo(t.url))){const c=r&&i&&Wo.read(i);c&&a.set(r,c)}return t},Jo=typeof XMLHttpRequest<"u",Vo=Jo&&function(e){return new Promise(function(s,o){const r=ts(e);let i=r.data;const a=Z.from(r.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=r,m,h,f,A,p;function x(){A&&A(),p&&p(),r.cancelToken&&r.cancelToken.unsubscribe(m),r.signal&&r.signal.removeEventListener("abort",m)}let g=new XMLHttpRequest;g.open(r.method.toUpperCase(),r.url,!0),g.timeout=r.timeout;function C(){if(!g)return;const E=Z.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),L={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:E,config:e,request:g};Yt(function(b){s(b),x()},function(b){o(b),x()},L),g=null}"onloadend"in g?g.onloadend=C:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(C)},g.onabort=function(){g&&(o(new j("Request aborted",j.ECONNABORTED,e,g)),g=null)},g.onerror=function(O){const L=O&&O.message?O.message:"Network Error",W=new j(L,j.ERR_NETWORK,e,g);W.event=O||null,o(W),g=null},g.ontimeout=function(){let O=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const L=r.transitional||Gt;r.timeoutErrorMessage&&(O=r.timeoutErrorMessage),o(new j(O,L.clarifyTimeoutError?j.ETIMEDOUT:j.ECONNABORTED,e,g)),g=null},i===void 0&&a.setContentType(null),"setRequestHeader"in g&&u.forEach(a.toJSON(),function(O,L){g.setRequestHeader(L,O)}),u.isUndefined(r.withCredentials)||(g.withCredentials=!!r.withCredentials),l&&l!=="json"&&(g.responseType=r.responseType),d&&([f,p]=_e(d,!0),g.addEventListener("progress",f)),c&&g.upload&&([h,A]=_e(c),g.upload.addEventListener("progress",h),g.upload.addEventListener("loadend",A)),(r.cancelToken||r.signal)&&(m=E=>{g&&(o(!E||E.type?new ge(null,e,g):E),g.abort(),g=null)},r.cancelToken&&r.cancelToken.subscribe(m),r.signal&&(r.signal.aborted?m():r.signal.addEventListener("abort",m)));const M=_o(r.url);if(M&&V.protocols.indexOf(M)===-1){o(new j("Unsupported protocol "+M+":",j.ERR_BAD_REQUEST,e));return}g.send(i||null)})},Ko=(e,t)=>{const{length:s}=e=e?e.filter(Boolean):[];if(t||s){let o=new AbortController,r;const i=function(d){if(!r){r=!0,l();const m=d instanceof Error?d:this.reason;o.abort(m instanceof j?m:new ge(m instanceof Error?m.message:m))}};let a=t&&setTimeout(()=>{a=null,i(new j(`timeout ${t} of ms exceeded`,j.ETIMEDOUT))},t);const l=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:c}=o;return c.unsubscribe=()=>u.asap(l),c}},Xo=function*(e,t){let s=e.byteLength;if(s<t){yield e;return}let o=0,r;for(;o<s;)r=o+t,yield e.slice(o,r),o=r},Go=async function*(e,t){for await(const s of Qo(e))yield*Xo(s,t)},Qo=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:s,value:o}=await t.read();if(s)break;yield o}}finally{await t.cancel()}},vt=(e,t,s,o)=>{const r=Go(e,t);let i=0,a,l=c=>{a||(a=!0,o&&o(c))};return new ReadableStream({async pull(c){try{const{done:d,value:m}=await r.next();if(d){l(),c.close();return}let h=m.byteLength;if(s){let f=i+=h;s(f)}c.enqueue(new Uint8Array(m))}catch(d){throw l(d),d}},cancel(c){return l(c),r.return()}},{highWaterMark:2})},St=64*1024,{isFunction:$e}=u,Zo=(({Request:e,Response:t})=>({Request:e,Response:t}))(u.global),{ReadableStream:Tt,TextEncoder:jt}=u.global,Nt=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Yo=e=>{e=u.merge.call({skipUndefined:!0},Zo,e);const{fetch:t,Request:s,Response:o}=e,r=t?$e(t):typeof fetch=="function",i=$e(s),a=$e(o);if(!r)return!1;const l=r&&$e(Tt),c=r&&(typeof jt=="function"?(p=>x=>p.encode(x))(new jt):async p=>new Uint8Array(await new s(p).arrayBuffer())),d=i&&l&&Nt(()=>{let p=!1;const x=new s(V.origin,{body:new Tt,method:"POST",get duplex(){return p=!0,"half"}}).headers.has("Content-Type");return p&&!x}),m=a&&l&&Nt(()=>u.isReadableStream(new o("").body)),h={stream:m&&(p=>p.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!h[p]&&(h[p]=(x,g)=>{let C=x&&x[p];if(C)return C.call(x);throw new j(`Response type '${p}' is not supported`,j.ERR_NOT_SUPPORT,g)})});const f=async p=>{if(p==null)return 0;if(u.isBlob(p))return p.size;if(u.isSpecCompliantForm(p))return(await new s(V.origin,{method:"POST",body:p}).arrayBuffer()).byteLength;if(u.isArrayBufferView(p)||u.isArrayBuffer(p))return p.byteLength;if(u.isURLSearchParams(p)&&(p=p+""),u.isString(p))return(await c(p)).byteLength},A=async(p,x)=>{const g=u.toFiniteNumber(p.getContentLength());return g??f(x)};return async p=>{let{url:x,method:g,data:C,signal:M,cancelToken:E,timeout:O,onDownloadProgress:L,onUploadProgress:W,responseType:b,headers:R,withCredentials:D="same-origin",fetchOptions:I}=ts(p),ee=t||fetch;b=b?(b+"").toLowerCase():"text";let F=Ko([M,E&&E.toAbortSignal()],O),K=null;const $=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let te;try{if(W&&d&&g!=="get"&&g!=="head"&&(te=await A(R,C))!==0){let U=new s(x,{method:"POST",body:C,duplex:"half"}),q;if(u.isFormData(C)&&(q=U.headers.get("content-type"))&&R.setContentType(q),U.body){const[y,S]=xt(te,_e(yt(W)));C=vt(U.body,St,y,S)}}u.isString(D)||(D=D?"include":"omit");const _=i&&"credentials"in s.prototype,se={...I,signal:F,method:g.toUpperCase(),headers:R.normalize().toJSON(),body:C,duplex:"half",credentials:_?D:void 0};K=i&&new s(x,se);let G=await(i?ee(K,I):ee(x,se));const be=m&&(b==="stream"||b==="response");if(m&&(L||be&&$)){const U={};["status","statusText","headers"].forEach(w=>{U[w]=G[w]});const q=u.toFiniteNumber(G.headers.get("content-length")),[y,S]=L&&xt(q,_e(yt(L),!0))||[];G=new o(vt(G.body,St,y,()=>{S&&S(),$&&$()}),U)}b=b||"text";let ne=await h[u.findKey(h,b)||"text"](G,p);return!be&&$&&$(),await new Promise((U,q)=>{Yt(U,q,{data:ne,headers:Z.from(G.headers),status:G.status,statusText:G.statusText,config:p,request:K})})}catch(_){throw $&&$(),_&&_.name==="TypeError"&&/Load failed|fetch/i.test(_.message)?Object.assign(new j("Network Error",j.ERR_NETWORK,p,K),{cause:_.cause||_}):j.from(_,_&&_.code,p,K)}}},er=new Map,ss=e=>{let t=e&&e.env||{};const{fetch:s,Request:o,Response:r}=t,i=[o,r,s];let a=i.length,l=a,c,d,m=er;for(;l--;)c=i[l],d=m.get(c),d===void 0&&m.set(c,d=l?new Map:Yo(t)),m=d;return d};ss();const at={http:bo,xhr:Vo,fetch:{get:ss}};u.forEach(at,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Ct=e=>`- ${e}`,tr=e=>u.isFunction(e)||e===null||e===!1;function sr(e,t){e=u.isArray(e)?e:[e];const{length:s}=e;let o,r;const i={};for(let a=0;a<s;a++){o=e[a];let l;if(r=o,!tr(o)&&(r=at[(l=String(o)).toLowerCase()],r===void 0))throw new j(`Unknown adapter '${l}'`);if(r&&(u.isFunction(r)||(r=r.get(t))))break;i[l||"#"+a]=r}if(!r){const a=Object.entries(i).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=s?a.length>1?`since :
`+a.map(Ct).join(`
`):" "+Ct(a[0]):"as no adapter specified";throw new j("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r}const os={getAdapter:sr,adapters:at};function Ge(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ge(null,e)}function kt(e){return Ge(e),e.headers=Z.from(e.headers),e.data=Xe.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),os.getAdapter(e.adapter||Re.adapter,e)(e).then(function(o){return Ge(e),o.data=Xe.call(e,e.transformResponse,o),o.headers=Z.from(o.headers),o},function(o){return Zt(o)||(Ge(e),o&&o.response&&(o.response.data=Xe.call(e,e.transformResponse,o.response),o.response.headers=Z.from(o.response.headers))),Promise.reject(o)})}const rs="1.13.2",ze={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ze[e]=function(o){return typeof o===e||"a"+(t<1?"n ":" ")+e}});const Et={};ze.transitional=function(t,s,o){function r(i,a){return"[Axios v"+rs+"] Transitional option '"+i+"'"+a+(o?". "+o:"")}return(i,a,l)=>{if(t===!1)throw new j(r(a," has been removed"+(s?" in "+s:"")),j.ERR_DEPRECATED);return s&&!Et[a]&&(Et[a]=!0,console.warn(r(a," has been deprecated since v"+s+" and will be removed in the near future"))),t?t(i,a,l):!0}};ze.spelling=function(t){return(s,o)=>(console.warn(`${o} is likely a misspelling of ${t}`),!0)};function or(e,t,s){if(typeof e!="object")throw new j("options must be an object",j.ERR_BAD_OPTION_VALUE);const o=Object.keys(e);let r=o.length;for(;r-- >0;){const i=o[r],a=t[i];if(a){const l=e[i],c=l===void 0||a(l,i,e);if(c!==!0)throw new j("option "+i+" must be "+c,j.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new j("Unknown option "+i,j.ERR_BAD_OPTION)}}const Le={assertOptions:or,validators:ze},re=Le.validators;let de=class{constructor(t){this.defaults=t||{},this.interceptors={request:new gt,response:new gt}}async request(t,s){try{return await this._request(t,s)}catch(o){if(o instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{o.stack?i&&!String(o.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(o.stack+=`
`+i):o.stack=i}catch{}}throw o}}_request(t,s){typeof t=="string"?(s=s||{},s.url=t):s=t||{},s=me(this.defaults,s);const{transitional:o,paramsSerializer:r,headers:i}=s;o!==void 0&&Le.assertOptions(o,{silentJSONParsing:re.transitional(re.boolean),forcedJSONParsing:re.transitional(re.boolean),clarifyTimeoutError:re.transitional(re.boolean)},!1),r!=null&&(u.isFunction(r)?s.paramsSerializer={serialize:r}:Le.assertOptions(r,{encode:re.function,serialize:re.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),Le.assertOptions(s,{baseUrl:re.spelling("baseURL"),withXsrfToken:re.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let a=i&&u.merge(i.common,i[s.method]);i&&u.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),s.headers=Z.concat(a,i);const l=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(s)===!1||(c=c&&x.synchronous,l.unshift(x.fulfilled,x.rejected))});const d=[];this.interceptors.response.forEach(function(x){d.push(x.fulfilled,x.rejected)});let m,h=0,f;if(!c){const p=[kt.bind(this),void 0];for(p.unshift(...l),p.push(...d),f=p.length,m=Promise.resolve(s);h<f;)m=m.then(p[h++],p[h++]);return m}f=l.length;let A=s;for(;h<f;){const p=l[h++],x=l[h++];try{A=p(A)}catch(g){x.call(this,g);break}}try{m=kt.call(this,A)}catch(p){return Promise.reject(p)}for(h=0,f=d.length;h<f;)m=m.then(d[h++],d[h++]);return m}getUri(t){t=me(this.defaults,t);const s=es(t.baseURL,t.url,t.allowAbsoluteUrls);return Xt(s,t.params,t.paramsSerializer)}};u.forEach(["delete","get","head","options"],function(t){de.prototype[t]=function(s,o){return this.request(me(o||{},{method:t,url:s,data:(o||{}).data}))}});u.forEach(["post","put","patch"],function(t){function s(o){return function(i,a,l){return this.request(me(l||{},{method:t,headers:o?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}de.prototype[t]=s(),de.prototype[t+"Form"]=s(!0)});let rr=class ns{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(i){s=i});const o=this;this.promise.then(r=>{if(!o._listeners)return;let i=o._listeners.length;for(;i-- >0;)o._listeners[i](r);o._listeners=null}),this.promise.then=r=>{let i;const a=new Promise(l=>{o.subscribe(l),i=l}).then(r);return a.cancel=function(){o.unsubscribe(i)},a},t(function(i,a,l){o.reason||(o.reason=new ge(i,a,l),s(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const s=this._listeners.indexOf(t);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const t=new AbortController,s=o=>{t.abort(o)};return this.subscribe(s),t.signal.unsubscribe=()=>this.unsubscribe(s),t.signal}static source(){let t;return{token:new ns(function(r){t=r}),cancel:t}}};function nr(e){return function(s){return e.apply(null,s)}}function ar(e){return u.isObject(e)&&e.isAxiosError===!0}const tt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(tt).forEach(([e,t])=>{tt[t]=e});function as(e){const t=new de(e),s=It(de.prototype.request,t);return u.extend(s,de.prototype,t,{allOwnKeys:!0}),u.extend(s,t,null,{allOwnKeys:!0}),s.create=function(r){return as(me(e,r))},s}const P=as(Re);P.Axios=de;P.CanceledError=ge;P.CancelToken=rr;P.isCancel=Zt;P.VERSION=rs;P.toFormData=qe;P.AxiosError=j;P.Cancel=P.CanceledError;P.all=function(t){return Promise.all(t)};P.spread=nr;P.isAxiosError=ar;P.mergeConfig=me;P.AxiosHeaders=Z;P.formToJSON=e=>Qt(u.isHTMLForm(e)?new FormData(e):e);P.getAdapter=os.getAdapter;P.HttpStatusCode=tt;P.default=P;const{Axios:Ur,AxiosError:Hr,CanceledError:Br,isCancel:Wr,CancelToken:qr,VERSION:zr,all:Jr,Cancel:Vr,isAxiosError:Kr,spread:Xr,toFormData:Gr,AxiosHeaders:Qr,HttpStatusCode:Zr,formToJSON:Yr,getAdapter:en,mergeConfig:tn}=P,ir=()=>"https://api.protonestconnect.co/api/v1/user",it=ir();console.log("ðŸ”§ API Base URL:",it);const ke=P.create({baseURL:it,headers:{"Content-Type":"application/json"},timeout:15e3});ke.interceptors.request.use(e=>{const t=localStorage.getItem("jwtToken");return t&&t!=="MOCK_TOKEN_FOR_TESTING"&&(e.headers["X-Token"]=t),console.log("ðŸ“¤ API Request:",{method:e.method?.toUpperCase(),url:e.url,baseURL:e.baseURL,hasToken:!!t&&t!=="MOCK_TOKEN_FOR_TESTING",payload:e.data||void 0}),e},e=>(console.error("âŒ Request interceptor error:",e),Promise.reject(e)));ke.interceptors.response.use(e=>(console.log("ðŸ“¥ API Response:",{status:e.status,url:e.config.url,method:e.config.method?.toUpperCase()}),e),async e=>{const t=e.config;if(e.response){const s=e.response.status===400,o=e.response.data?.data||e.response.data?.message;if((!s||!window.__api400ErrorLogged&&o!=="Device does not belong to the user")&&(console.error("âŒ API Error Response:",{status:e.response.status,statusText:e.response.statusText,url:t?.url,method:t?.method?.toUpperCase(),data:e.response.data,allowHeader:e.response.headers?.allow}),s&&(window.__api400ErrorLogged=!0)),e.response.status===400){const r=e.response.data?.data||e.response.data?.message;if(r==="Device does not belong to the user")return window.__deviceAuthErrorShown||(console.error(`
ðŸš« DEVICE AUTHORIZATION ERROR`),console.error("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),console.error("âŒ Device does not belong to your account"),console.error(`
ðŸ’¡ TO FIX THIS:`),console.error("   1. Go to: https://api.protonestconnect.co"),console.error("   2. Find your device ID in your dashboard"),console.error(`   3. Update 'defaultDeviceId' in Dashboard.jsx
`),console.error(`â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
`),window.__deviceAuthErrorShown=!0),Promise.reject(e);r!=="Device does not belong to the user"&&console.error("ðŸ” 400 Error:",{endpoint:t?.url,message:r})}}if(e.response?.status===405)return console.error("ðŸš« Method Not Allowed (405):",{attempted:t?.method?.toUpperCase(),endpoint:t?.url,allowed:e.response.headers?.allow||"Not specified"}),Promise.reject(e);if((e.response?.status===400||e.response?.status===401)&&!t?.url?.includes("/get-token")&&(e.response?.data?.data==="Invalid token"||e.response?.data?.message?.includes("token"))&&!t._retry){t._retry=!0;try{const s=localStorage.getItem("refreshToken");if(!s)throw new Error("No refresh token available");console.log("ðŸ”„ Attempting token refresh...");const o=await P.post(`${it}/get-new-token`,{},{headers:{"X-Refresh-Token":s},timeout:1e4});if(o.data.status==="Success"){const{jwtToken:r}=o.data.data;return localStorage.setItem("jwtToken",r),t.headers["X-Token"]=r,console.log("âœ… Token refreshed successfully"),ke(t)}}catch(s){console.error("âŒ Token refresh failed:",s.message),localStorage.clear(),window.location.href="/"}}return Promise.reject(e)});const lr=async(e,t,s=null,o=null,r=0,i=100)=>{try{const a=f=>f.toISOString().split(".")[0]+"Z",l=new Date,c=o?new Date(o):l,d=s?new Date(s):new Date(l.getTime()-1440*60*1e3);console.log(`â° [HTTP] Time calculation for ${t}:`,{currentTime:l.toISOString(),startTime:d.toISOString(),endTime:c.toISOString(),rangeHours:((c-d)/(1e3*60*60)).toFixed(1)});const m={deviceId:e,topic:t,startTime:a(d),endTime:a(c),pagination:String(r),pageSize:String(i)};console.log(`ðŸ“¤ [HTTP] Fetching ${t} data:`),console.log(JSON.stringify({deviceId:m.deviceId,topic:m.topic,startTime:m.startTime,endTime:m.endTime,pagination:m.pagination,pageSize:m.pageSize},null,2));const h=await ke.post("/get-stream-data/device/topic",m);if(console.log(`ðŸ“¥ [HTTP] Response for ${t}:`,{status:h.data.status,dataLength:h.data.data?.length||0}),h.data.status==="Success"){const f=h.data.data?.length||0;return f>0?(console.log(`âœ… ${t}: ${f} records`),console.log(`ðŸ“‹ [HTTP] Sample ${t} record:`,h.data.data[0])):console.log(`â„¹ï¸ ${t}: No data found in time range`),h.data.data||[]}return[]}catch(a){let l="Unknown error";return a.response?.data?l=a.response.data.data||a.response.data.message||a.response.data.error||(typeof a.response.data=="string"?a.response.data:null)||JSON.stringify(a.response.data):a.message&&(l=a.message),console.warn(`âš ï¸ [HTTP] Error fetching ${t}:`,{status:a.response?.status||"No response",statusText:a.response?.statusText||"N/A",message:l,fullResponse:a.response?.data}),[]}},cr=async(e,t=null,s=null)=>{const o=[{name:"temp",label:"temperature"},{name:"moisture",label:"moisture"},{name:"humidity",label:"humidity"},{name:"battery",label:"battery"},{name:"light",label:"light"}];try{console.log(`ðŸ“Š [HTTP] Fetching historical data for ${e}`),console.log(`ðŸ“… [HTTP] Time range: ${t||"Last 24h"} to ${s||"Now"}`);const r=await Promise.allSettled(o.map(h=>lr(e,h.name,t,s,0,100))),i=r.filter(h=>h.status==="fulfilled"&&h.value.length>0).length,a=r.filter(h=>h.status==="rejected").length,l=r.filter(h=>h.status==="fulfilled"&&h.value.length===0).length;console.log("ðŸ“Š [HTTP] Historical data summary:",{successful:i,empty:l,failed:a,total:o.length}),i>0?console.log(`âœ… [HTTP] Loaded ${i} topics with historical data`):window.__historicalDataWarningShown||(console.warn("â„¹ï¸ [HTTP] No historical data available yet. Real-time data will still work."),console.warn("ðŸ’¡ [HTTP] Possible reasons:"),console.warn("   1. Device recently added - ProtoNest hasn't saved MQTT data to DB yet"),console.warn("   2. Topic names mismatch - check what topic names are saved in DB"),console.warn("   3. Device not in your account - verify device ownership"),window.__historicalDataWarningShown=!0);const c=new Map;r.forEach((h,f)=>{const A=o[f],p=A.name,x=A.label;h.status==="fulfilled"&&Array.isArray(h.value)?(console.log(`ðŸ” [HTTP] Processing ${p}: ${h.value.length} records`),h.value.forEach(g=>{const C=g.timestamp||g.time||new Date().toISOString();c.has(C)||c.set(C,{timestamp:C,time:new Date(C).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),moisture:null,temperature:null,humidity:null,light:null,battery:null});const M=c.get(C);let E=g;if(g.payload&&typeof g.payload=="string")try{E=JSON.parse(g.payload)}catch{console.warn(`âš ï¸ Failed to parse payload for ${p}:`,g.payload),E=g}else g.payload&&typeof g.payload=="object"&&(E=g.payload);x==="temperature"||p==="temp"?(M.temperature=Number(E.temp||E.temperature||g.value||0),console.log(`  ðŸ“Š [${C}] temperature: ${M.temperature}`)):x==="moisture"?(M.moisture=Number(E.moisture||g.value||0),console.log(`  ðŸ“Š [${C}] moisture: ${M.moisture}`)):x==="humidity"?(M.humidity=Number(E.humidity||g.value||0),console.log(`  ðŸ“Š [${C}] humidity: ${M.humidity}`)):x==="battery"?(M.battery=Number(E.battery||g.value||0),console.log(`  ðŸ“Š [${C}] battery: ${M.battery}`)):x==="light"&&(M.light=Number(E.light||g.value||0),console.log(`  ðŸ“Š [${C}] light: ${M.light}`))})):h.status==="rejected"&&console.warn(`âš ï¸ [HTTP] Failed to fetch ${p} data:`,h.reason?.message)});const d=Array.from(c.values()).sort((h,f)=>new Date(h.timestamp)-new Date(f.timestamp)),m={moisture:null,temperature:null,humidity:null,light:null,battery:null};return d.forEach(h=>{Object.keys(m).forEach(f=>{h[f]!==null&&h[f]!==void 0&&h[f]!==0?m[f]=h[f]:m[f]!==null&&(h[f]=m[f])})}),d.length>0&&(console.log(`âœ… [HTTP] Historical data: ${d.length} data points combined`),console.log(`ðŸ“… [HTTP] Time range: ${d[0].time} to ${d[d.length-1].time}`),console.log("ðŸ“Š [HTTP] Latest data point:",d[d.length-1])),d}catch(r){throw console.error("âŒ [HTTP] Error fetching all stream data:",r),r}},ur=async(e,t,s={})=>{try{console.log("Updating device state:",{deviceId:e,topic:t,payload:s});const o={deviceId:e,topic:t,payload:s};console.log("ðŸ“¤ Update state request body:",JSON.stringify(o,null,2));const r=await ke.post("/update-state-details",o);return console.log("âœ… Device state update response:",r.data),r.data}catch(o){throw o.response?.status===405&&(console.error("âŒ Method not allowed for update-state-details. Server may not support POST."),console.error("Allowed methods:",o.response.headers?.allow||"Unknown")),o.response?.status===400&&console.error("ðŸ” Device Update 400 Error Analysis:",{endpoint:"/update-state-details",sentPayload:requestBody,serverResponse:o.response.data,possibleCauses:["Invalid deviceId format","Topic not found or invalid format","Payload structure incorrect (should be key-value pairs)","Missing required parameters (deviceId, topic, payload)","Topic doesn't exist - new topic will be created automatically"]}),console.error("âŒ Error updating device state:",{status:o.response?.status,statusText:o.response?.statusText,data:o.response?.data,message:o.message,url:o.config?.url,method:o.config?.method,requestBody}),o}},Qe=async(e,t,s="pump",o="auto")=>{const r=t.toLowerCase();return console.log("ðŸ“¤ Sending pump command via HTTP API:",{deviceId:e,topic:s,pump:r,mode:o}),ur(e,s,{pump:r,mode:o})},dr=e=>{if(!e)return console.error("âŒ Cannot build WebSocket URL: No JWT token available"),null;const t=encodeURIComponent(e),s=`wss://api.protonestconnect.co/ws?token=${t}`;return console.log("ðŸ”Œ WebSocket URL built:",s.replace(t,"***TOKEN***")),s};class mr{constructor(){this.client=null,this.currentDeviceId=null,this.subscriptions=new Map,this.dataCallback=null,this.connectCallback=null,this.disconnectCallback=null,this.isReady=!1,this.jwtToken=null}_initializeClient(t){if(this.client){console.log("[WebSocketClient] Client already initialized");return}const s=dr(t);if(!s)throw new Error("Failed to build WebSocket URL - invalid token");this.client=new xs({brokerURL:s,reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3,onConnect:o=>{console.log("âœ… WebSocket Connected:",o),this.isReady=!0,this.currentDeviceId&&this._subscribeToDeviceTopics(this.currentDeviceId),this.connectCallback&&this.connectCallback()},onStompError:o=>{console.error("âŒ Broker reported error:",o.headers.message),console.error("Details:",o.body)},onWebSocketError:o=>{console.error("ðŸš« WebSocket error",o)},onWebSocketClose:o=>{console.warn("ðŸ”» WebSocket closed",o),this.isReady=!1,this.disconnectCallback&&this.disconnectCallback()},debug:o=>console.log("ðŸªµ Debug:",o)}),this.client.activate(),console.log("[WebSocketClient] STOMP client activated")}_subscribeToDeviceTopics(t){const s=this,o=`/topic/stream/${t}`,r=this.client.subscribe(o,l=>{const c=JSON.parse(l.body);if(console.log(`ðŸ“¡ [${t}] Received stream data:`,c),s.dataCallback){const d=c.payload||c,m=c.topic,h={temp:"temp",temperature:"temp",humidity:"humidity",moisture:"moisture",light:"light",battery:"battery"},A=Object.keys(h).filter(p=>d[p]!==void 0);if(A.length>2){console.log(`ðŸŽ¯ [${t}] Received BATCH state update with ${A.length} sensors`);const p={};A.forEach(x=>{const g=h[x];p[g]=d[x],console.log(`   - ${g}: ${d[x]}`)}),s.dataCallback({sensorType:"batchUpdate",value:p,timestamp:c.timestamp||new Date().toISOString()})}else{let p=!1;if(m&&d[m]!==void 0){const x=h[m]||m;console.log(`ðŸŽ¯ [${t}] Calling Dashboard callback: ${x} = ${d[m]}`),s.dataCallback({sensorType:x,value:d[m],timestamp:c.timestamp||new Date().toISOString()}),p=!0}else for(const[x,g]of Object.entries(h))d[x]!==void 0&&(console.log(`ðŸŽ¯ [${t}] Calling Dashboard callback: ${g} = ${d[x]}`),s.dataCallback({sensorType:g,value:d[x],timestamp:c.timestamp||new Date().toISOString()}),p=!0);p||console.warn(`âš ï¸ [${t}] No recognized sensor field in message:`,c)}}else console.warn(`âš ï¸ [${t}] No callback registered yet - data will be lost:`,c)});this.subscriptions.set(`stream-${t}`,r),console.log(`ðŸ”” Subscribed to ${o}`);const i=`/topic/state/${t}`,a=this.client.subscribe(i,l=>{const c=JSON.parse(l.body);console.log(`ðŸ”§ [${t}] Pump state received:`,c);const d=c.payload||c;if(s.dataCallback){const m=d.power||d.status||d.pumpStatus;if(m!==void 0){const f=String(m).toUpperCase();console.log(`ðŸŽ¯ [${t}] Calling Dashboard callback: pumpStatus = ${f}`),s.dataCallback({sensorType:"pumpStatus",value:f,timestamp:c.timestamp||new Date().toISOString()})}const h=d.mode||d.pumpMode;if(h!==void 0){const f=String(h).toLowerCase();console.log(`ðŸŽ¯ [${t}] Calling Dashboard callback: pumpMode = ${f}`),s.dataCallback({sensorType:"pumpMode",value:f,timestamp:c.timestamp||new Date().toISOString()})}}});this.subscriptions.set(`state-${t}`,a),console.log(`ðŸ”” Subscribed to ${i}`)}_unsubscribeFromDeviceTopics(t){const s=`stream-${t}`,o=`state-${t}`;this.subscriptions.has(s)&&(this.subscriptions.get(s).unsubscribe(),this.subscriptions.delete(s),console.log(`ðŸ”• Unsubscribed from /topic/stream/${t}`)),this.subscriptions.has(o)&&(this.subscriptions.get(o).unsubscribe(),this.subscriptions.delete(o),console.log(`ðŸ”• Unsubscribed from /topic/state/${t}`))}async connect(t){if(!t)throw console.error("[WebSocketClient] âŒ Cannot connect: No JWT token provided"),new Error("JWT token required for WebSocket connection");return this.jwtToken=t,this.client?this.isConnected?console.log("[WebSocketClient] âœ… Already connected"):(console.log("[WebSocketClient] ðŸ”„ Reconnecting..."),this.client.activate()):(console.log("[WebSocketClient] ðŸ”„ Initializing STOMP client..."),this._initializeClient(t)),Promise.resolve()}subscribeToDevice(t,s){return this.currentDeviceId&&this.currentDeviceId!==t&&(console.log(`[WebSocketClient] ðŸ”„ Switching from ${this.currentDeviceId} to ${t}`),this._unsubscribeFromDeviceTopics(this.currentDeviceId)),this.currentDeviceId=t,this.dataCallback=s,console.log(`[WebSocketClient] Callback registered for device: ${t}`),this.isReady&&this.isConnected?this._subscribeToDeviceTopics(t):console.log(`[WebSocketClient] Will subscribe to ${t} when connection is ready`),!0}get isConnected(){return this.client?.connected||!1}getConnectionStatus(){return this.isConnected}onConnect(t){this.connectCallback=t,this.isConnected&&t()}onDisconnect(t){this.disconnectCallback=t}sendPumpCommand(t,s,o=null){if(!this.isConnected)return console.warn("[WebSocketClient] Cannot send command - not connected"),!1;const r=`protonest/${t}/state/motor/paddy`,i={power:s.toLowerCase()};o&&(i.mode=o.toLowerCase());try{return this.client.publish({destination:r,body:JSON.stringify(i)}),console.log("[WebSocketClient] ðŸ“¤ Sent pump command:",i),!0}catch(a){return console.error("[WebSocketClient] âŒ Failed to send pump command:",a),!1}}disconnect(){this.client&&this.isConnected?(console.log("[WebSocketClient] ðŸ”Œ Disconnecting..."),this.currentDeviceId&&this._unsubscribeFromDeviceTopics(this.currentDeviceId),this.client.deactivate(),this.isReady=!1):console.log("[WebSocketClient] Already disconnected")}enableTestingMode(){typeof window>"u"||(window.sendPumpCommand=(t,s=null)=>this.currentDeviceId?this.sendPumpCommand(this.currentDeviceId,t,s):(console.error("âŒ No device selected. Subscribe to a device first."),!1),window.simulateSensorData=(t,s)=>{if(!this.isConnected)return console.error("âŒ Not connected"),!1;if(!this.currentDeviceId)return console.error("âŒ No device selected. Subscribe to a device first."),!1;const o=`protonest/${this.currentDeviceId}/stream/${t}`,r={[t]:String(s)};try{return this.client.publish({destination:o,body:JSON.stringify(r)}),console.log("ðŸ“¤ Simulated:",r),!0}catch(i){return console.error("âŒ Failed:",i),!1}},window.wsInfo=()=>{console.log("ðŸ“Š WebSocket Info:"),console.log("   Connected:",this.isConnected),console.log("   Current Device:",this.currentDeviceId||"None"),console.log("   Active Subscriptions:",Array.from(this.subscriptions.keys()))},console.log(""),console.log("ðŸ§ª Testing Mode Enabled!"),console.log('   sendPumpCommand("on")'),console.log('   sendPumpCommand("off")'),console.log('   simulateSensorData("temp", 25.5)'),console.log("   wsInfo()"),console.log(""))}}const ve=new mr;var hr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const pr=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),fr=(e,t)=>{const s=N.forwardRef(({color:o="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:a,children:l,...c},d)=>N.createElement("svg",{ref:d,...hr,width:r,height:r,stroke:o,strokeWidth:a?Number(i)*24/Number(r):i,className:`lucide lucide-${pr(e)}`,...c},[...t.map(([m,h])=>N.createElement(m,h)),...(Array.isArray(l)?l:[l])||[]]));return s.displayName=`${e}`,s};var J=fr;const gr=J("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),is=J("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),br=J("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Mt=J("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),xr=J("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),At=J("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Se=J("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Te=J("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Rt=J("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Ue=J("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),yr=J("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ls=J("Power",[["path",{d:"M18.36 6.64a9 9 0 1 1-12.73 0",key:"phirl6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"12",key:"aemgbe"}]]),wr=J("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),vr=J("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Sr=J("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]),Tr=J("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),cs=J("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),jr=({deviceId:e,deviceList:t})=>{const{userId:s,logout:o}=st(),r=ps(),i=a=>{const l=a.target.value;r(`/dashboard/${l}`)};return n.jsxs("header",{className:"bg-white border-2 rounded-lg px-6 py-3 flex flex-col sm:flex-row justify-between items-center shadow-sm mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4 sm:mb-0",children:[n.jsx(Sr,{className:"h-8 w-8 text-green-600"}),n.jsxs("span",{className:"text-3xl font-bold tracking-wide font-mono",children:["Agri",n.jsx("span",{className:"text-yellow-400",children:"Cop"})]})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-4 sm:mb-0",children:[n.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Select Device:"}),n.jsx("select",{value:e,onChange:i,className:"bg-gray-100 border border-gray-300 text-gray-700 py-1 px-3 rounded focus:ring-2 focus:ring-green-500 outline-none font-medium",children:t.map(a=>n.jsx("option",{value:a,children:a},a))})]}),n.jsxs("div",{className:"text-right text-xs",children:[n.jsx("div",{className:"text-green-600 font-bold",children:"Authentication: Successful"}),n.jsxs("div",{className:"text-gray-600 font-mono",children:["User: ",s]}),n.jsxs("button",{onClick:o,className:"text-red-500 hover:underline mt-1 flex items-center justify-end gap-1 w-full",children:["Logout ",n.jsx(yr,{className:"w-3 h-3"})]})]})]})},je=({label:e,value:t,unit:s,status:o,decimals:r=1})=>{const i=l=>{switch(l){case"critical":return"text-red-600 bg-red-50";case"warning":return"text-yellow-600 bg-yellow-50";case"optimal":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}},a=l=>l==null?"0.0":typeof l=="number"?l.toFixed(r):l;return n.jsxs("div",{className:`p-2 rounded-lg ${i(o)}`,children:[n.jsx("div",{className:"font-medium",children:e}),n.jsxs("div",{children:[a(t),s," - ",o]})]})},Ot=({label:e,value:t,onChange:s,min:o,max:r,step:i="1",error:a,unit:l=""})=>n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:[e," ",l&&`(${l})`]}),n.jsx("input",{type:"number",min:o,max:r,step:i,value:t,onChange:s,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none ${a?"border-red-300":"border-gray-300"}`}),a&&n.jsx("p",{className:"text-red-500 text-xs mt-1",children:a})]}),Ne=({title:e,minConfig:t,maxConfig:s,rangeError:o})=>n.jsxs("div",{className:"space-y-4",children:[n.jsx("h4",{className:"font-semibold text-gray-700 border-b pb-2",children:e}),o&&n.jsxs("div",{className:"text-red-600 text-sm flex items-center gap-2",children:[n.jsx(cs,{className:"w-4 h-4"}),o]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx(Ot,{...t}),s&&n.jsx(Ot,{...s})]})]}),Nr=({status:e})=>e?n.jsxs("div",{className:`p-3 rounded-lg flex items-center gap-2 ${e.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[e.type==="success"?n.jsx(br,{className:"w-4 h-4"}):n.jsx(cs,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm font-medium",children:e.message})]}):null,Cr=({onClick:e,disabled:t,loading:s,loadingText:o="Processing...",icon:r,children:i,className:a=""})=>n.jsx("button",{onClick:e,disabled:t||s,className:`flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center gap-2 transition ${a}`,children:s?n.jsxs(n.Fragment,{children:[n.jsx(Ue,{className:"w-4 h-4 animate-spin"}),o]}):n.jsxs(n.Fragment,{children:[r&&n.jsx(r,{className:"w-4 h-4"}),i]})}),kr=({pumpStatus:e,pumpMode:t,isAutoMode:s,isLoading:o,onToggle:r})=>{const i=s?"auto":"manual";return n.jsx("div",{className:`${s?"opacity-50 pointer-events-none":""}`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"font-medium text-gray-700",children:["Manual Control ",s&&"(Disabled)"]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Status: ",n.jsx("span",{className:`font-bold ml-1 ${e==="ON"?"text-green-600":"text-gray-600"}`,children:e}),n.jsx("span",{className:"text-xs ml-2 px-2 py-0.5 bg-blue-100 text-blue-700 rounded capitalize",children:i})]})]}),n.jsx("button",{onClick:r,disabled:o||s,className:`px-6 py-3 rounded-lg font-bold flex items-center gap-2 transition-all duration-300 min-w-[140px] justify-center ${e==="ON"?"bg-red-600 hover:bg-red-700 text-white shadow-lg shadow-red-200":"bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-200"} disabled:opacity-50 disabled:cursor-not-allowed`,children:o?n.jsxs(n.Fragment,{children:[n.jsx(Ue,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ls,{className:"w-5 h-5"}),e==="ON"?"Turn OFF":"Turn ON"]})})]})})},Er=({enabled:e,onToggle:t,title:s="Automatic Mode",description:o="Auto control pump based on moisture thresholds"})=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-700",children:s}),n.jsx("div",{className:"text-xs text-gray-500",children:o})]}),n.jsx("button",{onClick:t,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e?"bg-blue-600":"bg-gray-300"}`,children:n.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e?"translate-x-6":"translate-x-1"}`})})]}),Mr=({settings:e,setSettings:t,handleSaveSettings:s,commandInProgress:o,commandStatus:r,liveData:i,togglePump:a,pumpStatus:l})=>{const[c,d]=N.useState(e),[m,h]=N.useState(!1),[f,A]=N.useState({});N.useEffect(()=>{d(e),h(!1)},[e]);const p=b=>{const R={},D=parseFloat(b.moistureMin),I=parseFloat(b.moistureMax),ee=parseFloat(b.tempMin),F=parseFloat(b.tempMax),K=parseFloat(b.humidityMin),$=parseFloat(b.humidityMax),te=parseFloat(b.lightMin),_=parseFloat(b.lightMax),se=parseFloat(b.batteryMin);return(isNaN(D)||D<0||D>100)&&(R.moistureMin="Must be between 0-100%"),(isNaN(I)||I<0||I>100)&&(R.moistureMax="Must be between 0-100%"),D>=I&&(R.moistureRange="Min must be less than max"),(isNaN(ee)||ee<-10||ee>50)&&(R.tempMin="Must be between -10 to 50Â°C"),(isNaN(F)||F<0||F>60)&&(R.tempMax="Must be between 0-60Â°C"),ee>=F&&(R.tempRange="Min must be less than max"),(isNaN(K)||K<0||K>100)&&(R.humidityMin="Must be between 0-100%"),(isNaN($)||$<0||$>100)&&(R.humidityMax="Must be between 0-100%"),K>=$&&(R.humidityRange="Min must be less than max"),(isNaN(te)||te<0||te>2e3)&&(R.lightMin="Must be between 0-2000 lux"),(isNaN(_)||_<0||_>2e3)&&(R.lightMax="Must be between 0-2000 lux"),te>=_&&(R.lightRange="Min must be less than max"),(isNaN(se)||se<0||se>100)&&(R.batteryMin="Must be between 0-100%"),R},x=(b,R)=>{const D={...c,[b]:R};d(D),h(!0);const I=p(D);A(I)},g=async()=>{const b=p(c);if(Object.keys(b).length>0){A(b);return}t(c),await s(),h(!1)},C=(b,R,D)=>b?b<R?"critical":b>D?"warning":"optimal":"unknown",M=C(i?.moisture,parseFloat(c.moistureMin),parseFloat(c.moistureMax)),E=C(i?.temperature,parseFloat(c.tempMin),parseFloat(c.tempMax)),O=C(i?.humidity,parseFloat(c.humidityMin),parseFloat(c.humidityMax)),L=C(i?.light,parseFloat(c.lightMin),parseFloat(c.lightMax)),W=C(i?.battery,parseFloat(c.batteryMin),100);return n.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-md border border-gray-100 space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(vr,{className:"w-6 h-6 text-gray-600"}),n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Device Settings"})]}),m&&n.jsxs("div",{className:"flex items-center gap-2 text-amber-600 text-sm",children:[n.jsx(is,{className:"w-4 h-4"}),n.jsx("span",{children:"Unsaved changes"})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("h4",{className:"font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[n.jsx(Rt,{className:"w-4 h-4"}),"Current Status"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[n.jsx(je,{label:"Moisture",value:i?.moisture,unit:"%",status:M,decimals:1}),n.jsx(je,{label:"Temperature",value:i?.temperature,unit:"Â°C",status:E,decimals:1}),n.jsx(je,{label:"Humidity",value:i?.humidity,unit:"%",status:O,decimals:1}),n.jsx(je,{label:"Light",value:i?.light,unit:" lux",status:L,decimals:0}),n.jsx(je,{label:"Battery",value:i?.battery,unit:"%",status:W,decimals:1})]})]}),n.jsx(Ne,{title:"Soil Moisture Thresholds",rangeError:f.moistureRange,minConfig:{label:"Minimum Threshold",unit:"%",value:c.moistureMin,onChange:b=>x("moistureMin",b.target.value),min:"0",max:"100",step:"1",error:f.moistureMin},maxConfig:{label:"Maximum Threshold",unit:"%",value:c.moistureMax,onChange:b=>x("moistureMax",b.target.value),min:"0",max:"100",step:"1",error:f.moistureMax}}),n.jsx(Ne,{title:"Temperature Thresholds",rangeError:f.tempRange,minConfig:{label:"Minimum Temperature",unit:"Â°C",value:c.tempMin,onChange:b=>x("tempMin",b.target.value),min:"-10",max:"50",step:"0.5",error:f.tempMin},maxConfig:{label:"Maximum Temperature",unit:"Â°C",value:c.tempMax,onChange:b=>x("tempMax",b.target.value),min:"0",max:"60",step:"0.5",error:f.tempMax}}),n.jsx(Ne,{title:"Humidity Thresholds",rangeError:f.humidityRange,minConfig:{label:"Minimum Humidity",unit:"%",value:c.humidityMin,onChange:b=>x("humidityMin",b.target.value),min:"0",max:"100",step:"1",error:f.humidityMin},maxConfig:{label:"Maximum Humidity",unit:"%",value:c.humidityMax,onChange:b=>x("humidityMax",b.target.value),min:"0",max:"100",step:"1",error:f.humidityMax}}),n.jsx(Ne,{title:"Light Intensity Thresholds",rangeError:f.lightRange,minConfig:{label:"Minimum Light",unit:"lux",value:c.lightMin,onChange:b=>x("lightMin",b.target.value),min:"0",max:"2000",step:"10",error:f.lightMin},maxConfig:{label:"Maximum Light",unit:"lux",value:c.lightMax,onChange:b=>x("lightMax",b.target.value),min:"0",max:"2000",step:"10",error:f.lightMax}}),n.jsx(Ne,{title:"Battery Protection",minConfig:{label:"Minimum Battery Level",unit:"%",value:c.batteryMin,onChange:b=>x("batteryMin",b.target.value),min:"0",max:"100",step:"1",error:f.batteryMin}}),n.jsx("div",{className:"flex gap-3",children:n.jsx(Cr,{onClick:g,disabled:Object.keys(f).length>0||!m,loading:o==="settings",loadingText:"Saving...",icon:wr,children:"Save Changes"})}),m&&c.autoMode!==e.autoMode&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm",children:[n.jsxs("div",{className:"flex items-center gap-2 text-blue-800 font-medium mb-1",children:[n.jsx(Rt,{className:"w-4 h-4"}),c.autoMode?"Auto Mode Will Activate":"Auto Mode Will Deactivate"]}),n.jsx("p",{className:"text-blue-700",children:c.autoMode?'Click "Save Changes" to activate automatic pump control. The system will monitor soil moisture and control the pump automatically.':'Click "Save Changes" to switch to manual control mode.'})]}),n.jsx(Nr,{status:r}),n.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx(ls,{className:"w-5 h-5 text-gray-600"}),n.jsx("h4",{className:"font-semibold text-gray-700",children:"Pump Control"})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-4",children:[n.jsx(Er,{enabled:c.autoMode,onToggle:()=>x("autoMode",!c.autoMode),title:"Automatic Mode",description:"Auto control pump based on moisture thresholds"}),n.jsx(kr,{pumpStatus:l,pumpMode:i?.pumpMode,isAutoMode:c.autoMode,isLoading:o==="pump",onToggle:a})]})]})]})},Ce=({value:e,label:t,borderColor:s})=>n.jsxs("div",{className:`bg-white rounded-xl p-5 shadow-sm flex flex-col items-center justify-center relative overflow-hidden transition-all duration-300 border-t-4 ${s}`,children:[n.jsx("div",{className:"text-2xl font-bold text-gray-800 mt-2",children:e}),n.jsx("div",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide mt-1",children:t})]}),Ar=({chartData:e,isLoading:t,onExportCSV:s,isExporting:o,dataSource:r="None",error:i=null,timeRange:a="1h",dataInterval:l="auto",onTimeRangeChange:c,onDataIntervalChange:d,allData:m=[],onFilteredDataChange:h})=>{const[f,A]=N.useState({moisture:!0,temperature:!0,humidity:!0,light:!0,battery:!0}),[p,x]=N.useState(!1),[g,C]=N.useState(""),[M,E]=N.useState("minutes"),[O,L]=N.useState(""),[W,b]=N.useState("seconds"),[R,D]=N.useState(!1),[I,ee]=N.useState(a),[F,K]=N.useState(l),[$,te]=N.useState("all"),_=()=>{if(!g||parseFloat(g)<=0){alert("Please enter a valid time range value");return}const v={seconds:1e3,minutes:60*1e3,hours:3600*1e3,days:1440*60*1e3},H=`custom_${parseFloat(g)*v[M]}`;if(se[H]=`${g} ${M.charAt(0).toUpperCase()+M.slice(1)}`,O&&parseFloat(O)>0){const Y=`custom_interval_${parseFloat(O)*v[W]}`;G[Y]=`${O} ${W.charAt(0).toUpperCase()+W.slice(1)}`,d&&d(Y)}c&&c(H),x(!1)},se={"1m":"Last 1 Minute","5m":"Last 5 Minutes","15m":"Last 15 Minutes","1h":"Last 1 Hour","6h":"Last 6 Hours","24h":"Last 24 Hours"},G={auto:"Auto","1s":"1 Second","5s":"5 Seconds","1m":"1 Minute","5m":"5 Minutes","1h":"1 Hour"},ne=(v=>{if(v.startsWith("custom_")){const H=parseInt(v.replace("custom_","")),B=["auto"];return H>=1e3&&B.push("1s"),H>=5e3&&B.push("5s"),H>=6e4&&B.push("1m"),H>=3e5&&B.push("5m"),H>=36e5&&B.push("1h"),B}return{"1m":["auto","1s"],"5m":["auto","1s","5s"],"15m":["auto","1s","5s","1m"],"1h":["auto","1s","5s","1m","5m"],"6h":["auto","5s","1m","5m"],"24h":["auto","1m","5m","1h"]}[v]||["auto"]})(a),U=N.useMemo(()=>{if(!m||m.length===0)return e;const v=new Date;let k;a.startsWith("custom_")?k=parseInt(a.replace("custom_","")):k={"1m":60*1e3,"5m":300*1e3,"15m":900*1e3,"1h":3600*1e3,"6h":360*60*1e3,"24h":1440*60*1e3}[a]||3600*1e3;const H=v.getTime()-k;let B=m.filter(X=>new Date(X.timestamp).getTime()>=H);if(l!=="auto"&&B.length>0){let X;if(l.startsWith("custom_interval_")?X=parseInt(l.replace("custom_interval_","")):X={"1s":1e3,"5s":5e3,"1m":6e4,"5m":5*6e4,"1h":60*6e4}[l]||0,X>0){const le=new Map;B.forEach(ce=>{const ae=new Date(ce.timestamp).getTime(),ie=Math.floor(ae/X)*X;if(!le.has(ie))le.set(ie,ce);else{const Je=le.get(ie),us=new Date(Je.timestamp).getTime();Math.abs(ae-ie)<Math.abs(us-ie)&&le.set(ie,ce)}}),B=Array.from(le.values()).sort((ce,ae)=>new Date(ce.timestamp).getTime()-new Date(ae.timestamp).getTime())}}const Y=l==="1s"||l==="5s"||l.startsWith("custom_interval_")&&parseInt(l.replace("custom_interval_",""))<6e4;return B=B.map(X=>({...X,time:new Date(X.timestamp).toLocaleTimeString([],Y?{hour:"2-digit",minute:"2-digit",second:"2-digit"}:{hour:"2-digit",minute:"2-digit"})})),B},[m,e,a,l]),q=v=>{A(k=>({...k,[v]:!k[v]}))},y=Object.values(f).every(v=>v===!0);he.useEffect(()=>{h&&h(U)},[U,h]);const S=()=>{const v=Object.keys(f).filter(k=>f[k]);c&&c(I),d&&d(F),setTimeout(()=>{s&&s(v),D(!1)},100)},w=()=>{c&&c(I),d&&d(F),setTimeout(()=>{s&&s(),D(!1)},100)},z=v=>{const k=v==="selected"?Object.keys(f).filter(H=>f[H]):null;s&&s(k),D(!1)};he.useEffect(()=>{R&&(ee(a),K(l))},[R,a,l]);const T=(v,k)=>`px-3 py-1.5 rounded-md text-xs font-bold flex items-center gap-2 transition-all border ${v?`${k} text-white border-transparent shadow-sm`:"bg-gray-50 text-gray-500 border-gray-200 hover:bg-gray-100"}`;return n.jsxs("div",{className:"lg:col-span-2 bg-white rounded-3xl p-6 shadow-md flex flex-col border border-gray-100",children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Historical Trends"}),n.jsxs("span",{className:"text-xs bg-gray-100 text-gray-500 px-2 py-1 rounded-full flex items-center gap-1",children:[n.jsx(Mt,{className:"w-3 h-3"}),se[a]||a.replace("custom_","").replace(/\d+/,v=>{const k=parseInt(v);return k>=864e5?`${(k/864e5).toFixed(1)} Days`:k>=36e5?`${(k/36e5).toFixed(1)} Hours`:k>=6e4?`${(k/6e4).toFixed(1)} Minutes`:`${(k/1e3).toFixed(1)} Seconds`})]}),l!=="auto"&&n.jsx("span",{className:"text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded-full border border-indigo-200",children:G[l]||l.replace("custom_interval_","").replace(/\d+/,v=>{const k=parseInt(v);return k>=36e5?`${(k/36e5).toFixed(1)} Hour Interval`:k>=6e4?`${(k/6e4).toFixed(1)} Min Interval`:`${(k/1e3).toFixed(1)}s Interval`})}),U.length>0&&n.jsxs("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full border border-purple-200",children:[U.length," points"]}),r!=="None"&&n.jsxs("span",{className:`text-xs px-2 py-1 rounded-full flex items-center gap-1 ${r==="API"?"bg-blue-100 text-blue-700 border border-blue-200":"bg-green-100 text-green-700 border border-green-200"}`,children:[r==="API"?n.jsx(xr,{className:"w-3 h-3"}):n.jsx(Tr,{className:"w-3 h-3"}),r]})]}),n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>D(!R),disabled:o||e.length===0,className:"bg-yellow-50 hover:bg-yellow-100 text-yellow-700 border border-yellow-200 text-xs font-bold px-4 py-2 rounded-lg flex items-center gap-2 transition disabled:opacity-50",children:[o?n.jsx(Ue,{className:"w-4 h-4 animate-spin"}):n.jsx(At,{className:"w-4 h-4"}),n.jsx("span",{children:"Export CSV"})]}),R&&!o&&e.length>0&&n.jsx("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 z-50",children:n.jsxs("div",{className:"p-4",children:[n.jsx("h4",{className:"text-sm font-bold text-gray-800 mb-3",children:"Export Options"}),n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Sensors"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>te("all"),className:`flex-1 px-3 py-1.5 text-xs rounded transition-all ${$==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Sensors"}),!y&&n.jsxs("button",{onClick:()=>te("selected"),className:`flex-1 px-3 py-1.5 text-xs rounded transition-all ${$==="selected"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Selected (",Object.values(f).filter(v=>v).length,")"]})]})]}),n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Time Range"}),n.jsxs("select",{value:I,onChange:v=>ee(v.target.value),className:"w-full px-3 py-1.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"1m",children:"Last 1 Minute"}),n.jsx("option",{value:"5m",children:"Last 5 Minutes"}),n.jsx("option",{value:"15m",children:"Last 15 Minutes"}),n.jsx("option",{value:"1h",children:"Last 1 Hour"}),n.jsx("option",{value:"6h",children:"Last 6 Hours"}),n.jsx("option",{value:"24h",children:"Last 24 Hours"})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Data Interval"}),n.jsxs("select",{value:F,onChange:v=>K(v.target.value),className:"w-full px-3 py-1.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"auto",children:"Auto"}),n.jsx("option",{value:"1s",children:"1 Second"}),n.jsx("option",{value:"5s",children:"5 Seconds"}),n.jsx("option",{value:"1m",children:"1 Minute"}),n.jsx("option",{value:"5m",children:"5 Minutes"}),n.jsx("option",{value:"1h",children:"1 Hour"})]})]}),n.jsxs("div",{className:"flex gap-2 pt-2 border-t border-gray-200",children:[n.jsx("button",{onClick:()=>D(!1),className:"flex-1 px-3 py-2 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-all",children:"Cancel"}),n.jsxs("button",{onClick:$==="all"?w:S,className:"flex-1 px-3 py-2 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 transition-all font-medium flex items-center justify-center gap-1",children:[n.jsx(At,{className:"w-3 h-3"}),"Export"]})]}),n.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:n.jsx("button",{onClick:()=>z($),className:"w-full px-3 py-1.5 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-50 rounded transition-all text-center",children:"Quick Export (Current View)"})})]})})]})]}),R&&n.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>D(!1)}),i&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-3 mb-4 flex items-center gap-2 text-sm",children:[n.jsx(gr,{className:"w-4 h-4 flex-shrink-0"}),n.jsx("span",{children:i})]}),p&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4 shadow-2xl",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Custom Time Range"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Range"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"number",value:g,onChange:v=>C(v.target.value),placeholder:"Enter value",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"any"}),n.jsxs("select",{value:M,onChange:v=>E(v.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"seconds",children:"Seconds"}),n.jsx("option",{value:"minutes",children:"Minutes"}),n.jsx("option",{value:"hours",children:"Hours"}),n.jsx("option",{value:"days",children:"Days"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Interval (Optional)"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"number",value:O,onChange:v=>L(v.target.value),placeholder:"Leave empty for auto",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"any"}),n.jsxs("select",{value:W,onChange:v=>b(v.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"seconds",children:"Seconds"}),n.jsx("option",{value:"minutes",children:"Minutes"}),n.jsx("option",{value:"hours",children:"Hours"})]})]})]})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{onClick:()=>x(!1),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all font-medium",children:"Cancel"}),n.jsx("button",{onClick:_,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all font-medium shadow-md",children:"Apply"})]})]})}),n.jsx("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100",children:n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Mt,{className:"w-4 h-4 text-blue-600"}),n.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Time Range"})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[["1m","5m","15m","1h","6h","24h"].map(v=>n.jsx("button",{onClick:()=>c&&c(v),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all ${a===v?"bg-blue-500 text-white shadow-md scale-105":"bg-white text-gray-600 hover:bg-blue-100 border border-gray-200"}`,children:se[v]},v)),n.jsx("button",{onClick:()=>x(!0),className:"px-4 py-2 rounded-lg text-xs font-bold transition-all bg-gradient-to-r from-purple-50 to-pink-50 text-purple-700 hover:from-purple-100 hover:to-pink-100 border border-purple-200",children:"âš™ï¸ Custom"})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-2 mb-2",children:[n.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Data Interval"}),n.jsx("span",{className:"text-xs text-gray-500",children:"(sampling rate)"})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:["auto","1s","5s","1m","5m","1h"].map(v=>{const k=ne.includes(v),H=l===v;return n.jsx("button",{onClick:()=>k&&d&&d(v),disabled:!k,className:`px-3 py-1.5 rounded-lg text-xs font-bold transition-all ${H?"bg-indigo-500 text-white shadow-md":k?"bg-white text-gray-600 hover:bg-indigo-100 border border-gray-200":"bg-gray-50 text-gray-300 border border-gray-100 pointer-events-none cursor-not-allowed"}`,children:G[v]},v)})})]})}),n.jsxs("div",{className:"flex flex-wrap gap-2 mb-6 justify-center md:justify-start p-3 bg-gray-50 rounded-xl border border-gray-100",children:[n.jsxs("button",{onClick:()=>q("moisture"),className:T(f.moisture,"bg-cyan-500"),children:[f.moisture?n.jsx(Te,{className:"w-3 h-3"}):n.jsx(Se,{className:"w-3 h-3"})," Moisture"]}),n.jsxs("button",{onClick:()=>q("temperature"),className:T(f.temperature,"bg-green-500"),children:[f.temperature?n.jsx(Te,{className:"w-3 h-3"}):n.jsx(Se,{className:"w-3 h-3"})," Temp"]}),n.jsxs("button",{onClick:()=>q("humidity"),className:T(f.humidity,"bg-blue-500"),children:[f.humidity?n.jsx(Te,{className:"w-3 h-3"}):n.jsx(Se,{className:"w-3 h-3"})," Humidity"]}),n.jsxs("button",{onClick:()=>q("light"),className:T(f.light,"bg-yellow-500"),children:[f.light?n.jsx(Te,{className:"w-3 h-3"}):n.jsx(Se,{className:"w-3 h-3"})," Light"]}),n.jsxs("button",{onClick:()=>q("battery"),className:T(f.battery,"bg-purple-500"),children:[f.battery?n.jsx(Te,{className:"w-3 h-3"}):n.jsx(Se,{className:"w-3 h-3"})," Battery"]})]}),n.jsx("div",{className:"h-80 w-full flex-grow relative",children:t?n.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-400 bg-white/50 z-10",children:[n.jsx(Ue,{className:"animate-spin w-10 h-10 mb-3 text-blue-500"}),n.jsx("span",{className:"text-sm font-medium",children:"Loading Data..."})]}):U.length===0?n.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200",children:n.jsx("span",{className:"text-sm",children:"No data available for this period"})}):n.jsx(ys,{width:"100%",height:"100%",children:n.jsxs(ws,{data:U,margin:{top:10,right:10,left:-20,bottom:0},children:[n.jsx(vs,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),n.jsx(Ss,{dataKey:"time",tick:{fontSize:11,fill:"#9ca3af"},tickLine:!1,axisLine:{stroke:"#e5e7eb"},minTickGap:30}),n.jsx(ct,{yAxisId:"left",tick:{fontSize:11,fill:"#9ca3af"},tickLine:!1,axisLine:!1,domain:[0,"auto"]}),n.jsx(ct,{yAxisId:"right",orientation:"right",tick:{fontSize:11,fill:"#eab308"},tickLine:!1,axisLine:!1,hide:!f.light}),n.jsx(Ts,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)"},itemStyle:{fontSize:"12px",fontWeight:600}}),f.moisture&&n.jsx(xe,{yAxisId:"left",type:"monotone",dataKey:"moisture",name:"Moisture (%)",stroke:"#06b6d4",strokeWidth:3,dot:!1,activeDot:{r:6}}),f.temperature&&n.jsx(xe,{yAxisId:"left",type:"monotone",dataKey:"temperature",name:"Temp (Â°C)",stroke:"#22c55e",strokeWidth:3,dot:!1,activeDot:{r:6}}),f.humidity&&n.jsx(xe,{yAxisId:"left",type:"monotone",dataKey:"humidity",name:"Humidity (%)",stroke:"#3b82f6",strokeWidth:3,dot:!1,activeDot:{r:6}}),f.battery&&n.jsx(xe,{yAxisId:"left",type:"step",dataKey:"battery",name:"Battery (%)",stroke:"#a855f7",strokeWidth:3,dot:!1}),f.light&&n.jsx(xe,{yAxisId:"right",type:"monotone",dataKey:"light",name:"Light (lux)",stroke:"#eab308",strokeWidth:3,dot:!1,activeDot:{r:6}})]})})})]})},Dt=()=>{const{deviceId:e}=fs(),s=e||"device0011233",{jwtToken:o}=st(),[r,i]=N.useState({moisture:0,temperature:0,humidity:0,light:0,battery:0,pumpStatus:"OFF",pumpMode:"manual"}),[a,l]=N.useState(!1),[c]=N.useState(["device9988","device0011233","device0000","device0001","device0002"]),[d,m]=N.useState([]),[h,f]=N.useState([]),[A,p]=N.useState(!1),[x,g]=N.useState(!1),[C,M]=N.useState(null),[E,O]=N.useState(()=>localStorage.getItem(`timeRange_${s}`)||"1h"),[L,W]=N.useState(()=>localStorage.getItem(`dataInterval_${s}`)||"auto"),[b,R]=N.useState(()=>{const y=localStorage.getItem(`settings_${s}`);return y?JSON.parse(y):{moistureMin:"20",moistureMax:"70",tempMin:"10",tempMax:"35",humidityMin:"30",humidityMax:"80",lightMin:"200",lightMax:"1000",batteryMin:"20",autoMode:!1}}),[D,I]=N.useState(null),[ee,F]=N.useState(null),[K,$]=N.useState(null);N.useEffect(()=>{const y=async()=>{if(!o){console.warn("âš ï¸ Cannot fetch historical data: missing deviceId or token");return}p(!0),M(null);try{console.log(`ðŸ“Š [HTTP API] Fetching historical data for device: ${s}`);const w=await cr(s);m(w),console.log(`âœ… [HTTP API] Historical data loaded: ${w.length} records`)}catch(w){console.error("âŒ [HTTP API] Failed to fetch historical data:",w),w.response?.data?.data==="Device does not belong to the user"?M(`âš ï¸ Device "${s}" not found in your account. Please update the device ID in Dashboard.jsx or add this device to your ProtoNest account. Real-time data will still work.`):M("Failed to load historical data. Real-time WebSocket data will still work."),m([])}finally{p(!1)}};y();const S=setInterval(()=>{o&&y()},3e4);return()=>clearInterval(S)},[s,o,E]),N.useEffect(()=>{console.log(`[Dashboard] ðŸ”„ Device changed to: ${s} - Resetting all data`),i({moisture:0,temperature:0,humidity:0,light:0,battery:0,pumpStatus:"OFF",pumpMode:"manual"}),m([]),f([]),M(null),I(null),F(null),$(null);const y=localStorage.getItem(`settings_${s}`);y?(R(JSON.parse(y)),console.log("ðŸ“¥ Settings loaded from localStorage for device:",s)):R({moistureMin:"20",moistureMax:"70",tempMin:"10",tempMax:"35",humidityMin:"30",humidityMax:"80",lightMin:"200",lightMax:"1000",batteryMin:"20",autoMode:!1});const S=localStorage.getItem(`timeRange_${s}`),w=localStorage.getItem(`dataInterval_${s}`);O(S||"1h"),W(w||"auto"),console.log(`[Dashboard] âœ… Reset complete for device: ${s}`)},[s]),N.useEffect(()=>{if(!o||!s){console.warn("[Dashboard] Missing deviceId or JWT token for WebSocket");return}const y=w=>{console.log(`[Dashboard] ðŸ“¡ Real-time ${w.sensorType}:`,w.value),i(z=>{const T={...z};if(w.sensorType==="batchUpdate")console.log("[Dashboard] ðŸ”„ Processing BATCH state update:",w.value),w.value.temp!==void 0&&(T.temperature=parseFloat(w.value.temp),console.log(`[Dashboard] âœ… Updated temperature: ${T.temperature}`)),w.value.humidity!==void 0&&(T.humidity=parseFloat(w.value.humidity),console.log(`[Dashboard] âœ… Updated humidity: ${T.humidity}`)),w.value.battery!==void 0&&(T.battery=parseFloat(w.value.battery),console.log(`[Dashboard] âœ… Updated battery: ${T.battery}`)),w.value.light!==void 0&&(T.light=parseFloat(w.value.light),console.log(`[Dashboard] âœ… Updated light: ${T.light}`)),w.value.moisture!==void 0&&(T.moisture=parseFloat(w.value.moisture),console.log(`[Dashboard] âœ… Updated moisture: ${T.moisture}`)),console.log("[Dashboard] ðŸ“Š Batch update complete. New state:",T);else switch(w.sensorType){case"temp":T.temperature=parseFloat(w.value),console.log(`[Dashboard] âœ… Updated temperature: ${T.temperature}`);break;case"humidity":T.humidity=parseFloat(w.value),console.log(`[Dashboard] âœ… Updated humidity: ${T.humidity}`);break;case"battery":T.battery=parseFloat(w.value),console.log(`[Dashboard] âœ… Updated battery: ${T.battery}`);break;case"light":T.light=parseFloat(w.value),console.log(`[Dashboard] âœ… Updated light: ${T.light}`);break;case"moisture":T.moisture=parseFloat(w.value),console.log(`[Dashboard] âœ… Updated moisture: ${T.moisture}`);break;case"pumpStatus":T.pumpStatus=w.value,console.log(`[Dashboard] ðŸš¨ Pump status updated to: ${w.value}`);break;case"pumpMode":T.pumpMode=w.value,console.log(`[Dashboard] âš™ï¸ Pump mode updated to: ${w.value}`);break;default:console.warn(`[Dashboard] âš ï¸ Unknown sensor type: ${w.sensorType}`)}return console.log("[Dashboard] ðŸ“Š New liveData state:",T),T})};return ve.onConnect(()=>{l(!0),console.log("[Dashboard] âœ… WebSocket Connected")}),ve.onDisconnect(()=>{l(!1),console.log("[Dashboard] âŒ WebSocket Disconnected")}),(async()=>{try{console.log("[Dashboard] ðŸ”„ Initializing WebSocket connection"),await ve.connect(o),ve.subscribeToDevice(s,y)&&console.log(`[Dashboard] âœ… Subscribed to ${s} topics`)}catch(w){console.error("[Dashboard] âŒ WebSocket connection failed:",w),l(!1)}})(),()=>{console.log("[Dashboard] ðŸ§¹ Cleaning up WebSocket connection"),ve.disconnect()}},[s,o]),N.useEffect(()=>{const y=r||{},S=[],w=parseFloat(b.moistureMin),z=parseFloat(b.moistureMax);y.moisture!==void 0&&(y.moisture<w?S.push(`CRITICAL: Soil Moisture (${y.moisture.toFixed(1)}%) is below minimum (${w}%)`):y.moisture>z&&S.push(`WARNING: Soil Moisture (${y.moisture.toFixed(1)}%) exceeds maximum (${z}%)`));const T=parseFloat(b.tempMin),v=parseFloat(b.tempMax);y.temperature!==void 0&&(y.temperature<T?S.push(`CRITICAL: Temperature (${y.temperature.toFixed(1)}Â°C) is below minimum (${T}Â°C)`):y.temperature>v&&S.push(`WARNING: Temperature (${y.temperature.toFixed(1)}Â°C) exceeds maximum (${v}Â°C)`));const k=parseFloat(b.humidityMin),H=parseFloat(b.humidityMax);y.humidity!==void 0&&(y.humidity<k?S.push(`CRITICAL: Humidity (${y.humidity.toFixed(1)}%) is below minimum (${k}%)`):y.humidity>H&&S.push(`WARNING: Humidity (${y.humidity.toFixed(1)}%) exceeds maximum (${H}%)`));const B=parseFloat(b.lightMin),Y=parseFloat(b.lightMax);y.light!==void 0&&(y.light<B?S.push(`CRITICAL: Light (${y.light.toFixed(0)} lux) is below minimum (${B} lux)`):y.light>Y&&S.push(`WARNING: Light (${y.light.toFixed(0)} lux) exceeds maximum (${Y} lux)`));const X=parseFloat(b.batteryMin);y.battery!==void 0&&y.battery<X&&S.push(`CRITICAL: Battery (${y.battery.toFixed(1)}%) is below minimum (${X}%)`),I(S.length>0?S[0]:null)},[r,b]),N.useEffect(()=>{if(!b.autoMode){console.log("[Automation] âš™ï¸ Auto mode is DISABLED - Manual control only");return}const y=r?.moisture;if(y===void 0){console.log("[Automation] â³ Waiting for moisture data...");return}const S=parseFloat(b.moistureMin),w=parseFloat(b.moistureMax),z=r?.pumpStatus||"OFF";console.log("[Automation] ðŸ¤– AUTO MODE ACTIVE - Checking conditions:",{autoMode:b.autoMode,moisture:y,min:S,max:w,pumpStatus:z}),y<S&&z==="OFF"&&(console.log("[Automation] ðŸš¨ CRITICAL SITUATION DETECTED!"),console.log(`[Automation] ðŸ’§ Moisture ${y}% < ${S}% - AUTO MODE turning pump ON`),console.log("[Automation] ðŸ“¡ Sending MQTT command via HTTP API..."),Qe(s,"ON","pump","auto").then(()=>{console.log("[Automation] âœ… HTTP API request successful - Backend forwarding MQTT command to IoT device"),I(`AUTO MODE: Pump activated automatically - Moisture CRITICAL (${y.toFixed(1)}%)`)}).catch(T=>{console.error("[Automation] âŒ HTTP API request failed:",T),I(`ERROR: Auto mode failed to activate pump - ${T.message}`)})),y>=S&&z==="ON"&&(console.log(`[Automation] âœ… NORMAL: Moisture ${y}% >= ${S}% - AUTO MODE turning pump OFF`),console.log("[Automation] ðŸ“¡ Sending MQTT command via HTTP API..."),Qe(s,"OFF","pump","auto").then(()=>{console.log("[Automation] âœ… HTTP API request successful - Backend forwarding MQTT command to IoT device"),I(`AUTO MODE: Pump deactivated - Moisture restored to normal (${y.toFixed(1)}%)`)}).catch(T=>{console.error("[Automation] âŒ HTTP API request failed:",T),I(`ERROR: Auto mode failed to deactivate pump - ${T.message}`)}))},[r?.moisture,r?.pumpStatus,b.moistureMin,b.moistureMax,b.autoMode,s]);const te=async(y=null)=>{g(!0);try{const S=h.length>0?h:d;if(S.length===0){alert("No data available to export. Please wait for data to accumulate.");return}const w=["moisture","temperature","humidity","light","battery"],z=y&&y.length>0?y.filter(ae=>w.includes(ae)):w,T=["time",...z].join(","),v=S.map(ae=>{const ie=[ae.time];return z.forEach(Je=>{ie.push(ae[Je]??"")}),ie.join(",")}).join(`
`),k=`${T}
${v}`,H=new Blob([k],{type:"text/csv;charset=utf-8;"}),B=URL.createObjectURL(H),Y=document.createElement("a");Y.href=B;const X=y?"selected":"all",le=E.replace("custom_","custom-"),ce=L==="auto"?"auto":L.replace("custom_interval_","interval-");Y.download=`agricop_${s}_${X}_${le}_${ce}_report.csv`,document.body.appendChild(Y),Y.click(),document.body.removeChild(Y)}catch(S){console.error("Export failed",S)}finally{g(!1)}},_=()=>{$("settings"),F(null);try{localStorage.setItem(`settings_${s}`,JSON.stringify(b)),console.log("ðŸ’¾ Settings saved to localStorage:",b),b.autoMode?(console.log("ðŸ¤– AUTO MODE ENABLED - System will automatically control pump based on moisture levels"),console.log(`ðŸ“Š Moisture thresholds: Min=${b.moistureMin}%, Max=${b.moistureMax}%`),console.log("ðŸ’§ Pump will turn ON when moisture < minimum threshold"),console.log("âœ… Pump will turn OFF when moisture >= minimum threshold")):console.log("ðŸ‘¤ MANUAL MODE - User has full control of pump"),F({type:"success",message:b.autoMode?"Settings saved! Auto mode is now ACTIVE.":"Settings saved! Manual control mode is active."})}catch(y){console.error("Failed to save settings:",y),F({type:"error",message:"Failed to save settings."})}finally{$(null),setTimeout(()=>F(null),5e3)}},se=y=>{console.log(`ðŸ“Š Changing time range to: ${y}`),O(y),localStorage.setItem(`timeRange_${s}`,y);let S="auto";y==="1m"||y==="5m"?S="1s":y==="15m"?S="5s":y==="1h"?S="auto":y==="6h"?S="1m":y==="24h"&&(S="5m"),W(S),localStorage.setItem(`dataInterval_${s}`,S)},G=y=>{console.log(`ðŸ“Š Changing data interval to: ${y}`),W(y),localStorage.setItem(`dataInterval_${s}`,y)},be=async()=>{$("pump");const S=r?.pumpStatus==="ON"?"OFF":"ON";console.log(`ðŸ”„ [HTTP API] Toggling pump from ${r?.pumpStatus} to ${S}`);try{await Qe(s,S,"pump","manual"),console.log(`âœ… [HTTP API] Pump command sent: ${S}`),console.log("ðŸ“¡ Waiting for backend to publish to MQTT and device confirmation..."),F({type:"success",message:`Pump command sent: ${S}`})}catch(w){console.error("âŒ [HTTP API] Pump control failed:",w),F({type:"error",message:"Failed to send pump command. Check API connection."})}finally{$(null),setTimeout(()=>F(null),3e3)}},ne=(y,S,w=1)=>r?.[y]?`${Number(r[y]).toFixed(w)}${S}`:"--",U=r?.pumpStatus||"OFF",q=(y,S,w)=>{const z=r?.[y];if(z!==void 0&&(z<S||z>w))return"border-red-500 bg-red-50";switch(y){case"moisture":return"border-cyan-500";case"temperature":return"border-green-500";case"humidity":return"border-blue-400";case"light":return"border-yellow-500";case"battery":return"border-purple-500";default:return"border-green-500"}};return n.jsxs("div",{className:"min-h-screen bg-[#f0f4f8] p-4 font-sans text-gray-800",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-4",children:[n.jsxs("div",{className:`text-center py-2 rounded-lg text-sm font-medium ${a?"bg-green-100 text-green-800 border border-green-300":"bg-gray-100 text-gray-600 border border-gray-300"}`,children:["WebSocket (Real-Time): ",a?"ðŸŸ¢ Connected":"âšª Disconnected"]}),n.jsxs("div",{className:`text-center py-2 rounded-lg text-sm font-medium ${a?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-100 text-gray-600 border border-gray-300"}`,children:["MQTT Stream: ",a?"ðŸŸ¢ Receiving Data":"âšª Waiting for Data"]})]}),n.jsxs("div",{className:`text-center py-2 mb-4 rounded-lg text-sm font-medium ${a?"bg-green-100 text-green-800 border border-green-300":"bg-yellow-100 text-yellow-800 border border-yellow-300"}`,children:["System Status: ",a?`ðŸŸ¢ Online â€¢ Real-Time: ${a?"Active":"Standby"} â€¢ Historical: HTTP API`:"ðŸŸ¡ Limited - Real-time data only"]}),D&&n.jsxs("div",{className:"bg-red-500 text-white rounded-lg p-3 mb-6 shadow-xl flex items-center justify-center font-bold text-lg animate-pulse transition-all",children:[n.jsx(is,{className:"w-6 h-6 mr-3"}),D]}),n.jsx(jr,{deviceId:s,deviceList:c}),n.jsx("div",{className:`rounded-xl py-4 text-center mb-8 border transition-colors duration-500 shadow-sm ${U==="ON"?"bg-green-100 border-green-300 text-green-900":"bg-blue-100 border-blue-300 text-blue-900"}`,children:n.jsxs("h2",{className:"text-xl font-bold",children:["Pump : ",U," (",r?.pumpMode||"Optimal",")"]})}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[n.jsx(Ce,{value:ne("moisture","%"),label:"Soil Moisture",borderColor:q("moisture",parseFloat(b.moistureMin),parseFloat(b.moistureMax))}),n.jsx(Ce,{value:ne("temperature","Â°C"),label:"Temperature",borderColor:q("temperature",parseFloat(b.tempMin),parseFloat(b.tempMax))}),n.jsx(Ce,{value:ne("humidity","%"),label:"Humidity",borderColor:q("humidity",parseFloat(b.humidityMin),parseFloat(b.humidityMax))}),n.jsx(Ce,{value:ne("light"," lux",0),label:"Light",borderColor:q("light",parseFloat(b.lightMin),parseFloat(b.lightMax))}),n.jsx(Ce,{value:ne("battery","%"),label:"Battery",borderColor:q("battery",parseFloat(b.batteryMin),100)})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[n.jsx(Ar,{chartData:d,isLoading:A,onExportCSV:te,isExporting:x,dataSource:"HTTP API",error:C,timeRange:E,dataInterval:L,onTimeRangeChange:se,onDataIntervalChange:G,allData:d,onFilteredDataChange:f}),n.jsx(Mr,{settings:b,setSettings:R,handleSaveSettings:_,commandInProgress:K,commandStatus:ee,liveData:r,togglePump:be,pumpStatus:U})]})]})};function Rr(){return n.jsx(Ms,{children:n.jsx("div",{className:"App",children:n.jsxs(gs,{children:[n.jsx(Oe,{path:"/",element:n.jsx(lt,{to:"/dashboard",replace:!0})}),n.jsx(Oe,{path:"/dashboard",element:n.jsx(Dt,{})}),n.jsx(Oe,{path:"/dashboard/:deviceId",element:n.jsx(Dt,{})}),n.jsx(Oe,{path:"*",element:n.jsx(lt,{to:"/dashboard",replace:!0})})]})})})}const Or=()=>"https://api.protonestconnect.co/api/v1/user",$t=Or(),Dr=async(e,t)=>{try{const s=e.trim(),o=t.trim();if(!s.includes("@"))throw new Error("Invalid email format");console.log("ðŸ”„ Making secure authentication request to:",$t),console.log("ðŸ“‹ IMPORTANT: Using secretKey as password (not login password)");const r={email:s,password:o};console.log("ðŸ”„ Attempting /get-token with documented payload structure:",{email:s,passwordType:"secretKey",passwordLength:o.length});try{const i=await P.post(`${$t}/get-token`,r,{headers:{"Content-Type":"application/json",Accept:"application/json","Cache-Control":"no-cache"},timeout:1e4});if(console.log("ðŸ“¡ API Response from /get-token (Success):",i.data),i.data.status==="Success"){const a=i.data.data?.jwtToken,l=i.data.data?.refreshToken;if(!a)throw new Error("No JWT token in response data");return console.log("âœ… Login successful via /get-token. JWT token received securely."),{jwtToken:a,refreshToken:l,userId:s}}else throw new Error(`Authentication failed: ${i.data.message||"Unexpected response status"}`)}catch(i){if(i.response?.status===400){const a=i.response.data;throw console.error("âŒ Authentication failed (400):",{serverResponse:JSON.stringify(a,null,2),possibleCauses:["Invalid email format - check email address","Invalid credentials - verify email is registered","Wrong secretKey - check Protonest dashboard for correct secretKey","User not found - email not registered in system","Email not verified - check email verification status"]}),a?.data==="Invalid email format"?new Error("Invalid email format. Please check the email address."):a?.data==="Invalid credentials"?new Error("Invalid credentials. Please verify the email and secretKey from Protonest dashboard."):a?.data==="User not found"?new Error("User not found. Please check if the email is registered in the system."):a?.data==="Email not verified"?new Error("Email not verified. Please verify your email address first."):new Error(`Authentication failed: ${a?.data||"Please verify email and secretKey"}`)}else throw i.response?.status===500?(console.error("âŒ Server error (500):",i.response.data),new Error("Internal server error. Please try again later.")):(console.error(`âŒ Unexpected error (${i.response?.status}):`,i.response?.data),i)}}catch(s){throw console.error("âŒ Login process failed:",{message:s.message,email:e?.trim(),hasPassword:!0,passwordLength:t?.length||0}),s}},Pe="ratnaabinayansn@gmail.com",Pt="6M3@pwYvBGRVJLN",$r=({children:e})=>{const{setAuth:t}=st(),[s,o]=he.useState(!1),[r,i]=he.useState(!0);return he.useEffect(()=>{if(s)return;o(!0),(async()=>{try{console.log("ðŸ”‘ Attempting auto login with real credentials..."),console.log("ðŸ“§ Email:",Pe),console.log("ðŸ” SecretKey length:",Pt.length);const l=await Dr(Pe,Pt);console.log("âœ… Auto login successful. Ready for connection."),t({userId:l.userId||Pe,jwtToken:l.jwtToken}),l.refreshToken&&localStorage.setItem("refreshToken",l.refreshToken)}catch(l){console.warn("âš ï¸ Auto login failed. Using mock data for development."),console.error("Auto login error details:",l.message),l.message.includes("Invalid credentials")&&console.error("ðŸ”§ Credentials may be incorrect or expired. Please verify from Protonest dashboard"),t({userId:Pe,jwtToken:"MOCK_TOKEN_FOR_TESTING"})}finally{i(!1)}})()},[t,s]),r?n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Authenticating with Protonest API..."}),n.jsx("p",{className:"text-blue-600 text-sm mt-2",children:"âœ… Using real credentials"})]})}):e};Es.createRoot(document.getElementById("root")).render(n.jsx(As,{children:n.jsx($r,{children:n.jsx(bs,{basename:"/Plant-Monitoring-System_PC",future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:n.jsx(Rr,{})})})}));
